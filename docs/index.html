<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>VECTORES AUTOREGRESIVOS (VAR)</title>
  <meta name="description" content="VECTORES AUTOREGRESIVOS (VAR)" />
  <meta name="generator" content="bookdown 0.27 and GitBook 2.6.7" />

  <meta property="og:title" content="VECTORES AUTOREGRESIVOS (VAR)" />
  <meta property="og:type" content="book" />
  
  
  

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="VECTORES AUTOREGRESIVOS (VAR)" />
  
  
  

<meta name="author" content="Luis Ortiz-Cevallos" />


<meta name="date" content="2022-07-05" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  


<script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.6/dist/fuse.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />








<link href="libs/anchor-sections-1.1.0/anchor-sections.css" rel="stylesheet" />
<link href="libs/anchor-sections-1.1.0/anchor-sections-hash.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.1.0/anchor-sections.js"></script>

<script>
/* ========================================================================
 * Bootstrap: transition.js v3.3.7
 * http://getbootstrap.com/javascript/#transitions
 * ========================================================================
 * Copyright 2011-2016 Twitter, Inc.
 * Licensed under MIT (https://github.com/twbs/bootstrap/blob/master/LICENSE)
 * ======================================================================== */


+function ($) {
  'use strict';

  // CSS TRANSITION SUPPORT (Shoutout: http://www.modernizr.com/)
  // ============================================================

  function transitionEnd() {
    var el = document.createElement('bootstrap')

    var transEndEventNames = {
      WebkitTransition : 'webkitTransitionEnd',
      MozTransition    : 'transitionend',
      OTransition      : 'oTransitionEnd otransitionend',
      transition       : 'transitionend'
    }

    for (var name in transEndEventNames) {
      if (el.style[name] !== undefined) {
        return { end: transEndEventNames[name] }
      }
    }

    return false // explicit for ie8 (  ._.)
  }

  // http://blog.alexmaccaw.com/css-transitions
  $.fn.emulateTransitionEnd = function (duration) {
    var called = false
    var $el = this
    $(this).one('bsTransitionEnd', function () { called = true })
    var callback = function () { if (!called) $($el).trigger($.support.transition.end) }
    setTimeout(callback, duration)
    return this
  }

  $(function () {
    $.support.transition = transitionEnd()

    if (!$.support.transition) return

    $.event.special.bsTransitionEnd = {
      bindType: $.support.transition.end,
      delegateType: $.support.transition.end,
      handle: function (e) {
        if ($(e.target).is(this)) return e.handleObj.handler.apply(this, arguments)
      }
    }
  })

}(jQuery);
</script>
<script>
/* ========================================================================
 * Bootstrap: collapse.js v3.3.7
 * http://getbootstrap.com/javascript/#collapse
 * ========================================================================
 * Copyright 2011-2016 Twitter, Inc.
 * Licensed under MIT (https://github.com/twbs/bootstrap/blob/master/LICENSE)
 * ======================================================================== */

/* jshint latedef: false */

+function ($) {
  'use strict';

  // COLLAPSE PUBLIC CLASS DEFINITION
  // ================================

  var Collapse = function (element, options) {
    this.$element      = $(element)
    this.options       = $.extend({}, Collapse.DEFAULTS, options)
    this.$trigger      = $('[data-toggle="collapse"][href="#' + element.id + '"],' +
                           '[data-toggle="collapse"][data-target="#' + element.id + '"]')
    this.transitioning = null

    if (this.options.parent) {
      this.$parent = this.getParent()
    } else {
      this.addAriaAndCollapsedClass(this.$element, this.$trigger)
    }

    if (this.options.toggle) this.toggle()
  }

  Collapse.VERSION  = '3.3.7'

  Collapse.TRANSITION_DURATION = 350

  Collapse.DEFAULTS = {
    toggle: true
  }

  Collapse.prototype.dimension = function () {
    var hasWidth = this.$element.hasClass('width')
    return hasWidth ? 'width' : 'height'
  }

  Collapse.prototype.show = function () {
    if (this.transitioning || this.$element.hasClass('in')) return

    var activesData
    var actives = this.$parent && this.$parent.children('.panel').children('.in, .collapsing')

    if (actives && actives.length) {
      activesData = actives.data('bs.collapse')
      if (activesData && activesData.transitioning) return
    }

    var startEvent = $.Event('show.bs.collapse')
    this.$element.trigger(startEvent)
    if (startEvent.isDefaultPrevented()) return

    if (actives && actives.length) {
      Plugin.call(actives, 'hide')
      activesData || actives.data('bs.collapse', null)
    }

    var dimension = this.dimension()

    this.$element
      .removeClass('collapse')
      .addClass('collapsing')[dimension](0)
      .attr('aria-expanded', true)

    this.$trigger
      .removeClass('collapsed')
      .attr('aria-expanded', true)

    this.transitioning = 1

    var complete = function () {
      this.$element
        .removeClass('collapsing')
        .addClass('collapse in')[dimension]('')
      this.transitioning = 0
      this.$element
        .trigger('shown.bs.collapse')
    }

    if (!$.support.transition) return complete.call(this)

    var scrollSize = $.camelCase(['scroll', dimension].join('-'))

    this.$element
      .one('bsTransitionEnd', $.proxy(complete, this))
      .emulateTransitionEnd(Collapse.TRANSITION_DURATION)[dimension](this.$element[0][scrollSize])
  }

  Collapse.prototype.hide = function () {
    if (this.transitioning || !this.$element.hasClass('in')) return

    var startEvent = $.Event('hide.bs.collapse')
    this.$element.trigger(startEvent)
    if (startEvent.isDefaultPrevented()) return

    var dimension = this.dimension()

    this.$element[dimension](this.$element[dimension]())[0].offsetHeight

    this.$element
      .addClass('collapsing')
      .removeClass('collapse in')
      .attr('aria-expanded', false)

    this.$trigger
      .addClass('collapsed')
      .attr('aria-expanded', false)

    this.transitioning = 1

    var complete = function () {
      this.transitioning = 0
      this.$element
        .removeClass('collapsing')
        .addClass('collapse')
        .trigger('hidden.bs.collapse')
    }

    if (!$.support.transition) return complete.call(this)

    this.$element
      [dimension](0)
      .one('bsTransitionEnd', $.proxy(complete, this))
      .emulateTransitionEnd(Collapse.TRANSITION_DURATION)
  }

  Collapse.prototype.toggle = function () {
    this[this.$element.hasClass('in') ? 'hide' : 'show']()
  }

  Collapse.prototype.getParent = function () {
    return $(this.options.parent)
      .find('[data-toggle="collapse"][data-parent="' + this.options.parent + '"]')
      .each($.proxy(function (i, element) {
        var $element = $(element)
        this.addAriaAndCollapsedClass(getTargetFromTrigger($element), $element)
      }, this))
      .end()
  }

  Collapse.prototype.addAriaAndCollapsedClass = function ($element, $trigger) {
    var isOpen = $element.hasClass('in')

    $element.attr('aria-expanded', isOpen)
    $trigger
      .toggleClass('collapsed', !isOpen)
      .attr('aria-expanded', isOpen)
  }

  function getTargetFromTrigger($trigger) {
    var href
    var target = $trigger.attr('data-target')
      || (href = $trigger.attr('href')) && href.replace(/.*(?=#[^\s]+$)/, '') // strip for ie7

    return $(target)
  }


  // COLLAPSE PLUGIN DEFINITION
  // ==========================

  function Plugin(option) {
    return this.each(function () {
      var $this   = $(this)
      var data    = $this.data('bs.collapse')
      var options = $.extend({}, Collapse.DEFAULTS, $this.data(), typeof option == 'object' && option)

      if (!data && options.toggle && /show|hide/.test(option)) options.toggle = false
      if (!data) $this.data('bs.collapse', (data = new Collapse(this, options)))
      if (typeof option == 'string') data[option]()
    })
  }

  var old = $.fn.collapse

  $.fn.collapse             = Plugin
  $.fn.collapse.Constructor = Collapse


  // COLLAPSE NO CONFLICT
  // ====================

  $.fn.collapse.noConflict = function () {
    $.fn.collapse = old
    return this
  }


  // COLLAPSE DATA-API
  // =================

  $(document).on('click.bs.collapse.data-api', '[data-toggle="collapse"]', function (e) {
    var $this   = $(this)

    if (!$this.attr('data-target')) e.preventDefault()

    var $target = getTargetFromTrigger($this)
    var data    = $target.data('bs.collapse')
    var option  = data ? 'toggle' : $this.data()

    Plugin.call($target, option)
  })

}(jQuery);
</script>
<script>
window.initializeCodeFolding = function(show) {

  // handlers for show-all and hide all
  $("#rmd-show-all-code").click(function() {
    // close the dropdown menu when an option is clicked
    $("#allCodeButton").dropdown("toggle");
    $('div.r-code-collapse').each(function() {
      $(this).collapse('show');
    });
  });
  $("#rmd-hide-all-code").click(function() {
    // close the dropdown menu when an option is clicked
    $("#allCodeButton").dropdown("toggle");
    $('div.r-code-collapse').each(function() {
      $(this).collapse('hide');
    });
  });

  // index for unique code element ids
  var currentIndex = 1;

  // select all R code blocks
  var rCodeBlocks = $('pre.sourceCode, pre.r, pre.python, pre.bash, pre.sql, pre.cpp, pre.stan');
  rCodeBlocks.each(function() {

    // if code block has been labeled with class `fold-show`, show the code on init!
    var classList = $(this).attr('class').split(/\s+/);
    for (var i = 0; i < classList.length; i++) {
    if (classList[i] === 'fold-show') {
        show = true;
      }
    }

    // create a collapsable div to wrap the code in
    var div = $('<div class="collapse r-code-collapse"></div>');
    if (show)
      div.addClass('in');
    var id = 'rcode-643E0F36' + currentIndex++;
    div.attr('id', id);
    $(this).before(div);
    $(this).detach().appendTo(div);

    // add a show code button right above
    var showCodeText = $('<span>' + (show ? 'Hide' : 'Code') + '</span>');
    var showCodeButton = $('<button type="button" class="btn btn-default btn-xs code-folding-btn pull-right"></button>');
    showCodeButton.append(showCodeText);
    showCodeButton
        .attr('data-toggle', 'collapse')
        .attr('data-target', '#' + id)
        .attr('aria-expanded', show)
        .attr('aria-controls', id);

    var buttonRow = $('<div class="row"></div>');
    var buttonCol = $('<div class="col-md-12"></div>');

    buttonCol.append(showCodeButton);
    buttonRow.append(buttonCol);

    div.before(buttonRow);

    // hack: return show to false, otherwise all next codeBlocks will be shown!
    show = false;

    // update state of button on show/hide
    div.on('hidden.bs.collapse', function () {
      showCodeText.text('Code');
    });
    div.on('show.bs.collapse', function () {
      showCodeText.text('Hide');
    });
  });

}
</script>
<script>
/* ========================================================================
 * Bootstrap: dropdown.js v3.3.7
 * http://getbootstrap.com/javascript/#dropdowns
 * ========================================================================
 * Copyright 2011-2016 Twitter, Inc.
 * Licensed under MIT (https://github.com/twbs/bootstrap/blob/master/LICENSE)
 * ======================================================================== */


+function ($) {
  'use strict';

  // DROPDOWN CLASS DEFINITION
  // =========================

  var backdrop = '.dropdown-backdrop'
  var toggle   = '[data-toggle="dropdown"]'
  var Dropdown = function (element) {
    $(element).on('click.bs.dropdown', this.toggle)
  }

  Dropdown.VERSION = '3.3.7'

  function getParent($this) {
    var selector = $this.attr('data-target')

    if (!selector) {
      selector = $this.attr('href')
      selector = selector && /#[A-Za-z]/.test(selector) && selector.replace(/.*(?=#[^\s]*$)/, '') // strip for ie7
    }

    var $parent = selector && $(selector)

    return $parent && $parent.length ? $parent : $this.parent()
  }

  function clearMenus(e) {
    if (e && e.which === 3) return
    $(backdrop).remove()
    $(toggle).each(function () {
      var $this         = $(this)
      var $parent       = getParent($this)
      var relatedTarget = { relatedTarget: this }

      if (!$parent.hasClass('open')) return

      if (e && e.type == 'click' && /input|textarea/i.test(e.target.tagName) && $.contains($parent[0], e.target)) return

      $parent.trigger(e = $.Event('hide.bs.dropdown', relatedTarget))

      if (e.isDefaultPrevented()) return

      $this.attr('aria-expanded', 'false')
      $parent.removeClass('open').trigger($.Event('hidden.bs.dropdown', relatedTarget))
    })
  }

  Dropdown.prototype.toggle = function (e) {
    var $this = $(this)

    if ($this.is('.disabled, :disabled')) return

    var $parent  = getParent($this)
    var isActive = $parent.hasClass('open')

    clearMenus()

    if (!isActive) {
      if ('ontouchstart' in document.documentElement && !$parent.closest('.navbar-nav').length) {
        // if mobile we use a backdrop because click events don't delegate
        $(document.createElement('div'))
          .addClass('dropdown-backdrop')
          .insertAfter($(this))
          .on('click', clearMenus)
      }

      var relatedTarget = { relatedTarget: this }
      $parent.trigger(e = $.Event('show.bs.dropdown', relatedTarget))

      if (e.isDefaultPrevented()) return

      $this
        .trigger('focus')
        .attr('aria-expanded', 'true')

      $parent
        .toggleClass('open')
        .trigger($.Event('shown.bs.dropdown', relatedTarget))
    }

    return false
  }

  Dropdown.prototype.keydown = function (e) {
    if (!/(38|40|27|32)/.test(e.which) || /input|textarea/i.test(e.target.tagName)) return

    var $this = $(this)

    e.preventDefault()
    e.stopPropagation()

    if ($this.is('.disabled, :disabled')) return

    var $parent  = getParent($this)
    var isActive = $parent.hasClass('open')

    if (!isActive && e.which != 27 || isActive && e.which == 27) {
      if (e.which == 27) $parent.find(toggle).trigger('focus')
      return $this.trigger('click')
    }

    var desc = ' li:not(.disabled):visible a'
    var $items = $parent.find('.dropdown-menu' + desc)

    if (!$items.length) return

    var index = $items.index(e.target)

    if (e.which == 38 && index > 0)                 index--         // up
    if (e.which == 40 && index < $items.length - 1) index++         // down
    if (!~index)                                    index = 0

    $items.eq(index).trigger('focus')
  }


  // DROPDOWN PLUGIN DEFINITION
  // ==========================

  function Plugin(option) {
    return this.each(function () {
      var $this = $(this)
      var data  = $this.data('bs.dropdown')

      if (!data) $this.data('bs.dropdown', (data = new Dropdown(this)))
      if (typeof option == 'string') data[option].call($this)
    })
  }

  var old = $.fn.dropdown

  $.fn.dropdown             = Plugin
  $.fn.dropdown.Constructor = Dropdown


  // DROPDOWN NO CONFLICT
  // ====================

  $.fn.dropdown.noConflict = function () {
    $.fn.dropdown = old
    return this
  }


  // APPLY TO STANDARD DROPDOWN ELEMENTS
  // ===================================

  $(document)
    .on('click.bs.dropdown.data-api', clearMenus)
    .on('click.bs.dropdown.data-api', '.dropdown form', function (e) { e.stopPropagation() })
    .on('click.bs.dropdown.data-api', toggle, Dropdown.prototype.toggle)
    .on('keydown.bs.dropdown.data-api', toggle, Dropdown.prototype.keydown)
    .on('keydown.bs.dropdown.data-api', '.dropdown-menu', Dropdown.prototype.keydown)

}(jQuery);
</script>
<style type="text/css">
.code-folding-btn {
  margin-bottom: 4px;
}

.row { display: flex; }
.collapse { display: none; }
.in { display:block }
.pull-right > .dropdown-menu {
    right: 0;
    left: auto;
}

.dropdown-menu {
    position: absolute;
    top: 100%;
    left: 0;
    z-index: 1000;
    display: none;
    float: left;
    min-width: 160px;
    padding: 5px 0;
    margin: 2px 0 0;
    font-size: 14px;
    text-align: left;
    list-style: none;
    background-color: #fff;
    -webkit-background-clip: padding-box;
    background-clip: padding-box;
    border: 1px solid #ccc;
    border: 1px solid rgba(0,0,0,.15);
    border-radius: 4px;
    -webkit-box-shadow: 0 6px 12px rgba(0,0,0,.175);
    box-shadow: 0 6px 12px rgba(0,0,0,.175);
}

.open > .dropdown-menu {
    display: block;
    color: #ffffff;
    background-color: #ffffff;
    background-image: none;
    border-color: #92897e;
}

.dropdown-menu > li > a {
  display: block;
  padding: 3px 20px;
  clear: both;
  font-weight: 400;
  line-height: 1.42857143;
  color: #000000;
  white-space: nowrap;
}

.dropdown-menu > li > a:hover,
.dropdown-menu > li > a:focus {
  color: #ffffff;
  text-decoration: none;
  background-color: #e95420;
}

.dropdown-menu > .active > a,
.dropdown-menu > .active > a:hover,
.dropdown-menu > .active > a:focus {
  color: #ffffff;
  text-decoration: none;
  background-color: #e95420;
  outline: 0;
}
.dropdown-menu > .disabled > a,
.dropdown-menu > .disabled > a:hover,
.dropdown-menu > .disabled > a:focus {
  color: #aea79f;
}

.dropdown-menu > .disabled > a:hover,
.dropdown-menu > .disabled > a:focus {
  text-decoration: none;
  cursor: not-allowed;
  background-color: transparent;
  background-image: none;
  filter: progid:DXImageTransform.Microsoft.gradient(enabled = false);
}

.btn {
  display: inline-block;
  margin-bottom: 1;
  font-weight: normal;
  text-align: center;
  white-space: nowrap;
  vertical-align: middle;
  -ms-touch-action: manipulation;
      touch-action: manipulation;
  cursor: pointer;
  background-image: none;
  border: 1px solid transparent;
  padding: 4px 8px;
  font-size: 14px;
  line-height: 1.42857143;
  border-radius: 4px;
  -webkit-user-select: none;
  -moz-user-select: none;
  -ms-user-select: none;
  user-select: none;
}

.btn:focus,
.btn:active:focus,
.btn.active:focus,
.btn.focus,
.btn:active.focus,
.btn.active.focus {
  outline: 5px auto -webkit-focus-ring-color;
  outline-offset: -2px;
}
.btn:hover,
.btn:focus,
.btn.focus {
  color: #ffffff;
  text-decoration: none;
}
.btn:active,
.btn.active {
  background-image: none;
  outline: 0;
  box-shadow: inset 0 3px 5px rgba(0, 0, 0, 0.125);
}
.btn.disabled,
.btn[disabled],
fieldset[disabled] .btn {
  cursor: not-allowed;
  filter: alpha(opacity=65);
  opacity: 0.65;
  box-shadow: none;
}
a.btn.disabled,
fieldset[disabled] a.btn {
  pointer-events: none;
}
.btn-default {
  color: #ffffff;
  background-color: #aea79f; #important
  border-color: #aea79f;
}

.btn-default:focus,
.btn-default.focus {
  color: #ffffff;
  background-color: #978e83;
  border-color: #6f675e;
}

.btn-default:hover {
  color: #ffffff;
  background-color: #978e83;
  border-color: #92897e;
}
.btn-default:active,
.btn-default.active,
.btn-group > .btn:not(:first-child):not(:last-child):not(.dropdown-toggle) {
  border-radius: 0;
}
.btn-group > .btn:first-child {
  margin-left: 0;
}
.btn-group > .btn:first-child:not(:last-child):not(.dropdown-toggle) {
  border-top-right-radius: 0;
  border-bottom-right-radius: 0;
}
.btn-group > .btn:last-child:not(:first-child),
.btn-group > .dropdown-toggle:not(:first-child) {
  border-top-left-radius: 0;
  border-bottom-left-radius: 0;
}
.btn-group > .btn-group {
  float: left;
}
.btn-group > .btn-group:not(:first-child):not(:last-child) > .btn {
  border-radius: 0;
}
.btn-group > .btn-group:first-child:not(:last-child) > .btn:last-child,
.btn-group > .btn-group:first-child:not(:last-child) > .dropdown-toggle {
  border-top-right-radius: 0;
  border-bottom-right-radius: 0;
}
.btn-group > .btn-group:last-child:not(:first-child) > .btn:first-child {
  border-top-left-radius: 0;
  border-bottom-left-radius: 0;
}
.btn-group .dropdown-toggle:active,
.btn-group.open .dropdown-toggle {
  outline: 0;
}
.btn-group > .btn + .dropdown-toggle {
  padding-right: 8px;
  padding-left: 8px;
}
.btn-group > .btn-lg + .dropdown-toggle {
  padding-right: 12px;
  padding-left: 12px;
}
.btn-group.open .dropdown-toggle {
  box-shadow: inset 0 3px 5px rgba(0, 0, 0, 0.125);
}
.btn-group.open .dropdown-toggle.btn-link {
  box-shadow: none;
}

</style>
<script>
var str = '<div class="btn-group pull-right" style="position: fixed; right: 50px; top: 10px; z-index: 200"><button type="button" class="btn btn-default btn-xs dropdown-toggle" id="allCodeButton" data-toggle="dropdown" aria-haspopup="true" aria-expanded="true" data-_extension-text-contrast=""><span>Code</span> <span class="caret"></span></button><ul class="dropdown-menu" style="min-width: 50px;"><li><a id="rmd-show-all-code" href="#">Show All Code</a></li><li><a id="rmd-hide-all-code" href="#">Hide All Code</a></li></ul></div>';
document.write(str);
</script>
<script>
$(document).ready(function () {
  window.initializeCodeFolding("show" === "hide");
});
</script>


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<style type="text/css">
/* Used with Pandoc 2.11+ new --citeproc when CSL is used */
div.csl-bib-body { }
div.csl-entry {
  clear: both;
}
.hanging div.csl-entry {
  margin-left:2em;
  text-indent:-2em;
}
div.csl-left-margin {
  min-width:2em;
  float:left;
}
div.csl-right-inline {
  margin-left:2em;
  padding-left:1em;
}
div.csl-indent {
  margin-left: 2em;
}
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li class="chapter" data-level="1" data-path=""><a href="#introducción"><i class="fa fa-check"></i><b>1</b> INTRODUCCIÓN</a>
<ul>
<li class="chapter" data-level="1.1" data-path=""><a href="#proceso-arma"><i class="fa fa-check"></i><b>1.1</b> Proceso ARMA</a></li>
<li class="chapter" data-level="1.2" data-path=""><a href="#función-impulso-respuesta-irf"><i class="fa fa-check"></i><b>1.2</b> Función Impulso Respuesta (IRF)</a></li>
</ul></li>
<li class="chapter" data-level="2" data-path=""><a href="#vectores-autoregresivos-var"><i class="fa fa-check"></i><b>2</b> Vectores Autoregresivos (VAR)</a>
<ul>
<li class="chapter" data-level="2.1" data-path=""><a href="#función-impulso-respuesta"><i class="fa fa-check"></i><b>2.1</b> Función Impulso Respuesta</a></li>
<li class="chapter" data-level="2.2" data-path=""><a href="#vectores-autoregresivos-estructurales"><i class="fa fa-check"></i><b>2.2</b> Vectores autoregresivos estructurales</a></li>
<li class="chapter" data-level="2.3" data-path=""><a href="#aplicación-cochrane94"><i class="fa fa-check"></i><b>2.3</b> Aplicación <span class="citation">Cochrane (<span>1994</span>)</span></a></li>
<li class="chapter" data-level="2.4" data-path=""><a href="#ortogonalización-de-sims"><i class="fa fa-check"></i><b>2.4</b> Ortogonalización de Sims</a></li>
<li class="chapter" data-level="2.5" data-path=""><a href="#blanchard-quah-ortogonalización-restricciones-sobre-c1"><i class="fa fa-check"></i><b>2.5</b> Blanchard-Quah ortogonalización (restricciones) sobre C(1)</a></li>
<li class="chapter" data-level="2.6" data-path=""><a href="#aplicación-blanchard88"><i class="fa fa-check"></i><b>2.6</b> Aplicación <span class="citation">Blanchard and Quah (<span>1988</span>)</span></a></li>
<li class="chapter" data-level="2.7" data-path=""><a href="#aplicación-gali99"><i class="fa fa-check"></i><b>2.7</b> Aplicación <span class="citation">Gali (<span>1999</span>)</span></a></li>
</ul></li>
<li class="chapter" data-level="3" data-path=""><a href="#paquetes-en-r"><i class="fa fa-check"></i><b>3</b> Paquetes en R</a>
<ul>
<li class="chapter" data-level="3.1" data-path=""><a href="#paquete-svars"><i class="fa fa-check"></i><b>3.1</b> Paquete SVARS</a></li>
<li class="chapter" data-level="3.2" data-path=""><a href="#bla-bla"><i class="fa fa-check"></i><b>3.2</b> BLA Bla</a></li>
</ul></li>
<li class="chapter" data-level="" data-path=""><a href="#referencias"><i class="fa fa-check"></i>Referencias</a></li>
</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">VECTORES AUTOREGRESIVOS (VAR)</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="header">
<h1 class="title">VECTORES AUTOREGRESIVOS (VAR)</h1>
<p class="author"><em><a href="https://ortiz-cevallos.github.io/MYSELF/">Luis Ortiz-Cevallos</a></em></p>
<p class="date"><em>2022-07-05</em></p>
</div>
<div id="introducción" class="section level1 hasAnchor" number="1">
<h1><span class="header-section-number">Capítulo 1</span> INTRODUCCIÓN<a href="#introducción" class="anchor-section" aria-label="Anchor link to header"></a></h1>
<div id="proceso-arma" class="section level2 hasAnchor" number="1.1">
<h2><span class="header-section-number">1.1</span> Proceso ARMA<a href="#proceso-arma" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Un proceso autoregresivo con media móvil (ARMA) es tipicamente continuo. Para disponer de un proceso ARMA es requerido un <strong>proceso ruido blanco</strong></p>
<p>Un proceso ruido blanco es aquel que cumple con las sigueintes condiciones:</p>
<p><span class="math display">\[\begin{align}
E(\epsilon_{t})&amp;=0\\
Var(\epsilon_{t})&amp;=\sigma^{2}\\
Cov(\epsilon_{t}, \epsilon_{t+j})&amp;=0\;\; \forall j
\end{align}\]</span></p>
<p>Dado ese proceso ruido blanco, un proceso ARMA(p,q) es:</p>
<p><span class="math display">\[\begin{align}
x_{t}&amp;= a+p_{1}x_{t-1}+p_{2}x_{t-2}+\cdots+p_{p}x_{t-p}+\epsilon_{t}+\theta_{1}\epsilon_{t-1}+\cdots+\theta_{q}\epsilon_{t-q}\\
x_{t}&amp;= a+\sum_{j=1}^{p}p_{j}x_{t-j}+\epsilon_{t}+\sum_{j=1}^{q}\theta_{j}\epsilon_{t-j}
\end{align}\]</span></p>
<p><em>Operador de rezago</em> si definimo <em>L</em> tal que <span class="math inline">\(L(x_{t})=x_{t-1}\)</span>, es posible definir un polinomio de rezagos como:</p>
<p><span class="math inline">\(a(L)=1L^{0}+a_{1}L^{1}+\cdots+a_{p}L^{p}\)</span></p>
<p>De manera que un proceso ARMA(p, q) pueda ser escrito como:
<span class="math display">\[\begin{equation}
a(L)x_{t}=b(L)\epsilon_{t}
\end{equation}\]</span></p>
<p>Lo estupendo de un proceso ARMA(p,q) es que <strong>no son únicos</strong>. Permiten invertir el componente AR del proceso como un MA y viceversa. Considere un ARMA(1,0):</p>
<p><span class="math display">\[\begin{align}
x_{t}&amp;=px_{t-1}+\epsilon_{t}\\
(1-pL)x_{t}&amp;=\epsilon_{t}\\
x_{t}&amp;=\frac{1}{(1-pL)}\epsilon_{t}\\
x_{t}&amp;=\frac{1}{(1-pL)}\epsilon_{t}\frac{1+pL+p^{2}L^{2}+p^{3}L^{3}\cdots}{1+pL+p^{2}L^{2}+p^{3}L^{3}\cdots}\\
x_{t}&amp;=(1+pL+p^{2}L^{2}+p^{3}L^{3}\cdots)\epsilon_{t}=b(L)\epsilon_{t}\\
x_{t}&amp;=\sum_{j=0}^{\infty}p^{j}\epsilon_{t-j}
\end{align}\]</span></p>
<p>De manera análoga podemos pasar de un proceso MA(1) a uno AR(<span class="math inline">\(\infty\)</span>):
<span class="math display">\[\begin{align}
x_{t}&amp;=\epsilon_{t}+\theta\epsilon_{t-1}\\
x_{t}&amp;=(1+\theta L)\epsilon_{t}\\
\frac{1}{(1+\theta L)}x_{t}&amp;=\epsilon_{t}\\
\frac{1}{(1+\theta L)}x_{t}\frac{1-\theta L-\theta^{2}L^{2}-\theta^{3}L^{3}\cdots}{1-\theta L-\theta^{2}L^{2}-\theta^{3}L^{3}\cdots}&amp;=\epsilon_{t}\\
(1-\theta L-\theta^{2}L^{2}-\theta^{3}L^{3}\cdots)x_{t}&amp;=a(L)x_{t}=\epsilon_{t}\\
\sum_{j=0}^{\infty}-\theta^{j}x_{t}&amp;=\epsilon_{t-j}
\end{align}\]</span></p>
<p>Los anteriores resultados muestran que se puede estimar un proceso MA aproximándolo como un proceso AR. Un proceso AR puede ser estimado consistentemente a través de OLS.</p>
</div>
<div id="función-impulso-respuesta-irf" class="section level2 hasAnchor" number="1.2">
<h2><span class="header-section-number">1.2</span> Función Impulso Respuesta (IRF)<a href="#función-impulso-respuesta-irf" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>La IRF es el cambio entre el valor esperado de una variable aleatoria condicionado sobre la realizaciones de la incertidumbre en un punto en el tiempo entre el corriente con respecto al futuro. Formalmente:</p>
<p><span class="math display">\[\begin{equation}
IRF=E_{t}x_{t+j}-E_{t-1}x_{t+j}\;\; \forall j\geq 0
\end{equation}\]</span></p>
<p>Si se tiene un proceso ARMA:</p>
<p><span class="math display">\[\begin{align}
x_{t}&amp;=b(L)\epsilon_{t}\\
E_{t}x_{t+1}&amp;=E_{t}b(L)\epsilon_{t+1}=b(L)\epsilon_{t}\\
\end{align}\]</span></p>
<p>El anterior resultados es debido a que <span class="math inline">\(E_{t}x_{t+j}=0\;\;\forall j&gt;0\)</span> lo que significa, usando la misma lógica que que <span class="math inline">\(E_{t-1}x_{t+j}=0\;\;\forall j\geq 0\)</span>.</p>
<p>En conclusión la IFR es <span class="math inline">\(b(L)\epsilon_{t}\)</span>. La representación MA de un proceso es la IFR.</p>
</div>
</div>
<div id="vectores-autoregresivos-var" class="section level1 hasAnchor" number="2">
<h1><span class="header-section-number">Capítulo 2</span> Vectores Autoregresivos (VAR)<a href="#vectores-autoregresivos-var" class="anchor-section" aria-label="Anchor link to header"></a></h1>
<p>Un VAR consiste en un conjunto de k variables endógenas <span class="math inline">\(Y_{t}=\{y_{1t},\cdots, y_{kt}\}\)</span>.</p>
<p>En el caso de un proceso ARMA(2,1):
<span class="math inline">\(Y_t = \Phi_1Y_{t-1} + \Phi_2Y_{t-2} + u_t + \theta_1u_{t-1}\)</span></p>
<p>Podemos reescribirlo como:
<span class="math display">\[\begin{equation}
\left( \begin{array}{c}
Y_{t} \\
Y_{t-1} \\
u_{t}
\end{array}
\right)=\left( \begin{array}{ccc}
\Phi_1 &amp; \Phi_2 &amp; \theta_1\\
1 &amp; 0 &amp; 0\\
0 &amp; 0 &amp; 0
\end{array}
\right) \left( \begin{array}{c}
Y_{t-1} \\
Y_{t-2} \\
u_{t-1}
\end{array}
\right)+\left( \begin{array}{c}
1\\
0 \\
1
\end{array}
\right) \left( \begin{array}{c}
u_{t} \\
0 \\
0
\end{array}
\right)
\nonumber
\end{equation}\]</span></p>
<p>Lo anterior no es otra cosa que un proceso AR(1), matricialmente:</p>
<p><span class="math inline">\(X_t = AX_{t−1} + Cw_t\)</span></p>
<p>Este proceso tiene los siguientes supuestos:</p>
<ol style="list-style-type: decimal">
<li><p><span class="math inline">\(E(w_{t})=0\)</span></p></li>
<li><p><span class="math inline">\(E(w_{t}w_{t}^{\tau})=\Sigma_{w}\)</span> una matriz de covarianza invariante en el tiempo la cual es definida positiva.</p></li>
</ol>
<div id="función-impulso-respuesta" class="section level2 hasAnchor" number="2.1">
<h2><span class="header-section-number">2.1</span> Función Impulso Respuesta<a href="#función-impulso-respuesta" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>La función impulso respuesta es la senda que sigue una serie cuando enfrenta un shock unitario.</p>
<p>Es interesante por:</p>
<ol style="list-style-type: decimal">
<li>Caracteriza el comportamiento del modelo.</li>
<li>Permite la discusión de quién causa a quién.</li>
</ol>
<p>Para una proceso AR(1) <span class="math inline">\(x_{t}=p x_{t-1}+\epsilon_{t}\)</span> el cual lo expresamos en MA(<span class="math inline">\(\infty\)</span>) como <span class="math inline">\(x_{t}=\sum_{j=0}^{\infty}p^{j} \epsilon_{t-j}\)</span>, su impulso respuesta es:</p>
<p><span class="math inline">\(\begin{array}{cccccccc} \epsilon_{t} &amp;\colon &amp;0&amp;0&amp;1&amp;0&amp;0&amp;0 \\ x_{t} &amp;\colon &amp;0&amp;0&amp; p &amp;p^{2}&amp;p^{3}&amp;\cdots \end{array}\)</span></p>
<p>¿Por qué es importante definir un proceso como un MA<span class="math inline">\((\infty)\)</span>?</p>
<ol style="list-style-type: decimal">
<li>La representación MA infinito de todo proceso es <em>la función impulso respuesta</em></li>
<li>La función impulso respuesta es equivalente a <span class="math inline">\(E_{t}(x_{t+j})-E_{t-1}(x_{t+j})\)</span> que no es otra cosa que el error de pronóstico hacia j pasos adelante.</li>
</ol>
</div>
<div id="vectores-autoregresivos-estructurales" class="section level2 hasAnchor" number="2.2">
<h2><span class="header-section-number">2.2</span> Vectores autoregresivos estructurales<a href="#vectores-autoregresivos-estructurales" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Casi todas las variables en economía podrían considerarse
hasta cierto punto endógenas. Sin embargo, prima un criterio de relevancia. Si bien es cierto que un comerciante al fijar el precio de una manzana está afectando la inflación, parece razonable suponer que la inflación es exógena al precio de las manzanas de este comerciante.</p>
<p>Por tanto si la inflación está dado por <span class="math inline">\(\pi\)</span> y el precio de las manzanas por <span class="math inline">\(m\)</span> tenemos el siguiente VAR</p>
<p><span class="math display">\[\begin{align}
\alpha_{1,1}^{+}\pi_t+\alpha_{1,2}^{+}m_t &amp;= \beta_{1,1}^{+}\pi_{t-1}+\beta_{1,2}^{+}m_{t-1}+e_{\pi,t}\\
\alpha_{2,1}^{+}\pi_t+\alpha_{2,2}^{+}m_t &amp;= \beta_{2,1}^{+}\pi_{t-1}+\beta_{2,2}^{+}m_{t-1}+e_{m,t}
\end{align}\]</span></p>
<p>Sí normalizamos el VAR tenemos lo siguiente:
<span class="math display">\[\begin{align}
\pi_t+\alpha_{1,2}m_t &amp;= \beta_{1,1}\pi_{t-1}+\beta_{1,2}m_{t-1}+e_{\pi,t}\\
\alpha_{2,1}\pi_t+m_t &amp;= \beta_{2,1}\pi_{t-1}+\beta_{2,2}m_{t-1}+e_{m,t}
\end{align}\]</span></p>
<p>Si resolvemos el sistema de ecuaciones simultáneas, despejamos las
variables obtenemos un VAR en su forma reducida; comenzamos con la primera ecuación:</p>
<p><span class="math display">\[\begin{align}
\pi_{t} &amp;=\beta_{1,1}\pi_{t-1}+\beta_{1,2}m_{t-1}+e_{\pi,t}\\
        &amp;- \alpha_{1,2}(\beta_{2,1}\pi_{t-1}+\beta_{2,2}m_{t-1}-\alpha_{2,1}\pi_t+e_{m,t})\\
        \pi_{t} &amp;=\frac{(\beta_{1,1}-\alpha_{1,2}\beta_{2,1})}{(1+\alpha_{1,2}\alpha_{2,1})}\pi_{t-1}+ \frac{(\beta_{1,2}-\alpha_{1,2}\beta_{2,2})}{(1+\alpha_{1,2}\alpha_{2,1})}m_{t-1}+\frac{1}{(1+\alpha_{1,2}\alpha_{2,1})}e_{\pi,t}- \frac{\alpha_{1,2}}{(1+\alpha_{1,2}\alpha_{2,1})}e_{m,t}\\
\pi_{t}&amp;=\gamma_{\pi}\pi_{t-1}+\gamma_{m}m_{t-1}+\gamma_{e_{\pi}}e_{\pi,t}+\gamma_{e_{m}}e_{m,t}       
\end{align}\]</span></p>
<p>De manera análoga para las manzanas:
<span class="math display">\[\begin{align}
m_{t} &amp;=\beta_{2,1}\pi_{t-1}+\beta_{2,2}m_{t-1}+e_{m,t}\\
        &amp;- \alpha_{2,1}(\beta_{1,1}\pi_{t-1}+\beta_{1,2}m_{t-1}-\alpha_{1,2}m_t+e_{\pi,t})\\
        m_{t} &amp;=\frac{(\beta_{2,1}-\alpha_{2,1}\beta_{1,1})}{(1+\alpha_{1,2}\alpha_{2,1})}\pi_{t-1}+ \frac{(\beta_{2,2}-\alpha_{2,1}\beta_{1,2})}{(1+\alpha_{1,2}\alpha_{2,1})}m_{t-1}+\frac{\alpha_{2,1}}{(1+\alpha_{1,2}\alpha_{2,1})}e_{\pi,t}- \frac{1}{(1+\alpha_{1,2}\alpha_{2,1})}e_{m,t}\\
m_{t}&amp;=\omega_{\pi}\pi_{t-1}+\omega_{m}m_{t-1}+\omega_{e_{\pi}}e_{\pi,t}+\omega_{e_{m}}e_{m,t}       
\end{align}\]</span></p>
<p>Entonces ahora tenemos el siguiente sistema:
<span class="math display">\[\begin{align}
\pi_{t}&amp;=\gamma_{\pi}\pi_{t-1}+\gamma_{m}m_{t-1}+\gamma_{e_{\pi}}e_{\pi,t}+\gamma_{e_{m}}e_{m,t}\\   
m_{t}&amp;=\omega_{\pi}\pi_{t-1}+\omega_{m}m_{t-1}+\omega_{e_{\pi}}e_{\pi,t}+\omega_{e_{m}}e_{m,t}       
\end{align}\]</span></p>
<p>El sistema anterior puede escribirse de forma matricial como:
<span class="math display">\[\begin{equation}
    \left( \begin{array}{c}
    \pi_{t} \\
      m_{t}
    \end{array}\right)=\left( \begin{array}{cc}
\gamma_{\pi} &amp; \gamma_{m}\\
\omega_{\pi} &amp; \omega_{m}
    \end{array}
    \right) \left( \begin{array}{c}
    \pi_{t-1}\\
      m_{t-1}
    \end{array}
    \right) +
\left( \begin{array}{cc}
\gamma_{e_{\pi}} &amp; \gamma_{e_{m}}\\
\omega_{e_{\pi}} &amp; \omega_{e_{m}}
    \end{array}
    \right) \left( \begin{array}{c}
    e_{\pi,t}\\
    e_{m,t}
    \end{array}
    \right)
\end{equation}\]</span></p>
<p>Noten que para que sea un sistema estructural, es decir haya un fundamento económico que defina el orden de prelación de la variable exógena <span class="math inline">\(\pi\)</span> hacia la endógena <span class="math inline">\(m\)</span>, <span class="math inline">\(\alpha_{1,2}\)</span> debe ser igual a cero. Por lo que el sistema podría ser escrito como:</p>
<p><span class="math display">\[\begin{equation}
    \left( \begin{array}{c}
    \pi_{t} \\
      m_{t}
    \end{array}\right)=\left( \begin{array}{cc}
\beta_{1,1} &amp; \beta_{1,2}\\
\omega_{\pi} &amp; \omega_{m}
    \end{array}
    \right) \left( \begin{array}{c}
    \pi_{t-1}\\
      m_{t-1}
    \end{array}
    \right) +
\left( \begin{array}{cc}
\gamma_{e_{\pi}} &amp; 0\\
\omega_{e_{\pi}} &amp; 1
    \end{array}
    \right) \left( \begin{array}{c}
    e_{\pi,t}\\
    e_{m,t}
    \end{array}
    \right)
\end{equation}\]</span></p>
<p>Expresándolo de forma matricial tenermos:</p>
<p><span class="math display">\[\begin{equation}
\label{e1}
x_t = \Gamma x_{t−1} + Bw_t
\end{equation}\]</span></p>
<p>Reordenando:</p>
<p><span class="math display">\[\begin{align}
x_{t}-\Gamma x_{t−1} &amp;=  Bw_t\\
A(L)x_{t}&amp;=  Bw_t
\end{align}\]</span></p>
<p>Donde <span class="math inline">\(A(L)=I-AL\)</span> con A:</p>
<p><span class="math display">\[\begin{equation}
A=\left( \begin{array}{cc}
\beta_{1,1} &amp; \beta_{1,2}\\
\omega_{\pi} &amp; \omega_{m}
    \end{array}
    \right)
\end{equation}\]</span></p>
<p>El sistema puede ser estimado de manera consistente y eficiente a través de OLS. La razón de la consistencia es que todos los regresores datan de t-1 (particularmente en este caso y en el caso general de t-1 hacia más atrás) mientras los errores datan en t. El término del error suele conocerse como imnovación. En tanto la estimación OLS es eficiente porque los regresores son los mismos en ambas ecuaciones (por lo que en este caso el método de estimación OLS coincide con el método Seemingly unrelated regressions (SUR)).</p>
<p>En otros casos, por ejemplo, el caso entre el precio de las acciones (x) y el consumo (z), sus innovaciones <span class="math inline">\((e_{x,t}\;e_{z,t})\)</span> están correlacionadas. En esa situación no existe una posible interpretación <em>estructural</em> de esas innovaciones. Pues éstas son afectadas por un <em>factor profundo</em>. Sin embargo, para efectos de pronóstico un VAR con esas variables no tiene importancia el desconocimiento de ese <em>factor profundo</em>. No obstante, para propósito de análisis económmico sí la tiene. Un VAR como el representado por las variables x y z es conocido como de <em>forma reducida</em> pues no es posible dar una interpretación <em>estructural</em> a sus innovaciones.</p>
<p>El análisis de un VAR estructural (SVAR) presupone que las innovaciones representadas en el VAR <span class="math inline">\((e_{x,t}\;e_{z,t})\)</span> son conducidas por un <em>factor profundo</em> ello es un <em>shock estructural</em>. De manera que existe una vinculación líneal entre ese shock estructural <span class="math inline">\((\epsilon_{t}=[\epsilon_{x,t}\;\;\;\epsilon_{z,t}])\)</span> con las innovaciones de la forma reducida <span class="math inline">\((e_{t}=[e_{x,t}\;\;\;e_{z,t}])\)</span>:</p>
<p><span class="math display">\[\begin{equation}
e_{t}=B\epsilon_{t}
\end{equation}\]</span></p>
<p>Sí <span class="math inline">\(\Sigma_e=E(ee^{\tau})\)</span> es la matriz de varianza y covarianza de la forma reducida, manipulando la ecuación anterior se tiene:</p>
<p><span class="math display">\[\begin{equation}
E(ee^{\tau})=BE(\epsilon\epsilon^{\tau})B^{\tau}
\end{equation}\]</span></p>
<p>Como ellas no están correlacionadas los elementos fuera de la diagonal de
<span class="math inline">\(\Sigma_\epsilon=E(\epsilon\epsilon^{\tau})\)</span> son cero, y si normalizamos cada uno de los shocks estructurales haciendo que sean igual a la unidad, se tendrían que <span class="math inline">\(\Sigma_\epsilon=E(\epsilon\epsilon^{\tau})=I\)</span>. Por tanto la ecuación anterior se expresa como:</p>
<p><span class="math display">\[\begin{equation}
E(ee^{\tau})=BB^{\tau}
\end{equation}\]</span></p>
<p>Lo anterior nos lleva a un sistema de ecuaciones que sin algún supuesto estaría indeterminado. Pues para el caso de dos variables existen 4 elementos únicos en la matriz B y 4 elmentos únicos en la matriz <span class="math inline">\(BB^{\tau}\)</span>. Pero en la matriz <span class="math inline">\(\Sigma_e\)</span> solo existen tres elementos únicos, pues una matriz de varianza y covarianza es simétrica. En conclusión sin imponer un supuesto sobre la matriz B no es posible la identificación.</p>
<p>En el caso general de un VAR con n variables, existen n innovaciones, la matriz de varianza y covarianza de esas n innovaciones tendrían <span class="math inline">\(n^{2}\)</span> elementos, pero de los cuales solo <span class="math inline">\(\frac{n^{2}+n}{2}\)</span> serían únicos. Dado que <span class="math inline">\(BB^{\tau}\)</span> tendría <span class="math inline">\(n^{2}\)</span> elementos se requiere que tenga <span class="math inline">\(\frac{n^{2}+n}{2}\)</span> elementos únicos para que el sistema sea identificado, lo que significa imponer <span class="math inline">\(\frac{n(n-1)}{2}\)</span> restricciones. En el caso de n=2 implica imponer sobre B una sola restricción.</p>
<p>Las restricciones que se impongan <em>deben provenir de la teoría económica.</em> Las restricciones que más suelen utilizarse son las del tipo recursivas, ello son las que hacen un supuesto sobre la temporalidad en que algunos shocks solo afectan a ciertas variables con un rezago. Lo anterior implica que algunos elementos en la matriz B son ceros. En el último ejemplo suponga que <span class="math inline">\(\epsilon_{z,t}\)</span> no afectan <span class="math inline">\(x_{t}\)</span> haciendo que el elmento (1,2) en la matriz B sea cero. Con esa restricción los tres elementos restantes de la matriz B pueden ser identificados desde la matriz de varianza y covarianza de los errores en su forma reducida.</p>
<p>¿Son las restricciones del tipo recursiva ciertas en la realidad? Aveces. En la literatura de política monetaria es común pensar que los shocks de esa políticas afectan a la economía con rezago. Supongamos un VAR entre la tasa del fed fund y la tasa de crecimiento real del PIB de USA, <span class="math inline">\(Y_{t}=[i_{t}\;\; \Delta y_{t}]\)</span>. Se podría interpretar como que <span class="math inline">\(\epsilon_{i,t}\)</span> es un shock de política monetaria, mientras <span class="math inline">\(\epsilon_{\Delta y,t}\)</span> es un shock de oferta. Bajo estos supuestos la posición (2, 1) en la matriz B es cero.</p>
<p>Una vez identificado un SVAR, lo que interesa es conocer la función impulso respuesta y la descomposición de la varianza, esto significa que lo que interesa es la dinámica de las variables ante un shock. Como se dijo anteriormente la IFR es la representación MA de un proceso ARMA:</p>
<p><span class="math display">\[\begin{equation}
A(L)Y_{t}=B\epsilon_{t}
\end{equation}\]</span></p>
<p>Si se invierte el proceso AR y definimos <span class="math inline">\(C(L)=A(L)^{-1}B\)</span> ésta sería la matriz de polinomios con los coeficientes de media móviles estructurales. Es importante notar que la matriz B es la que gobierna los impulsos-respuestas por esa razón se conoce como la matriz de impacto.</p>
<p><span class="math display">\[\begin{equation}
Y_{t}=A(L)^{-1}B\epsilon_{t}=C(L)\epsilon_{t}
\end{equation}\]</span></p>
<p>Para encontrar la IRF definimos <span class="math inline">\(C_{i,j}(h)\)</span> la respuesta de la variable i ante un shock en la variable j en el horizonte h.</p>
<p>El error de pronóstico de una variable en el período t es el cambio en la variable que no pudo ser pronósticado entre el período t-1 y t. Ello se debe a la realización de los shocks estructurales en un sistema (<span class="math inline">\(\epsilon_{t}\)</span>). Es posible computar el error de pronóstico para muchos horizontes h. El error de pronóstico en h=0 para cada variable en nuestro sistema es:</p>
<p><span class="math display">\[\begin{align}
E_{t}\Delta y_{t}-E_{t-1}\Delta y_{t}&amp;=C_{1,1}(0)\epsilon_{\Delta y, t}+C_{1,2}(0)\epsilon_{i, t}\\
E_{t}i_{t}-E_{t-1}i_{t}&amp;=C_{2,1}(0)\epsilon_{\Delta y, t}+C_{2,2}(0)\epsilon_{i, t}
\end{align}\]</span></p>
<p>La varianza del error de pronóstico es su cuadrado. Si se define <span class="math inline">\(\Omega_{i}(h)\)</span> como la varianza del error de pronóstico de la variable i en el horizonte h. Entonces su calculo en h=0 es simple:</p>
<p><span class="math display">\[\begin{align}
\Omega_{\Delta y}(0)&amp;=C_{1,1}(0)^{2}+C_{1,2}(0)^{2}\\
\Omega_{i}(0)       &amp;=C_{2,1}(0)^{2}+C_{2,2}(0)^{2}
\end{align}\]</span></p>
<p>Lo anterior sigute el supuesto que el shock tiene varianza unitaria y no están correlacionadas. El error de pronósticos para estas variables en el horizonte h=1 es:</p>
<p><span class="math display">\[\begin{align}
E_{t}\Delta y_{t+1}-E_{t-1}\Delta y_{t+1}&amp;=C_{1,1}(0)\epsilon_{\Delta y, t+1}+C_{1,2}(0)\epsilon_{i, t+1}+C_{1,1}(1)\epsilon_{\Delta y, t}+C_{1,2}(1)\epsilon_{i, t}\\
E_{t}i_{t+1}-E_{t-1}i_{t+1}&amp;=C_{2,1}(0)\epsilon_{\Delta y, t+1}+C_{2,2}(0)\epsilon_{i, t+1}+C_{2,1}(1)\epsilon_{\Delta y, t}+C_{2,2}(1)\epsilon_{i, t}
\end{align}\]</span></p>
<p>Y la varianza del error de pronóstico sería:</p>
<p><span class="math display">\[\begin{align}
\Omega_{\Delta y}(1)&amp;=C_{1,1}(0)^{2}+C_{1,2}(0)^{2}+C_{1,1}(1)^{2}+C_{1,2}(1)^{2}\\
\Omega_{i}(1)       &amp;=C_{2,1}(0)^{2}+C_{2,2}(0)^{2}+C_{2,1}(1)^{2}+C_{2,2}(1)^{2}  
\end{align}\]</span></p>
<p>Es posible definir la varianza del error de pronóstico de manera <em>recursiva</em> para disponerse por más períodos:</p>
<p><span class="math display">\[\begin{align}
\Omega_{\Delta y}(0)&amp;=C_{1,1}(0)^{2}+C_{1,2}(0)^{2}\\
\Omega_{\Delta y}(1)&amp;=C_{1,1}(1)^{2}+C_{1,2}(1)^{2}+\Omega_{\Delta y}(0)\\
\vdots              &amp;    \vdots\\
\Omega_{\Delta y}(h)&amp;=C_{1,1}(h)^{2}+C_{1,2}(h)^{2}+\Omega_{\Delta y}(h-1)
\end{align}\]</span></p>
<p>De manera más general para un VAR de n variables, la varianza total del error de pronóstico de la variable i está dado por:</p>
<p><span class="math display">\[\begin{equation}
\Omega_{i}(h)=\sum_{k=0}^{h} \sum_{j=1}^{n}C_{i,j}(k)^{2}
\end{equation}\]</span></p>
<p><em>La descomposición de la varianza del error de pronóstico</em>, es la manera de cuantificar que tan importante es cada shock en explicar la varianción que experimenta cada una de las variables en un sistema VAR. Esto es igual a la fracción de la varianza del error de pronósitico de cada variable dado cada uno de los shock en cada uno de los horizontes. Específicamemte, si definimos <span class="math inline">\(\omega_{i,j}(h)\)</span> como la varianza en el error de pronóstico de la variable i ante un shock en la variable j en el horizonte h, se tiene:</p>
<p><span class="math display">\[\begin{equation}
\omega_{i, j}(h)=\sum_{k=0}^{h} C_{i,j}(k)^{2}
\end{equation}\]</span></p>
<p>La fracción de la varianza del error de pronóstico de la variable i dado por el shock en la variable j en el horizonte h denotado por <span class="math inline">\(\phi_{i,j}(h)\)</span> es lo de arriba dividido por la varianza total del error de pronóstico:</p>
<p><span class="math display">\[\begin{equation}
\phi_{i,j}(h)=\frac{\omega_{i, j}(h)}{\Omega_{i}(h)}=\frac{\sum_{k=0}^{h} C_{i,j}(k)^{2}}{\sum_{k=0}^{h} \sum_{j=1}^{n}C_{i,j}(k)^{2}}
\end{equation}\]</span></p>
</div>
<div id="aplicación-cochrane94" class="section level2 hasAnchor" number="2.3">
<h2><span class="header-section-number">2.3</span> Aplicación <span class="citation">Cochrane (<a href="#ref-COCHRANE94" role="doc-biblioref">1994</a>)</span><a href="#aplicación-cochrane94" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p><span class="citation">Cochrane (<a href="#ref-COCHRANE94" role="doc-biblioref">1994</a>)</span> estima un VAR de dos variables, el gasto real de consumo en bienes no durables más servicios (<span class="math inline">\(c_{t}\)</span>) y el PIB real (<span class="math inline">\(y_{t}\)</span>). Introduciendo 2 rezago el VAR se expesa como:</p>
<p><span class="math display">\[\begin{align}
c_{t}&amp;= a_{c}+\beta_{1,1}^{c}c_{t-1}+\beta_{1,2}^{c}y_{t-1}+\beta_{2,1}^{c}c_{t-2}+\beta_{2,2}^{c}y_{t-2}+e_{c,t}\\
y_{t}&amp;= a_{y}+\beta_{1,1}^{y}c_{t-1}+\beta_{1,2}^{y}y_{t-1}+\beta_{2,1}^{y}c_{t-2}+\beta_{2,2}^{y}y_{t-2}+e_{y,t}
\end{align}\]</span></p>
<p>Utilizando datos trimestrales desde 1947Q1 hasta 2010Q3. Obtenemos la siguiente estimación:</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(quantmod)</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(dplyr)</span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(stats)</span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(stargazer)</span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a><span class="fu">getSymbols</span>(<span class="fu">c</span>(<span class="st">&quot;PCENDC96&quot;</span>, <span class="st">&quot;PCESC96&quot;</span>, <span class="st">&quot;GDPC1&quot;</span>),</span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a>           <span class="at">src =</span> <span class="st">&quot;FRED&quot;</span>)</span></code></pre></div>
<pre><code>## [1] &quot;PCENDC96&quot; &quot;PCESC96&quot;  &quot;GDPC1&quot;</code></pre>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a>C<span class="ot">&lt;-</span>PCENDC96<span class="sc">+</span>PCESC96</span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a>ep_c       <span class="ot">&lt;-</span><span class="fu">endpoints</span>(C, <span class="at">on =</span> <span class="st">&quot;quarters&quot;</span>)</span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a>C          <span class="ot">&lt;-</span><span class="fu">period.apply</span>(C , <span class="at">INDEX =</span> ep_c, <span class="at">FUN =</span> last)</span>
<span id="cb3-4"><a href="#cb3-4" aria-hidden="true" tabindex="-1"></a>C          <span class="ot">&lt;-</span><span class="fu">diff</span>(<span class="fu">log</span>(C), <span class="at">lag=</span><span class="dv">4</span>)</span>
<span id="cb3-5"><a href="#cb3-5" aria-hidden="true" tabindex="-1"></a><span class="co">#C          &lt;-log(C)</span></span>
<span id="cb3-6"><a href="#cb3-6" aria-hidden="true" tabindex="-1"></a>GDPC1      <span class="ot">&lt;-</span><span class="fu">diff</span>(<span class="fu">log</span>(GDPC1), <span class="at">lag=</span><span class="dv">4</span>)</span>
<span id="cb3-7"><a href="#cb3-7" aria-hidden="true" tabindex="-1"></a><span class="co">#GDPC1      &lt;-log(GDPC1)</span></span>
<span id="cb3-8"><a href="#cb3-8" aria-hidden="true" tabindex="-1"></a>GDPC1      <span class="ot">&lt;-</span><span class="fu">merge</span>(GDPC1, <span class="fu">index</span>(C), <span class="at">join=</span><span class="st">&quot;outer&quot;</span>)</span>
<span id="cb3-9"><a href="#cb3-9" aria-hidden="true" tabindex="-1"></a>GDPC1      <span class="ot">&lt;-</span><span class="fu">cbind</span>(<span class="fu">na.locf</span>(GDPC1, <span class="at">fromLast =</span> <span class="cn">FALSE</span>))</span>
<span id="cb3-10"><a href="#cb3-10" aria-hidden="true" tabindex="-1"></a>BASE       <span class="ot">&lt;-</span><span class="fu">merge</span>(C, GDPC1, <span class="at">join=</span><span class="st">&quot;left&quot;</span>)</span>
<span id="cb3-11"><a href="#cb3-11" aria-hidden="true" tabindex="-1"></a>BASE       <span class="ot">&lt;-</span><span class="fu">data.frame</span>(<span class="at">date=</span><span class="fu">index</span>(BASE), <span class="fu">coredata</span>(BASE))</span>
<span id="cb3-12"><a href="#cb3-12" aria-hidden="true" tabindex="-1"></a><span class="fu">colnames</span>(BASE)<span class="ot">&lt;-</span><span class="fu">c</span>(<span class="st">&quot;date&quot;</span>,<span class="st">&quot;C&quot;</span>, <span class="st">&quot;Y&quot;</span>)</span>
<span id="cb3-13"><a href="#cb3-13" aria-hidden="true" tabindex="-1"></a>DATA    <span class="ot">&lt;-</span>dplyr<span class="sc">::</span><span class="fu">select</span>(BASE, date, C, Y)</span>
<span id="cb3-14"><a href="#cb3-14" aria-hidden="true" tabindex="-1"></a><span class="fu">colnames</span>(DATA)<span class="ot">&lt;-</span><span class="fu">c</span>(<span class="st">&quot;date&quot;</span>, <span class="st">&quot;c&quot;</span>, <span class="st">&quot;y&quot;</span>)</span>
<span id="cb3-15"><a href="#cb3-15" aria-hidden="true" tabindex="-1"></a>DATA    <span class="ot">&lt;-</span><span class="fu">filter</span>(DATA, date <span class="sc">&gt;=</span> <span class="st">&quot;2003-03-01&quot;</span>)</span>
<span id="cb3-16"><a href="#cb3-16" aria-hidden="true" tabindex="-1"></a>DATA       <span class="ot">&lt;-</span> <span class="fu">xts</span>(DATA[,<span class="sc">-</span><span class="dv">1</span>], <span class="at">order.by=</span><span class="fu">as.Date</span>(DATA[,<span class="dv">1</span>], <span class="st">&quot;%Y/%m/%d&quot;</span>))</span>
<span id="cb3-17"><a href="#cb3-17" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(<span class="st">&quot;svars&quot;</span>)</span>
<span id="cb3-18"><a href="#cb3-18" aria-hidden="true" tabindex="-1"></a>VAR_1      <span class="ot">&lt;-</span> vars<span class="sc">::</span><span class="fu">VAR</span>(DATA, <span class="at">p =</span> <span class="dv">1</span>, <span class="at">type =</span> <span class="st">&#39;const&#39;</span>)</span>
<span id="cb3-19"><a href="#cb3-19" aria-hidden="true" tabindex="-1"></a>VAR_1<span class="sc">$</span>varresult<span class="sc">$</span>y<span class="sc">$</span>coefficients</span></code></pre></div>
<pre><code>##         c.l1         y.l1        const 
##  0.977213975 -0.115000492  0.004246045</code></pre>
<div class="sourceCode" id="cb5"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a>VAR_1<span class="sc">$</span>varresult<span class="sc">$</span>c<span class="sc">$</span>coefficients</span></code></pre></div>
<pre><code>##         c.l1         y.l1        const 
##  0.837655010 -0.112571185  0.005099686</code></pre>
<div class="sourceCode" id="cb7"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a>SIGMA<span class="ot">&lt;-</span><span class="fu">summary</span>(VAR_1)</span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a>SIGMA<span class="sc">$</span>covres</span></code></pre></div>
<pre><code>##              c            y
## c 0.0002152250 0.0001641284
## y 0.0001641284 0.0002801706</code></pre>
<p>De acuerdo con la hipótesis del ingreso permanente, el consumo debe ser igual al ingreso permanente, en tanto el ingreso transitorio igual a la diferencia entre el ingreso actual y el permanente. Cochcrane desea identificar los shocks del ingreso permanente <span class="math inline">\(\epsilon_{1,t}\)</span> y del ingreso transitorio <span class="math inline">\(\epsilon_{2,t}\)</span>. La intuición nos dice que el consumo no debería de responder a los shocks de ingresos transitorios. Lo anterior implica que <span class="math inline">\(B_{1,2}=0\)</span>.</p>
<div class="sourceCode" id="cb9"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a>B <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="fu">rep</span>(<span class="cn">NA</span>, <span class="dv">4</span>), <span class="at">ncol =</span> <span class="dv">2</span>)</span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a>B[<span class="dv">1</span>, <span class="dv">2</span>] <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb9-3"><a href="#cb9-3" aria-hidden="true" tabindex="-1"></a>SVAR_1  <span class="ot">&lt;-</span> <span class="fu">SVAR</span>(VAR_1, <span class="at">estmethod=</span><span class="st">&quot;direct&quot;</span>, <span class="at">Bmat =</span> B)</span>
<span id="cb9-4"><a href="#cb9-4" aria-hidden="true" tabindex="-1"></a>SVAR_1<span class="sc">$</span>B </span></code></pre></div>
<pre><code>##            c          y
## c 0.01466988 0.00000000
## y 0.01118766 0.01245008</code></pre>
<p>Dado la estimación de la matriz B, es posible calcular la matriz C(L) y computar la función impulso respuesta de cada shock.</p>
<div class="sourceCode" id="cb11"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a>FIR_1 <span class="ot">&lt;-</span> <span class="fu">irf</span>(SVAR_1,<span class="at">n.ahead =</span> <span class="dv">20</span>, <span class="at">impulse =</span> <span class="fu">c</span>(<span class="st">&quot;c&quot;</span>,<span class="st">&quot;y&quot;</span>), <span class="at">boot =</span><span class="cn">FALSE</span>)</span>
<span id="cb11-2"><a href="#cb11-2" aria-hidden="true" tabindex="-1"></a>RESULTADO<span class="ot">&lt;-</span><span class="fu">as.data.frame</span>(FIR_1<span class="sc">$</span>irf<span class="sc">$</span>c)</span>
<span id="cb11-3"><a href="#cb11-3" aria-hidden="true" tabindex="-1"></a>PERIODO<span class="ot">&lt;-</span><span class="fu">seq</span>(<span class="dv">1</span>,<span class="dv">21</span>,<span class="dv">1</span>)</span>
<span id="cb11-4"><a href="#cb11-4" aria-hidden="true" tabindex="-1"></a>RESULTADO <span class="ot">&lt;-</span><span class="fu">cbind</span>(RESULTADO,PERIODO)</span>
<span id="cb11-5"><a href="#cb11-5" aria-hidden="true" tabindex="-1"></a>CODE<span class="ot">&lt;-</span><span class="fu">rep</span>(<span class="st">&quot;consumo&quot;</span>,<span class="dv">21</span>)</span>
<span id="cb11-6"><a href="#cb11-6" aria-hidden="true" tabindex="-1"></a>RESULTADO <span class="ot">&lt;-</span><span class="fu">cbind</span>(RESULTADO,CODE)</span>
<span id="cb11-7"><a href="#cb11-7" aria-hidden="true" tabindex="-1"></a><span class="do">#####################################</span></span>
<span id="cb11-8"><a href="#cb11-8" aria-hidden="true" tabindex="-1"></a>RESULTADO2<span class="ot">&lt;-</span><span class="fu">as.data.frame</span>(FIR_1<span class="sc">$</span>irf<span class="sc">$</span>y)</span>
<span id="cb11-9"><a href="#cb11-9" aria-hidden="true" tabindex="-1"></a>RESULTADO2 <span class="ot">&lt;-</span><span class="fu">cbind</span>(RESULTADO2,PERIODO)</span>
<span id="cb11-10"><a href="#cb11-10" aria-hidden="true" tabindex="-1"></a>CODE<span class="ot">&lt;-</span><span class="fu">rep</span>(<span class="st">&quot;producto&quot;</span>,<span class="dv">21</span>)</span>
<span id="cb11-11"><a href="#cb11-11" aria-hidden="true" tabindex="-1"></a>RESULTADO2 <span class="ot">&lt;-</span><span class="fu">cbind</span>(RESULTADO2,CODE)</span>
<span id="cb11-12"><a href="#cb11-12" aria-hidden="true" tabindex="-1"></a>RESULTADO <span class="ot">&lt;-</span><span class="fu">rbind</span>(RESULTADO,RESULTADO2)</span>
<span id="cb11-13"><a href="#cb11-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-14"><a href="#cb11-14" aria-hidden="true" tabindex="-1"></a><span class="do">####HACER MI PROPIO GRÁFICO###################</span></span>
<span id="cb11-15"><a href="#cb11-15" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyr)</span>
<span id="cb11-16"><a href="#cb11-16" aria-hidden="true" tabindex="-1"></a>BASE_LONG <span class="ot">&lt;-</span> <span class="fu">gather</span>(RESULTADO, <span class="at">key=</span><span class="st">&quot;measure&quot;</span>, <span class="at">value=</span><span class="st">&quot;value&quot;</span>,</span>
<span id="cb11-17"><a href="#cb11-17" aria-hidden="true" tabindex="-1"></a>                    <span class="fu">c</span>(<span class="st">&quot;c&quot;</span>, <span class="st">&quot;y&quot;</span>))</span>
<span id="cb11-18"><a href="#cb11-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-19"><a href="#cb11-19" aria-hidden="true" tabindex="-1"></a>BASE_LONG<span class="sc">$</span>measure <span class="ot">&lt;-</span> <span class="fu">factor</span>(BASE_LONG<span class="sc">$</span>measure,</span>
<span id="cb11-20"><a href="#cb11-20" aria-hidden="true" tabindex="-1"></a>                            <span class="at">levels =</span> <span class="fu">c</span>(<span class="st">&quot;c&quot;</span>,<span class="st">&quot;y&quot;</span>))</span>
<span id="cb11-21"><a href="#cb11-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-22"><a href="#cb11-22" aria-hidden="true" tabindex="-1"></a>variable_names <span class="ot">&lt;-</span> <span class="fu">list</span>(</span>
<span id="cb11-23"><a href="#cb11-23" aria-hidden="true" tabindex="-1"></a>  <span class="st">&quot;c&quot;</span> <span class="ot">=</span> <span class="st">&quot;Respuesta del consumo&quot;</span>,</span>
<span id="cb11-24"><a href="#cb11-24" aria-hidden="true" tabindex="-1"></a>  <span class="st">&quot;y&quot;</span> <span class="ot">=</span> <span class="st">&quot;Respuesta del producto&quot;</span></span>
<span id="cb11-25"><a href="#cb11-25" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb11-26"><a href="#cb11-26" aria-hidden="true" tabindex="-1"></a>variable_labeller2 <span class="ot">&lt;-</span> <span class="cf">function</span>(variable,value){</span>
<span id="cb11-27"><a href="#cb11-27" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (variable<span class="sc">==</span><span class="st">&#39;measure&#39;</span>) {</span>
<span id="cb11-28"><a href="#cb11-28" aria-hidden="true" tabindex="-1"></a>    <span class="fu">return</span>(variable_names[value])</span>
<span id="cb11-29"><a href="#cb11-29" aria-hidden="true" tabindex="-1"></a>  } <span class="cf">else</span> {</span>
<span id="cb11-30"><a href="#cb11-30" aria-hidden="true" tabindex="-1"></a>    <span class="fu">return</span>(region_names)</span>
<span id="cb11-31"><a href="#cb11-31" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb11-32"><a href="#cb11-32" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb11-33"><a href="#cb11-33" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-34"><a href="#cb11-34" aria-hidden="true" tabindex="-1"></a>paleta<span class="ot">&lt;-</span><span class="fu">c</span>(<span class="st">&quot;blue&quot;</span>, <span class="st">&quot;red&quot;</span>)</span>
<span id="cb11-35"><a href="#cb11-35" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb11-36"><a href="#cb11-36" aria-hidden="true" tabindex="-1"></a>Z<span class="ot">&lt;-</span><span class="fu">ggplot</span>(BASE_LONG, <span class="fu">aes</span>(<span class="at">x=</span>PERIODO, <span class="at">y=</span>value, <span class="at">group =</span> CODE,</span>
<span id="cb11-37"><a href="#cb11-37" aria-hidden="true" tabindex="-1"></a>                         <span class="at">colour=</span>CODE))<span class="sc">+</span></span>
<span id="cb11-38"><a href="#cb11-38" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(.<span class="sc">~</span>measure, <span class="at">scales=</span><span class="st">&quot;free&quot;</span>, <span class="at">labeller=</span> variable_labeller2)</span>
<span id="cb11-39"><a href="#cb11-39" aria-hidden="true" tabindex="-1"></a>Z<span class="ot">&lt;-</span>Z<span class="sc">+</span><span class="fu">labs</span>(<span class="at">y=</span><span class="st">&quot;Respuesta&quot;</span>,</span>
<span id="cb11-40"><a href="#cb11-40" aria-hidden="true" tabindex="-1"></a>          <span class="at">x=</span><span class="st">&quot;Períodos&quot;</span>)<span class="sc">+</span></span>
<span id="cb11-41"><a href="#cb11-41" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_hline</span>(<span class="at">yintercept=</span><span class="dv">0</span>, <span class="at">linetype=</span><span class="st">&quot;dashed&quot;</span>,</span>
<span id="cb11-42"><a href="#cb11-42" aria-hidden="true" tabindex="-1"></a>             <span class="at">color =</span> <span class="st">&quot;black&quot;</span>, <span class="at">size=</span><span class="dv">1</span>)<span class="sc">+</span></span>
<span id="cb11-43"><a href="#cb11-43" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="at">size=</span><span class="fl">1.5</span>)<span class="sc">+</span></span>
<span id="cb11-44"><a href="#cb11-44" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(<span class="at">values=</span>paleta,</span>
<span id="cb11-45"><a href="#cb11-45" aria-hidden="true" tabindex="-1"></a>                     <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">&quot;Shock permanente&quot;</span>, </span>
<span id="cb11-46"><a href="#cb11-46" aria-hidden="true" tabindex="-1"></a>                                <span class="st">&quot;Shock transitorio&quot;</span>))</span>
<span id="cb11-47"><a href="#cb11-47" aria-hidden="true" tabindex="-1"></a>Z<span class="ot">&lt;-</span>Z<span class="sc">+</span><span class="fu">theme</span>(<span class="at">axis.line.x =</span> <span class="fu">element_line</span>(<span class="at">colour =</span> <span class="st">&quot;black&quot;</span>, <span class="at">size =</span> <span class="fl">0.5</span>),</span>
<span id="cb11-48"><a href="#cb11-48" aria-hidden="true" tabindex="-1"></a>           <span class="at">axis.line.y.left  =</span> <span class="fu">element_line</span>(<span class="at">colour =</span> <span class="st">&quot;black&quot;</span>, <span class="at">size =</span> <span class="fl">0.5</span>),</span>
<span id="cb11-49"><a href="#cb11-49" aria-hidden="true" tabindex="-1"></a>           <span class="at">axis.line.y.right =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb11-50"><a href="#cb11-50" aria-hidden="true" tabindex="-1"></a>           <span class="at">axis.text.x =</span> <span class="fu">element_text</span>( <span class="at">color =</span> <span class="st">&quot;black&quot;</span>, <span class="at">size =</span> <span class="dv">14</span>),</span>
<span id="cb11-51"><a href="#cb11-51" aria-hidden="true" tabindex="-1"></a>           <span class="at">axis.text.y =</span> <span class="fu">element_text</span>( <span class="at">color =</span> <span class="st">&quot;black&quot;</span>, <span class="at">size =</span> <span class="dv">12</span>),</span>
<span id="cb11-52"><a href="#cb11-52" aria-hidden="true" tabindex="-1"></a>           <span class="at">panel.grid.minor =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb11-53"><a href="#cb11-53" aria-hidden="true" tabindex="-1"></a>           <span class="at">panel.grid.major.y =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb11-54"><a href="#cb11-54" aria-hidden="true" tabindex="-1"></a>           <span class="at">panel.grid.major.x =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb11-55"><a href="#cb11-55" aria-hidden="true" tabindex="-1"></a>           <span class="at">panel.border =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb11-56"><a href="#cb11-56" aria-hidden="true" tabindex="-1"></a>           <span class="at">panel.background =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb11-57"><a href="#cb11-57" aria-hidden="true" tabindex="-1"></a>           <span class="at">legend.key=</span><span class="fu">element_rect</span>(<span class="at">fill =</span> <span class="st">&quot;white&quot;</span>, <span class="at">colour =</span> <span class="st">&quot;white&quot;</span>,</span>
<span id="cb11-58"><a href="#cb11-58" aria-hidden="true" tabindex="-1"></a>                                   <span class="at">color =</span> <span class="st">&quot;white&quot;</span>, <span class="at">inherit.blank =</span> <span class="cn">FALSE</span>),</span>
<span id="cb11-59"><a href="#cb11-59" aria-hidden="true" tabindex="-1"></a>           <span class="at">legend.title =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb11-60"><a href="#cb11-60" aria-hidden="true" tabindex="-1"></a>           <span class="at">legend.text  =</span> <span class="fu">element_text</span>(<span class="at">size=</span><span class="dv">10</span>),</span>
<span id="cb11-61"><a href="#cb11-61" aria-hidden="true" tabindex="-1"></a>           <span class="at">legend.position=</span><span class="st">&quot;bottom&quot;</span>,</span>
<span id="cb11-62"><a href="#cb11-62" aria-hidden="true" tabindex="-1"></a>           <span class="at">legend.spacing.x =</span> <span class="fu">unit</span>(<span class="fl">0.10</span>, <span class="st">&#39;cm&#39;</span>),</span>
<span id="cb11-63"><a href="#cb11-63" aria-hidden="true" tabindex="-1"></a>           <span class="at">legend.margin=</span><span class="fu">margin</span>(),</span>
<span id="cb11-64"><a href="#cb11-64" aria-hidden="true" tabindex="-1"></a>           <span class="at">legend.background =</span> <span class="fu">element_rect</span>(<span class="at">fill =</span> <span class="st">&quot;white&quot;</span>, <span class="at">colour =</span> <span class="st">&quot;transparent&quot;</span>,</span>
<span id="cb11-65"><a href="#cb11-65" aria-hidden="true" tabindex="-1"></a>                                            <span class="at">color =</span> <span class="st">&quot;white&quot;</span>, <span class="at">inherit.blank =</span> <span class="cn">FALSE</span>)</span>
<span id="cb11-66"><a href="#cb11-66" aria-hidden="true" tabindex="-1"></a>)<span class="sc">+</span><span class="fu">guides</span>(<span class="at">color =</span> <span class="fu">guide_legend</span>(<span class="at">nrow =</span> <span class="dv">1</span>))</span>
<span id="cb11-67"><a href="#cb11-67" aria-hidden="true" tabindex="-1"></a>Z</span></code></pre></div>
<p><img src="01-conceptos_files/figure-html/unnamed-chunk-3-1.png" width="672" /></p>
<p>El impulso respuesta mostrado en la figura anterior es consistente con la teoría, pues se observa como el consumo se mueve poco ante un shock transitorio. La descomposición de la varianza por su parte revela:</p>
<div class="sourceCode" id="cb12"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a>RESULTADO<span class="ot">&lt;-</span><span class="fu">as.data.frame</span>(<span class="fu">fevd</span>(VAR_1, <span class="at">n.ahead =</span> <span class="dv">20</span>)<span class="sc">$</span>c)</span>
<span id="cb12-2"><a href="#cb12-2" aria-hidden="true" tabindex="-1"></a>PERIODO<span class="ot">&lt;-</span><span class="fu">seq</span>(<span class="dv">1</span>,<span class="dv">20</span>,<span class="dv">1</span>)</span>
<span id="cb12-3"><a href="#cb12-3" aria-hidden="true" tabindex="-1"></a>RESULTADO <span class="ot">&lt;-</span><span class="fu">cbind</span>(RESULTADO,PERIODO)</span>
<span id="cb12-4"><a href="#cb12-4" aria-hidden="true" tabindex="-1"></a>CODE<span class="ot">&lt;-</span><span class="fu">rep</span>(<span class="st">&quot;permanente&quot;</span>,<span class="dv">20</span>)</span>
<span id="cb12-5"><a href="#cb12-5" aria-hidden="true" tabindex="-1"></a>RESULTADO <span class="ot">&lt;-</span><span class="fu">cbind</span>(RESULTADO,CODE)</span>
<span id="cb12-6"><a href="#cb12-6" aria-hidden="true" tabindex="-1"></a><span class="do">#####################################</span></span>
<span id="cb12-7"><a href="#cb12-7" aria-hidden="true" tabindex="-1"></a>RESULTADO2<span class="ot">&lt;-</span><span class="fu">as.data.frame</span>(<span class="fu">fevd</span>(VAR_1, <span class="at">n.ahead =</span> <span class="dv">20</span>)<span class="sc">$</span>y)</span>
<span id="cb12-8"><a href="#cb12-8" aria-hidden="true" tabindex="-1"></a>RESULTADO2 <span class="ot">&lt;-</span><span class="fu">cbind</span>(RESULTADO2,PERIODO)</span>
<span id="cb12-9"><a href="#cb12-9" aria-hidden="true" tabindex="-1"></a>CODE<span class="ot">&lt;-</span><span class="fu">rep</span>(<span class="st">&quot;transitorio&quot;</span>,<span class="dv">20</span>)</span>
<span id="cb12-10"><a href="#cb12-10" aria-hidden="true" tabindex="-1"></a>RESULTADO2 <span class="ot">&lt;-</span><span class="fu">cbind</span>(RESULTADO2,CODE)</span>
<span id="cb12-11"><a href="#cb12-11" aria-hidden="true" tabindex="-1"></a>RESULTADO <span class="ot">&lt;-</span><span class="fu">rbind</span>(RESULTADO,RESULTADO2)</span>
<span id="cb12-12"><a href="#cb12-12" aria-hidden="true" tabindex="-1"></a>BASE_LONG <span class="ot">&lt;-</span> <span class="fu">gather</span>(RESULTADO, <span class="at">key=</span><span class="st">&quot;measure&quot;</span>, <span class="at">value=</span><span class="st">&quot;value&quot;</span>,</span>
<span id="cb12-13"><a href="#cb12-13" aria-hidden="true" tabindex="-1"></a>                    <span class="fu">c</span>(<span class="st">&quot;c&quot;</span>,<span class="st">&quot;y&quot;</span>))</span>
<span id="cb12-14"><a href="#cb12-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-15"><a href="#cb12-15" aria-hidden="true" tabindex="-1"></a>BASE_LONG<span class="sc">$</span>CODE <span class="ot">&lt;-</span> <span class="fu">factor</span>(BASE_LONG<span class="sc">$</span>CODE,</span>
<span id="cb12-16"><a href="#cb12-16" aria-hidden="true" tabindex="-1"></a>                            <span class="at">levels =</span> <span class="fu">c</span>(<span class="st">&quot;permanente&quot;</span>,<span class="st">&quot;transitorio&quot;</span>))</span>
<span id="cb12-17"><a href="#cb12-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-18"><a href="#cb12-18" aria-hidden="true" tabindex="-1"></a>variable_names <span class="ot">&lt;-</span> <span class="fu">list</span>(</span>
<span id="cb12-19"><a href="#cb12-19" aria-hidden="true" tabindex="-1"></a>  <span class="st">&quot;permanente&quot;</span> <span class="ot">=</span>  <span class="st">&quot;Varianza del consumo&quot;</span>,</span>
<span id="cb12-20"><a href="#cb12-20" aria-hidden="true" tabindex="-1"></a>  <span class="st">&quot;transitorio&quot;</span> <span class="ot">=</span> <span class="st">&quot;Varianza del producto&quot;</span></span>
<span id="cb12-21"><a href="#cb12-21" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb12-22"><a href="#cb12-22" aria-hidden="true" tabindex="-1"></a>variable_labeller2 <span class="ot">&lt;-</span> <span class="cf">function</span>(variable,value){</span>
<span id="cb12-23"><a href="#cb12-23" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (variable<span class="sc">==</span><span class="st">&#39;CODE&#39;</span>) {</span>
<span id="cb12-24"><a href="#cb12-24" aria-hidden="true" tabindex="-1"></a>    <span class="fu">return</span>(variable_names[value])</span>
<span id="cb12-25"><a href="#cb12-25" aria-hidden="true" tabindex="-1"></a>  } <span class="cf">else</span> {</span>
<span id="cb12-26"><a href="#cb12-26" aria-hidden="true" tabindex="-1"></a>    <span class="fu">return</span>(region_names)</span>
<span id="cb12-27"><a href="#cb12-27" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb12-28"><a href="#cb12-28" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb12-29"><a href="#cb12-29" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-30"><a href="#cb12-30" aria-hidden="true" tabindex="-1"></a>paleta<span class="ot">&lt;-</span><span class="fu">c</span>(<span class="st">&quot;blue&quot;</span>, <span class="st">&quot;red&quot;</span>)</span>
<span id="cb12-31"><a href="#cb12-31" aria-hidden="true" tabindex="-1"></a>Z<span class="ot">&lt;-</span><span class="fu">ggplot</span>(BASE_LONG, <span class="fu">aes</span>(<span class="at">x=</span>PERIODO, <span class="at">y=</span>value, <span class="at">group =</span> measure,</span>
<span id="cb12-32"><a href="#cb12-32" aria-hidden="true" tabindex="-1"></a>                         <span class="at">fill=</span>measure))<span class="sc">+</span></span>
<span id="cb12-33"><a href="#cb12-33" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(.<span class="sc">~</span>CODE, <span class="at">scales=</span><span class="st">&quot;free&quot;</span>, <span class="at">labeller=</span> variable_labeller2)</span>
<span id="cb12-34"><a href="#cb12-34" aria-hidden="true" tabindex="-1"></a>Z<span class="ot">&lt;-</span>Z<span class="sc">+</span><span class="fu">labs</span>(<span class="at">y=</span><span class="st">&quot;Porcentaje&quot;</span>,</span>
<span id="cb12-35"><a href="#cb12-35" aria-hidden="true" tabindex="-1"></a>          <span class="at">x=</span><span class="st">&quot;Períodos&quot;</span>)<span class="sc">+</span></span>
<span id="cb12-36"><a href="#cb12-36" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_bar</span>(<span class="at">stat=</span><span class="st">&#39;identity&#39;</span>)<span class="sc">+</span></span>
<span id="cb12-37"><a href="#cb12-37" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_manual</span>(<span class="at">values=</span>paleta,</span>
<span id="cb12-38"><a href="#cb12-38" aria-hidden="true" tabindex="-1"></a>                     <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">&quot;Shock permanente&quot;</span>, </span>
<span id="cb12-39"><a href="#cb12-39" aria-hidden="true" tabindex="-1"></a>                                <span class="st">&quot;Shock transitorio&quot;</span>))</span>
<span id="cb12-40"><a href="#cb12-40" aria-hidden="true" tabindex="-1"></a>Z<span class="ot">&lt;-</span>Z<span class="sc">+</span><span class="fu">theme</span>(<span class="at">axis.line.x =</span> <span class="fu">element_line</span>(<span class="at">colour =</span> <span class="st">&quot;black&quot;</span>, <span class="at">size =</span> <span class="fl">0.5</span>),</span>
<span id="cb12-41"><a href="#cb12-41" aria-hidden="true" tabindex="-1"></a>           <span class="at">axis.line.y.left  =</span> <span class="fu">element_line</span>(<span class="at">colour =</span> <span class="st">&quot;black&quot;</span>, <span class="at">size =</span> <span class="fl">0.5</span>),</span>
<span id="cb12-42"><a href="#cb12-42" aria-hidden="true" tabindex="-1"></a>           <span class="at">axis.line.y.right =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb12-43"><a href="#cb12-43" aria-hidden="true" tabindex="-1"></a>           <span class="at">axis.text.x =</span> <span class="fu">element_text</span>( <span class="at">color =</span> <span class="st">&quot;black&quot;</span>, <span class="at">size =</span> <span class="dv">14</span>),</span>
<span id="cb12-44"><a href="#cb12-44" aria-hidden="true" tabindex="-1"></a>           <span class="at">axis.text.y =</span> <span class="fu">element_text</span>( <span class="at">color =</span> <span class="st">&quot;black&quot;</span>, <span class="at">size =</span> <span class="dv">12</span>),</span>
<span id="cb12-45"><a href="#cb12-45" aria-hidden="true" tabindex="-1"></a>           <span class="at">panel.grid.minor =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb12-46"><a href="#cb12-46" aria-hidden="true" tabindex="-1"></a>           <span class="at">panel.grid.major.y =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb12-47"><a href="#cb12-47" aria-hidden="true" tabindex="-1"></a>           <span class="at">panel.grid.major.x =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb12-48"><a href="#cb12-48" aria-hidden="true" tabindex="-1"></a>           <span class="at">panel.border =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb12-49"><a href="#cb12-49" aria-hidden="true" tabindex="-1"></a>           <span class="at">panel.background =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb12-50"><a href="#cb12-50" aria-hidden="true" tabindex="-1"></a>           <span class="at">legend.key=</span><span class="fu">element_rect</span>(<span class="at">fill =</span> <span class="st">&quot;white&quot;</span>, <span class="at">colour =</span> <span class="st">&quot;white&quot;</span>,</span>
<span id="cb12-51"><a href="#cb12-51" aria-hidden="true" tabindex="-1"></a>                                   <span class="at">color =</span> <span class="st">&quot;white&quot;</span>, <span class="at">inherit.blank =</span> <span class="cn">FALSE</span>),</span>
<span id="cb12-52"><a href="#cb12-52" aria-hidden="true" tabindex="-1"></a>           <span class="at">legend.title =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb12-53"><a href="#cb12-53" aria-hidden="true" tabindex="-1"></a>           <span class="at">legend.text  =</span> <span class="fu">element_text</span>(<span class="at">size=</span><span class="dv">10</span>),</span>
<span id="cb12-54"><a href="#cb12-54" aria-hidden="true" tabindex="-1"></a>           <span class="at">legend.position=</span><span class="st">&quot;bottom&quot;</span>,</span>
<span id="cb12-55"><a href="#cb12-55" aria-hidden="true" tabindex="-1"></a>           <span class="at">legend.spacing.x =</span> <span class="fu">unit</span>(<span class="fl">0.10</span>, <span class="st">&#39;cm&#39;</span>),</span>
<span id="cb12-56"><a href="#cb12-56" aria-hidden="true" tabindex="-1"></a>           <span class="at">legend.margin=</span><span class="fu">margin</span>(),</span>
<span id="cb12-57"><a href="#cb12-57" aria-hidden="true" tabindex="-1"></a>           <span class="at">legend.background =</span> <span class="fu">element_rect</span>(<span class="at">fill =</span> <span class="st">&quot;white&quot;</span>, <span class="at">colour =</span> <span class="st">&quot;transparent&quot;</span>,</span>
<span id="cb12-58"><a href="#cb12-58" aria-hidden="true" tabindex="-1"></a>                                            <span class="at">color =</span> <span class="st">&quot;white&quot;</span>, <span class="at">inherit.blank =</span> <span class="cn">FALSE</span>)</span>
<span id="cb12-59"><a href="#cb12-59" aria-hidden="true" tabindex="-1"></a>)<span class="sc">+</span><span class="fu">guides</span>(<span class="at">color =</span> <span class="fu">guide_legend</span>(<span class="at">nrow =</span> <span class="dv">1</span>))</span>
<span id="cb12-60"><a href="#cb12-60" aria-hidden="true" tabindex="-1"></a>Z</span></code></pre></div>
<p><img src="01-conceptos_files/figure-html/unnamed-chunk-4-1.png" width="672" /></p>
<p>El gráfico anterior también confirma la teoría básica. El consumo es completamente explicado por los shocks permanentes. Una significativa fracción de los movimientos en el producto en el corto plazo obedecen a shocks transitorios, en horizontes largo los shocks permanentes se hacen más relevantes.</p>
</div>
<div id="ortogonalización-de-sims" class="section level2 hasAnchor" number="2.4">
<h2><span class="header-section-number">2.4</span> Ortogonalización de Sims<a href="#ortogonalización-de-sims" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Es de notar que los datos, por sí solos, no nos pueden ayudar ya que tanto el proceso <span class="math inline">\(x_{t}=C(L)\epsilon_{t}\)</span> como el proceso <span class="math inline">\(x_{t}=A(L)^{-1}e_{t}\)</span> son equivalentes y producen las mismas series.</p>
<p>Así que somos nosotros quienes decidimos cual combinación lineal es más interesante, en base a un conjunto de supuestos llamados <em>supuestos de ortogonalización</em>.</p>
<p>Recordemos que existe una vinculación líneal entre el shock estructural <span class="math inline">\((\epsilon_{t}=[\epsilon_{x,t}\;\;\;\epsilon_{z,t}])\)</span> con las innovaciones de la forma reducida <span class="math inline">\((e_{t}=[e_{x,t}\;\;\;e_{z,t}])\)</span>:</p>
<p><span class="math display">\[\begin{equation}
e_{t}=B\epsilon_{t}
\end{equation}\]</span></p>
<p>Sí <span class="math inline">\(\Sigma_e=E(e e^{\tau})\)</span> es la matriz de varianza y covarianza de la forma reducida, y <span class="math inline">\(\Sigma_\epsilon=E(\epsilon \epsilon^{\tau})=I\)</span> es la matriz identidad se tiene:</p>
<p><span class="math display">\[\begin{align}
\Sigma_e&amp;=BB^{\tau}\\
B^{-1}\Sigma_eB^{-1\tau}&amp;=I\\
Q\Sigma_eQ^{\tau}&amp;=I
\end{align}\]</span></p>
<p>Una forma de construir la matriz Q es a través de la descomposición de Cholesky</p>
<p>Desafortunadamente existen muchas matrices Q que pueden hacer cumplir la identidad <span class="math inline">\(Q\Sigma_eQ^{\tau}=I\)</span>, entonces la pregunta es: ¿cuál de esas matrices Q hay que escoger?: La respuesta dependerá de las propiedades que impongamos del proceso MA ó C(L), en concreto se utilizará la teoría económica para especificar C(0) y C(1).</p>
<p><span class="citation">Sims (<a href="#ref-Sims802" role="doc-biblioref">1980b</a>)</span> sugiere que se específique las propiedades de C(0), enfatizando el hecho de que <span class="math inline">\(A(0)=I\)</span>. En especifico sugiere escoger una matriz triangular inferior C(0) tal que:</p>
<p><span class="math display">\[\begin{equation}
    \left( \begin{array}{c}
    \pi_{t} \\
      m_{t}
    \end{array}\right)=\left( \begin{array}{cc}
    C_{0\pi \pi} &amp; 0\\
    C_{0m  \pi} &amp; C_{0mm}
    \end{array}
    \right) \left( \begin{array}{c}
    \epsilon_{1t}\\
    \epsilon_{2t}
    \end{array}
    \right) +C_{1}\epsilon_{t-1}+\cdots
\end{equation}\]</span></p>
<p>La matriz triangular inferior C(0) implica que <span class="math inline">\(\pi_{t}\)</span> aparece en la ecuación de <span class="math inline">\(m_{t}\)</span>, pero <span class="math inline">\(m_{t}\)</span> no en la ecuación de <span class="math inline">\(\pi_{t}\)</span>. Para observar lo anterior podemos representar el sistema dado por la ecuación anterior como un proceso autorregresivo y ortogonalizado: <span class="math inline">\(D(L)x_{t}=\epsilon_{t}\)</span>, donde <span class="math inline">\(D(L)=C(L)^{-1}\)</span>; recordando que la inversa de una matriz triangular inferior es también una matriz triangular inferior, tenemos:</p>
<p><span class="math display">\[\begin{equation}
      \left( \begin{array}{cc}
      D_{0\pi m} &amp; 0\\
      D_{0m \pi} &amp; D_{0mm}
      \end{array}
      \right)
      \left( \begin{array}{c}
      \pi_{t} \\
       m_{t}
      \end{array}\right)+D_{1}x_{t-1}+\cdots=\epsilon_{t}\nonumber
\end{equation}\]</span></p>
<p>Es de notar que la sugerencia de Sims es equivalente a estimar un sistema <span class="math inline">\((\pi_{t}, m_{t})\)</span> por OLS, en que la ecuación de <span class="math inline">\(m_{t}\)</span> tenga como regresor <span class="math inline">\(\pi_{t}\)</span>, pero no viceversa y escalando cada ecuación para que la varianza del error sea 1.</p>
<p><span class="math display">\[\begin{align}
\pi_{t}&amp;=\;\;\;\;\;\;\;\;\;\;\;\;\;\;\alpha_{1\pi \pi}\pi_{t-1}+\cdots+\alpha_{1\pi m}m_{t-1}+\cdots+\epsilon_{1t}\nonumber \\
m_{t}&amp;=\alpha_{0m \pi}\pi_{t}+\alpha_{1m \pi}\pi_{t-1}+\cdots+\alpha_{1mm}m_{t-1}+\cdots +\epsilon_{2t}\nonumber
\end{align}\]</span></p>
<p>En resumen se puede unicamente especificar la matriz B como una combinación lineal de los shocks originales <span class="math inline">\((\epsilon_{t})\)</span> y elaborar los impulsos respuesta de acuerdo a:</p>
<ol style="list-style-type: decimal">
<li>El error <span class="math inline">\((\epsilon_{t})\)</span> son ortogonales.</li>
<li>Que la respuesta instantánea de una variable a un shock es cero, siendo este al caso de estimar un VAR por OLS con efecto contemporaneo de <span class="math inline">\(\pi\)</span> sobre m y no viceversa.</li>
</ol>
<p>Es de notar que si se específica C(0) se garantiza que al aplicar la descomposición de Choleski se produce una única matriz triangular inferior B:
<span class="math display">\[\begin{align}
C(0)&amp;=A(0)^{-1}B=IB=B \nonumber\\
\end{align}\]</span></p>
<p>Entonces lo importante es decidir el orden de prelación <em>De lo exógeno a lo endógeno</em> de las variables en el VAR; auxiliándose de la teoría económica.</p>
</div>
<div id="blanchard-quah-ortogonalización-restricciones-sobre-c1" class="section level2 hasAnchor" number="2.5">
<h2><span class="header-section-number">2.5</span> Blanchard-Quah ortogonalización (restricciones) sobre C(1)<a href="#blanchard-quah-ortogonalización-restricciones-sobre-c1" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p><span class="citation">Blanchard and Quah (<a href="#ref-BLANCHARD88" role="doc-biblioref">1988</a>)</span> definen un modelo partiendo del mismo supuesto en que <span class="math inline">\(e_{t}=B\epsilon_{t}\)</span> por lo que se tiene:</p>
<p><span class="math display">\[\begin{align}
A(L)(1-\phi)x_{t}&amp;=e_{t}\\
A(L)(1-\phi)x_{t}&amp;=B\epsilon_{t}\\
A(L)x_{t}&amp;=(1-\phi)^{-1}B\epsilon_{t}\\
\end{align}\]</span></p>
<p>Donde <span class="math inline">\(C(1)=(1-\phi)^{-1}B=A(1)B\)</span> por los que se tiene:</p>
<p><span class="math display">\[\begin{align}
(1-\phi)\Sigma_{e}(1-\phi)&amp;=BB^{\tau}\\
Q(1-\phi)\Sigma_e(1-\phi)Q^{\tau}&amp;=I\\
\end{align}\]</span></p>
<p>De manera que C(1) permite obtener la respuesta del nivel <span class="math inline">\(x_{t}\)</span> ante un shock.</p>
</div>
<div id="aplicación-blanchard88" class="section level2 hasAnchor" number="2.6">
<h2><span class="header-section-number">2.6</span> Aplicación <span class="citation">Blanchard and Quah (<a href="#ref-BLANCHARD88" role="doc-biblioref">1988</a>)</span><a href="#aplicación-blanchard88" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p><span class="citation">Blanchard and Quah (<a href="#ref-BLANCHARD88" role="doc-biblioref">1988</a>)</span> argumentan que los shocks de demanda no tienen efectos en el largo plazo sobre el producto nominal. Para ello se requiere que C(1) sea una matriz triangular inferior en un VAR donde el producto nominal sea la variable exógena.</p>
<div class="sourceCode" id="cb13"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a><span class="fu">getSymbols</span>(<span class="fu">c</span>(<span class="st">&quot;GDPC1&quot;</span>, <span class="st">&quot;UNRATE&quot;</span>, <span class="st">&quot;USRECD&quot;</span>),</span>
<span id="cb13-2"><a href="#cb13-2" aria-hidden="true" tabindex="-1"></a>           <span class="at">src =</span> <span class="st">&quot;FRED&quot;</span>)</span></code></pre></div>
<pre><code>## [1] &quot;GDPC1&quot;  &quot;UNRATE&quot; &quot;USRECD&quot;</code></pre>
<div class="sourceCode" id="cb15"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a>TRUModel   <span class="ot">&lt;-</span> <span class="fu">lm</span>(UNRATE[<span class="st">&quot;1948-01-01/1987-12-01&quot;</span>] <span class="sc">~</span> <span class="fu">c</span>(<span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(UNRATE[<span class="st">&quot;1948-01-01/1987-12-01&quot;</span>])))</span>
<span id="cb15-2"><a href="#cb15-2" aria-hidden="true" tabindex="-1"></a>RATE       <span class="ot">&lt;-</span><span class="fu">resid</span>(TRUModel) </span>
<span id="cb15-3"><a href="#cb15-3" aria-hidden="true" tabindex="-1"></a>U_T        <span class="ot">&lt;-</span><span class="fu">as.xts</span>(<span class="fu">fitted</span>(TRUModel))</span>
<span id="cb15-4"><a href="#cb15-4" aria-hidden="true" tabindex="-1"></a>ep_U       <span class="ot">&lt;-</span><span class="fu">endpoints</span>(RATE, <span class="at">on =</span> <span class="st">&quot;quarters&quot;</span>)</span>
<span id="cb15-5"><a href="#cb15-5" aria-hidden="true" tabindex="-1"></a>U          <span class="ot">&lt;-</span><span class="fu">period.apply</span>(RATE, <span class="at">INDEX =</span> ep_U, <span class="at">FUN =</span> mean)</span>
<span id="cb15-6"><a href="#cb15-6" aria-hidden="true" tabindex="-1"></a>Y          <span class="ot">&lt;-</span><span class="fu">diff</span>(<span class="dv">100</span><span class="sc">*</span><span class="fu">log</span>(GDPC1), <span class="at">lag=</span><span class="dv">1</span>)</span>
<span id="cb15-7"><a href="#cb15-7" aria-hidden="true" tabindex="-1"></a>Y          <span class="ot">&lt;-</span>Y[<span class="st">&quot;1947-04-01/1987-10-01&quot;</span>]</span>
<span id="cb15-8"><a href="#cb15-8" aria-hidden="true" tabindex="-1"></a>dates1     <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="fu">as.Date</span>(<span class="st">&quot;1947-04-01&quot;</span>), <span class="at">length=</span><span class="dv">107</span>,<span class="at">by=</span><span class="st">&quot;quarters&quot;</span>)</span>
<span id="cb15-9"><a href="#cb15-9" aria-hidden="true" tabindex="-1"></a>dates2     <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="fu">as.Date</span>(<span class="st">&quot;1974-01-01&quot;</span>), <span class="at">length=</span><span class="dv">56</span>, <span class="at">by=</span><span class="st">&quot;quarters&quot;</span>)</span>
<span id="cb15-10"><a href="#cb15-10" aria-hidden="true" tabindex="-1"></a>Y1         <span class="ot">&lt;-</span> <span class="fu">xts</span>(<span class="fu">rep</span>(<span class="dv">1</span>, <span class="dv">107</span>), <span class="at">order.by=</span>dates1)</span>
<span id="cb15-11"><a href="#cb15-11" aria-hidden="true" tabindex="-1"></a>Y2         <span class="ot">&lt;-</span> <span class="fu">xts</span>(<span class="fu">rep</span>(<span class="dv">0</span>,  <span class="dv">56</span>), <span class="at">order.by=</span>dates2)</span>
<span id="cb15-12"><a href="#cb15-12" aria-hidden="true" tabindex="-1"></a>D1         <span class="ot">&lt;-</span> <span class="fu">rbind</span>(Y1,Y2)</span>
<span id="cb15-13"><a href="#cb15-13" aria-hidden="true" tabindex="-1"></a>Y3         <span class="ot">&lt;-</span> <span class="fu">xts</span>(<span class="fu">rep</span>(<span class="dv">0</span>, <span class="dv">107</span>), <span class="at">order.by=</span>dates1)</span>
<span id="cb15-14"><a href="#cb15-14" aria-hidden="true" tabindex="-1"></a>Y4         <span class="ot">&lt;-</span> <span class="fu">xts</span>(<span class="fu">rep</span>(<span class="dv">1</span>,  <span class="dv">56</span>), <span class="at">order.by=</span>dates2)</span>
<span id="cb15-15"><a href="#cb15-15" aria-hidden="true" tabindex="-1"></a>D2         <span class="ot">&lt;-</span> <span class="fu">rbind</span>(Y3,Y4)</span>
<span id="cb15-16"><a href="#cb15-16" aria-hidden="true" tabindex="-1"></a>YModel     <span class="ot">&lt;-</span><span class="fu">lm</span>(Y <span class="sc">~</span> D1<span class="sc">+</span>D2<span class="dv">-1</span>)</span>
<span id="cb15-17"><a href="#cb15-17" aria-hidden="true" tabindex="-1"></a>Y          <span class="ot">&lt;-</span><span class="fu">resid</span>(YModel)</span>
<span id="cb15-18"><a href="#cb15-18" aria-hidden="true" tabindex="-1"></a>Y_T        <span class="ot">&lt;-</span><span class="fu">as.xts</span>(<span class="fu">fitted</span>(YModel))</span>
<span id="cb15-19"><a href="#cb15-19" aria-hidden="true" tabindex="-1"></a>Y          <span class="ot">&lt;-</span><span class="fu">merge</span>(Y, <span class="fu">index</span>(U), <span class="at">join=</span><span class="st">&quot;outer&quot;</span>)</span>
<span id="cb15-20"><a href="#cb15-20" aria-hidden="true" tabindex="-1"></a>Y          <span class="ot">&lt;-</span><span class="fu">cbind</span>(<span class="fu">na.locf</span>(Y, <span class="at">fromLast =</span> <span class="cn">FALSE</span>))</span>
<span id="cb15-21"><a href="#cb15-21" aria-hidden="true" tabindex="-1"></a>BASE       <span class="ot">&lt;-</span><span class="fu">merge</span>(U, Y, <span class="at">join=</span><span class="st">&quot;left&quot;</span>)</span>
<span id="cb15-22"><a href="#cb15-22" aria-hidden="true" tabindex="-1"></a>Y_T        <span class="ot">&lt;-</span><span class="fu">merge</span>(Y_T, <span class="fu">index</span>(U), <span class="at">join=</span><span class="st">&quot;outer&quot;</span>)</span>
<span id="cb15-23"><a href="#cb15-23" aria-hidden="true" tabindex="-1"></a>Y_T        <span class="ot">&lt;-</span><span class="fu">cbind</span>(<span class="fu">na.locf</span>(Y_T, <span class="at">fromLast =</span> <span class="cn">FALSE</span>))</span>
<span id="cb15-24"><a href="#cb15-24" aria-hidden="true" tabindex="-1"></a>BASE       <span class="ot">&lt;-</span><span class="fu">merge</span>(BASE, Y_T, <span class="at">join=</span><span class="st">&quot;left&quot;</span>)</span>
<span id="cb15-25"><a href="#cb15-25" aria-hidden="true" tabindex="-1"></a>BASE       <span class="ot">&lt;-</span><span class="fu">data.frame</span>(<span class="at">date=</span><span class="fu">index</span>(BASE), <span class="fu">coredata</span>(BASE))</span>
<span id="cb15-26"><a href="#cb15-26" aria-hidden="true" tabindex="-1"></a>BASE       <span class="ot">&lt;-</span><span class="fu">filter</span>(BASE, date<span class="sc">&gt;=</span><span class="st">&quot;1950-01-01&quot;</span>)</span>
<span id="cb15-27"><a href="#cb15-27" aria-hidden="true" tabindex="-1"></a><span class="fu">colnames</span>(BASE)<span class="ot">&lt;-</span><span class="fu">c</span>(<span class="st">&quot;date&quot;</span>,<span class="st">&quot;U&quot;</span>, <span class="st">&quot;Y&quot;</span>, <span class="st">&quot;Y_T&quot;</span>)</span>
<span id="cb15-28"><a href="#cb15-28" aria-hidden="true" tabindex="-1"></a>DATA    <span class="ot">&lt;-</span>dplyr<span class="sc">::</span><span class="fu">select</span>(BASE, date, Y, U)</span>
<span id="cb15-29"><a href="#cb15-29" aria-hidden="true" tabindex="-1"></a><span class="fu">colnames</span>(DATA)<span class="ot">&lt;-</span><span class="fu">c</span>(<span class="st">&quot;date&quot;</span>, <span class="st">&quot;y&quot;</span>, <span class="st">&quot;u&quot;</span>)</span>
<span id="cb15-30"><a href="#cb15-30" aria-hidden="true" tabindex="-1"></a>DATA    <span class="ot">&lt;-</span> <span class="fu">xts</span>(DATA[,<span class="sc">-</span><span class="dv">1</span>], <span class="at">order.by=</span><span class="fu">as.Date</span>(DATA[,<span class="dv">1</span>], <span class="st">&quot;%Y/%m/%d&quot;</span>))</span>
<span id="cb15-31"><a href="#cb15-31" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(<span class="st">&quot;svars&quot;</span>)</span>
<span id="cb15-32"><a href="#cb15-32" aria-hidden="true" tabindex="-1"></a>VAR_2      <span class="ot">&lt;-</span> vars<span class="sc">::</span><span class="fu">VAR</span>(DATA, <span class="at">p =</span> <span class="dv">8</span>, <span class="at">type =</span> <span class="st">&#39;none&#39;</span>)</span>
<span id="cb15-33"><a href="#cb15-33" aria-hidden="true" tabindex="-1"></a>VAR_2<span class="sc">$</span>varresult<span class="sc">$</span>y<span class="sc">$</span>coefficients</span></code></pre></div>
<pre><code>##         y.l1         u.l1         y.l2         u.l2         y.l3         u.l3 
##  0.084643928 -0.797700253  0.091996360  1.687229033  0.014958902 -0.821969638 
##         y.l4         u.l4         y.l5         u.l5         y.l6         u.l6 
##  0.118395754  0.878320541  0.031906807 -0.965687332  0.199517955  0.555163427 
##         y.l7         u.l7         y.l8         u.l8 
## -0.075029618 -0.601355664 -0.002320675  0.281299408</code></pre>
<div class="sourceCode" id="cb17"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a>VAR_2<span class="sc">$</span>varresult<span class="sc">$</span>u<span class="sc">$</span>coefficients</span></code></pre></div>
<pre><code>##         y.l1         u.l1         y.l2         u.l2         y.l3         u.l3 
## -0.123340332  1.312024159 -0.102844727 -0.609397348 -0.090189350  0.089769287 
##         y.l4         u.l4         y.l5         u.l5         y.l6         u.l6 
## -0.037413568 -0.070811294 -0.014735409  0.235075502 -0.106024188 -0.070619219 
##         y.l7         u.l7         y.l8         u.l8 
## -0.004578130  0.063548050  0.009414328 -0.008749867</code></pre>
<div class="sourceCode" id="cb19"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a>SIGMA<span class="ot">&lt;-</span><span class="fu">summary</span>(VAR_2)</span>
<span id="cb19-2"><a href="#cb19-2" aria-hidden="true" tabindex="-1"></a>SIGMA<span class="sc">$</span>covres</span></code></pre></div>
<pre><code>##            y           u
## y  0.9118184 -0.19343517
## u -0.1934352  0.09180338</code></pre>
<p>Habiendo estimado el VAR a continuación encontramos las restricciones de corto y largo plazo:</p>
<div class="sourceCode" id="cb21"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a>BQMODEL<span class="ot">&lt;-</span> <span class="fu">BQ</span>(VAR_2 )</span>
<span id="cb21-2"><a href="#cb21-2" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(BQMODEL)</span></code></pre></div>
<pre><code>## 
## SVAR Estimation Results:
## ======================== 
## 
## Call:
## BQ(x = VAR_2)
## 
## Type: Blanchard-Quah 
## Sample size: 144 
## Log Likelihood: -188.052 
## 
## Estimated contemporaneous impact matrix:
##       y       u
## y 0.244 -0.9232
## u 0.167  0.2537
## 
## Estimated identified long run impact matrix:
##         y     u
## y  0.3794 0.000
## u -0.1890 4.288
## 
## Covariance matrix of reduced form residuals (*100):
##        y       u
## y  91.18 -19.343
## u -19.34   9.225</code></pre>
<p>En seguida calculamos la función impulso respuesta para cada variable teniendo en cuenta que la tasa de desempleo no sufre ningún efecto de ambos shocks estructurales de largo plazo.</p>
<div class="sourceCode" id="cb23"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a>FIR_BQ <span class="ot">&lt;-</span> <span class="fu">irf</span>(BQMODEL,<span class="at">n.ahead =</span> <span class="dv">40</span>, <span class="at">impulse =</span> <span class="fu">c</span>(<span class="st">&quot;y&quot;</span>, <span class="st">&quot;u&quot;</span>), <span class="at">boot =</span><span class="cn">FALSE</span>)</span>
<span id="cb23-2"><a href="#cb23-2" aria-hidden="true" tabindex="-1"></a>supply <span class="ot">&lt;-</span> <span class="fu">cbind</span>(<span class="fu">cumsum</span>(FIR_BQ<span class="sc">$</span>irf<span class="sc">$</span>y[, <span class="dv">1</span>]), FIR_BQ<span class="sc">$</span>irf<span class="sc">$</span>y[, <span class="dv">2</span>])</span>
<span id="cb23-3"><a href="#cb23-3" aria-hidden="true" tabindex="-1"></a>RESULTADO<span class="ot">&lt;-</span><span class="fu">as.data.frame</span>(supply)</span>
<span id="cb23-4"><a href="#cb23-4" aria-hidden="true" tabindex="-1"></a><span class="co">#RESULTADO&lt;-as.data.frame(FIR_BQ$irf$y)</span></span>
<span id="cb23-5"><a href="#cb23-5" aria-hidden="true" tabindex="-1"></a>PERIODO<span class="ot">&lt;-</span><span class="fu">seq</span>(<span class="dv">1</span>,<span class="dv">41</span>,<span class="dv">1</span>)</span>
<span id="cb23-6"><a href="#cb23-6" aria-hidden="true" tabindex="-1"></a>RESULTADO <span class="ot">&lt;-</span><span class="fu">cbind</span>(RESULTADO,PERIODO)</span>
<span id="cb23-7"><a href="#cb23-7" aria-hidden="true" tabindex="-1"></a>CODE<span class="ot">&lt;-</span><span class="fu">rep</span>(<span class="st">&quot;Tecnológico&quot;</span>,<span class="dv">41</span>)</span>
<span id="cb23-8"><a href="#cb23-8" aria-hidden="true" tabindex="-1"></a>RESULTADO <span class="ot">&lt;-</span><span class="fu">cbind</span>(RESULTADO,CODE)</span>
<span id="cb23-9"><a href="#cb23-9" aria-hidden="true" tabindex="-1"></a><span class="do">#####################################</span></span>
<span id="cb23-10"><a href="#cb23-10" aria-hidden="true" tabindex="-1"></a>demand <span class="ot">&lt;-</span> <span class="fu">cbind</span>(<span class="sc">-</span><span class="dv">1</span><span class="sc">*</span><span class="fu">cumsum</span>(FIR_BQ<span class="sc">$</span>irf<span class="sc">$</span>u[, <span class="dv">1</span>]), <span class="sc">-</span><span class="dv">1</span><span class="sc">*</span>FIR_BQ<span class="sc">$</span>irf<span class="sc">$</span>u[, <span class="dv">2</span>])</span>
<span id="cb23-11"><a href="#cb23-11" aria-hidden="true" tabindex="-1"></a>RESULTADO2 <span class="ot">&lt;-</span><span class="fu">as.data.frame</span>(demand)</span>
<span id="cb23-12"><a href="#cb23-12" aria-hidden="true" tabindex="-1"></a><span class="co">#RESULTADO2&lt;-as.data.frame(FIR_BQ$irf$u*-1)</span></span>
<span id="cb23-13"><a href="#cb23-13" aria-hidden="true" tabindex="-1"></a>RESULTADO2 <span class="ot">&lt;-</span><span class="fu">cbind</span>(RESULTADO2,PERIODO)</span>
<span id="cb23-14"><a href="#cb23-14" aria-hidden="true" tabindex="-1"></a>CODE<span class="ot">&lt;-</span><span class="fu">rep</span>(<span class="st">&quot;Demanda&quot;</span>,<span class="dv">41</span>)</span>
<span id="cb23-15"><a href="#cb23-15" aria-hidden="true" tabindex="-1"></a>RESULTADO2 <span class="ot">&lt;-</span><span class="fu">cbind</span>(RESULTADO2,CODE)</span>
<span id="cb23-16"><a href="#cb23-16" aria-hidden="true" tabindex="-1"></a>RESULTADO <span class="ot">&lt;-</span><span class="fu">rbind</span>(RESULTADO,RESULTADO2)</span>
<span id="cb23-17"><a href="#cb23-17" aria-hidden="true" tabindex="-1"></a><span class="co">#BASE_LONG &lt;- gather(RESULTADO, key=&quot;measure&quot;, value=&quot;value&quot;,c(&quot;y&quot;, &quot;u&quot;))</span></span>
<span id="cb23-18"><a href="#cb23-18" aria-hidden="true" tabindex="-1"></a><span class="co">#BASE_LONG$measure &lt;- factor(BASE_LONG$measure,                           levels = c(&quot;y&quot;, &quot;u&quot;))</span></span>
<span id="cb23-19"><a href="#cb23-19" aria-hidden="true" tabindex="-1"></a>BASE_LONG <span class="ot">&lt;-</span> <span class="fu">gather</span>(RESULTADO, <span class="at">key=</span><span class="st">&quot;measure&quot;</span>, <span class="at">value=</span><span class="st">&quot;value&quot;</span>,<span class="fu">c</span>(<span class="st">&quot;V1&quot;</span>, <span class="st">&quot;V2&quot;</span>))</span>
<span id="cb23-20"><a href="#cb23-20" aria-hidden="true" tabindex="-1"></a>BASE_LONG<span class="sc">$</span>measure <span class="ot">&lt;-</span> <span class="fu">factor</span>(BASE_LONG<span class="sc">$</span>measure,                           <span class="at">levels =</span> <span class="fu">c</span>(<span class="st">&quot;V1&quot;</span>, <span class="st">&quot;V2&quot;</span>))</span>
<span id="cb23-21"><a href="#cb23-21" aria-hidden="true" tabindex="-1"></a>BASE_LONG<span class="sc">$</span>CODE <span class="ot">&lt;-</span> <span class="fu">factor</span>(BASE_LONG<span class="sc">$</span>CODE,</span>
<span id="cb23-22"><a href="#cb23-22" aria-hidden="true" tabindex="-1"></a>                            <span class="at">levels =</span> <span class="fu">c</span>(<span class="st">&quot;Tecnológico&quot;</span>, <span class="st">&quot;Demanda&quot;</span>))</span>
<span id="cb23-23"><a href="#cb23-23" aria-hidden="true" tabindex="-1"></a>variable_names <span class="ot">&lt;-</span> <span class="fu">list</span>(</span>
<span id="cb23-24"><a href="#cb23-24" aria-hidden="true" tabindex="-1"></a>  <span class="st">&quot;Tecnológico&quot;</span> <span class="ot">=</span> <span class="st">&quot;Shock de oferta&quot;</span>,</span>
<span id="cb23-25"><a href="#cb23-25" aria-hidden="true" tabindex="-1"></a>      <span class="st">&quot;Demanda&quot;</span> <span class="ot">=</span> <span class="st">&quot;Shock de demanda&quot;</span></span>
<span id="cb23-26"><a href="#cb23-26" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb23-27"><a href="#cb23-27" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-28"><a href="#cb23-28" aria-hidden="true" tabindex="-1"></a>variable_labeller2 <span class="ot">&lt;-</span> <span class="cf">function</span>(variable,value){</span>
<span id="cb23-29"><a href="#cb23-29" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (variable<span class="sc">==</span><span class="st">&#39;CODE&#39;</span>) {</span>
<span id="cb23-30"><a href="#cb23-30" aria-hidden="true" tabindex="-1"></a>    <span class="fu">return</span>(variable_names[value])</span>
<span id="cb23-31"><a href="#cb23-31" aria-hidden="true" tabindex="-1"></a>  } <span class="cf">else</span> {</span>
<span id="cb23-32"><a href="#cb23-32" aria-hidden="true" tabindex="-1"></a>    <span class="fu">return</span>(region_names)</span>
<span id="cb23-33"><a href="#cb23-33" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb23-34"><a href="#cb23-34" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb23-35"><a href="#cb23-35" aria-hidden="true" tabindex="-1"></a>paleta<span class="ot">&lt;-</span><span class="fu">c</span>(<span class="st">&quot;blue&quot;</span>, <span class="st">&quot;red&quot;</span>)</span>
<span id="cb23-36"><a href="#cb23-36" aria-hidden="true" tabindex="-1"></a>Z<span class="ot">&lt;-</span><span class="fu">ggplot</span>(BASE_LONG, <span class="fu">aes</span>(<span class="at">x=</span>PERIODO, <span class="at">y=</span>value, <span class="at">group =</span> measure,</span>
<span id="cb23-37"><a href="#cb23-37" aria-hidden="true" tabindex="-1"></a>                         <span class="at">colour=</span>measure))<span class="sc">+</span></span>
<span id="cb23-38"><a href="#cb23-38" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(.<span class="sc">~</span>CODE, <span class="at">scales=</span><span class="st">&quot;free&quot;</span>, <span class="at">labeller=</span> variable_labeller2)</span>
<span id="cb23-39"><a href="#cb23-39" aria-hidden="true" tabindex="-1"></a>Z<span class="ot">&lt;-</span>Z<span class="sc">+</span><span class="fu">labs</span>(<span class="at">y=</span><span class="st">&quot;Respuesta&quot;</span>,</span>
<span id="cb23-40"><a href="#cb23-40" aria-hidden="true" tabindex="-1"></a>          <span class="at">x=</span><span class="st">&quot;Períodos&quot;</span>)<span class="sc">+</span></span>
<span id="cb23-41"><a href="#cb23-41" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_hline</span>(<span class="at">yintercept=</span><span class="dv">0</span>, <span class="at">linetype=</span><span class="st">&quot;dashed&quot;</span>,</span>
<span id="cb23-42"><a href="#cb23-42" aria-hidden="true" tabindex="-1"></a>             <span class="at">color =</span> <span class="st">&quot;black&quot;</span>, <span class="at">size=</span><span class="dv">1</span>)<span class="sc">+</span></span>
<span id="cb23-43"><a href="#cb23-43" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="at">size=</span><span class="fl">1.5</span>)<span class="sc">+</span></span>
<span id="cb23-44"><a href="#cb23-44" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(<span class="at">values=</span>paleta,</span>
<span id="cb23-45"><a href="#cb23-45" aria-hidden="true" tabindex="-1"></a>                     <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">&quot;Tasa de crecimiento del producto&quot;</span>,</span>
<span id="cb23-46"><a href="#cb23-46" aria-hidden="true" tabindex="-1"></a>                                <span class="st">&quot;Desempleo&quot;</span>))</span>
<span id="cb23-47"><a href="#cb23-47" aria-hidden="true" tabindex="-1"></a>Z<span class="ot">&lt;-</span>Z<span class="sc">+</span><span class="fu">theme</span>(<span class="at">axis.line.x =</span> <span class="fu">element_line</span>(<span class="at">colour =</span> <span class="st">&quot;black&quot;</span>, <span class="at">size =</span> <span class="fl">0.5</span>),</span>
<span id="cb23-48"><a href="#cb23-48" aria-hidden="true" tabindex="-1"></a>           <span class="at">axis.line.y.left  =</span> <span class="fu">element_line</span>(<span class="at">colour =</span> <span class="st">&quot;black&quot;</span>, <span class="at">size =</span> <span class="fl">0.5</span>),</span>
<span id="cb23-49"><a href="#cb23-49" aria-hidden="true" tabindex="-1"></a>           <span class="at">axis.line.y.right =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb23-50"><a href="#cb23-50" aria-hidden="true" tabindex="-1"></a>           <span class="at">axis.text.x =</span> <span class="fu">element_text</span>( <span class="at">color =</span> <span class="st">&quot;black&quot;</span>, <span class="at">size =</span> <span class="dv">14</span>),</span>
<span id="cb23-51"><a href="#cb23-51" aria-hidden="true" tabindex="-1"></a>           <span class="at">axis.text.y =</span> <span class="fu">element_text</span>( <span class="at">color =</span> <span class="st">&quot;black&quot;</span>, <span class="at">size =</span> <span class="dv">12</span>),</span>
<span id="cb23-52"><a href="#cb23-52" aria-hidden="true" tabindex="-1"></a>           <span class="at">panel.grid.minor =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb23-53"><a href="#cb23-53" aria-hidden="true" tabindex="-1"></a>           <span class="at">panel.grid.major.y =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb23-54"><a href="#cb23-54" aria-hidden="true" tabindex="-1"></a>           <span class="at">panel.grid.major.x =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb23-55"><a href="#cb23-55" aria-hidden="true" tabindex="-1"></a>           <span class="at">panel.border =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb23-56"><a href="#cb23-56" aria-hidden="true" tabindex="-1"></a>           <span class="at">panel.background =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb23-57"><a href="#cb23-57" aria-hidden="true" tabindex="-1"></a>           <span class="at">legend.key=</span><span class="fu">element_rect</span>(<span class="at">fill =</span> <span class="st">&quot;white&quot;</span>, <span class="at">colour =</span> <span class="st">&quot;white&quot;</span>,</span>
<span id="cb23-58"><a href="#cb23-58" aria-hidden="true" tabindex="-1"></a>                                   <span class="at">color =</span> <span class="st">&quot;white&quot;</span>, <span class="at">inherit.blank =</span> <span class="cn">FALSE</span>),</span>
<span id="cb23-59"><a href="#cb23-59" aria-hidden="true" tabindex="-1"></a>           <span class="at">legend.title =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb23-60"><a href="#cb23-60" aria-hidden="true" tabindex="-1"></a>           <span class="at">legend.text  =</span> <span class="fu">element_text</span>(<span class="at">size=</span><span class="dv">10</span>),</span>
<span id="cb23-61"><a href="#cb23-61" aria-hidden="true" tabindex="-1"></a>           <span class="at">legend.position=</span><span class="st">&quot;bottom&quot;</span>,</span>
<span id="cb23-62"><a href="#cb23-62" aria-hidden="true" tabindex="-1"></a>           <span class="at">legend.spacing.x =</span> <span class="fu">unit</span>(<span class="fl">0.10</span>, <span class="st">&#39;cm&#39;</span>),</span>
<span id="cb23-63"><a href="#cb23-63" aria-hidden="true" tabindex="-1"></a>           <span class="at">legend.margin=</span><span class="fu">margin</span>(),</span>
<span id="cb23-64"><a href="#cb23-64" aria-hidden="true" tabindex="-1"></a>           <span class="at">legend.background =</span> <span class="fu">element_rect</span>(<span class="at">fill =</span> <span class="st">&quot;white&quot;</span>, <span class="at">colour =</span> <span class="st">&quot;transparent&quot;</span>,</span>
<span id="cb23-65"><a href="#cb23-65" aria-hidden="true" tabindex="-1"></a>                                            <span class="at">color =</span> <span class="st">&quot;white&quot;</span>, <span class="at">inherit.blank =</span> <span class="cn">FALSE</span>)</span>
<span id="cb23-66"><a href="#cb23-66" aria-hidden="true" tabindex="-1"></a>)<span class="sc">+</span><span class="fu">guides</span>(<span class="at">color =</span> <span class="fu">guide_legend</span>(<span class="at">nrow =</span> <span class="dv">1</span>))</span>
<span id="cb23-67"><a href="#cb23-67" aria-hidden="true" tabindex="-1"></a>Z</span></code></pre></div>
<p><img src="01-conceptos_files/figure-html/unnamed-chunk-7-1.png" width="672" /></p>
<p>El resultado de <span class="citation">Blanchard and Quah (<a href="#ref-BLANCHARD88" role="doc-biblioref">1988</a>)</span> implican que los choques de demanda fueron responsables de la gran mayoría de las fluctuaciones en el corto plazo.</p>
<div class="sourceCode" id="cb24"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb24-1"><a href="#cb24-1" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span> (BQMODEL<span class="sc">$</span>B[<span class="dv">1</span>,<span class="dv">2</span>]<span class="sc">&lt;</span><span class="dv">0</span>){</span>
<span id="cb24-2"><a href="#cb24-2" aria-hidden="true" tabindex="-1"></a>  V<span class="ot">=</span><span class="fu">c</span>(<span class="dv">1</span>,<span class="sc">-</span><span class="dv">1</span>)</span>
<span id="cb24-3"><a href="#cb24-3" aria-hidden="true" tabindex="-1"></a>  bqfactor<span class="ot">&lt;-</span>BQMODEL<span class="sc">$</span>B<span class="sc">%*%</span><span class="fu">as.matrix</span>(<span class="fu">diag</span>(V))</span>
<span id="cb24-4"><a href="#cb24-4" aria-hidden="true" tabindex="-1"></a>  } </span>
<span id="cb24-5"><a href="#cb24-5" aria-hidden="true" tabindex="-1"></a>adjust<span class="ot">&lt;-</span>(VAR_2<span class="sc">$</span>obs<span class="sc">-</span>((VAR_2<span class="sc">$</span>varresult<span class="sc">$</span>y<span class="sc">$</span>rank<span class="sc">+</span>VAR_2<span class="sc">$</span>varresult<span class="sc">$</span>u<span class="sc">$</span>rank)<span class="sc">/</span>VAR_2<span class="sc">$</span>K))<span class="sc">/</span>VAR_2<span class="sc">$</span>obs</span>
<span id="cb24-6"><a href="#cb24-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-7"><a href="#cb24-7" aria-hidden="true" tabindex="-1"></a>bqfactor<span class="ot">&lt;-</span>bqfactor<span class="sc">*</span><span class="fu">sqrt</span>(adjust)</span>
<span id="cb24-8"><a href="#cb24-8" aria-hidden="true" tabindex="-1"></a>VARhd <span class="ot">&lt;-</span> <span class="cf">function</span>(Estimation){</span>
<span id="cb24-9"><a href="#cb24-9" aria-hidden="true" tabindex="-1"></a> <span class="do">## make X and Y</span></span>
<span id="cb24-10"><a href="#cb24-10" aria-hidden="true" tabindex="-1"></a>nlag    <span class="ot">&lt;-</span> Estimation<span class="sc">$</span>p   <span class="co"># number of lags</span></span>
<span id="cb24-11"><a href="#cb24-11" aria-hidden="true" tabindex="-1"></a>DATA    <span class="ot">&lt;-</span> Estimation<span class="sc">$</span>y   <span class="co"># data</span></span>
<span id="cb24-12"><a href="#cb24-12" aria-hidden="true" tabindex="-1"></a>QQ      <span class="ot">&lt;-</span> <span class="fu">VARmakexy</span>(DATA,nlag,<span class="dv">0</span>)</span>
<span id="cb24-13"><a href="#cb24-13" aria-hidden="true" tabindex="-1"></a><span class="do">## Retrieve and initialize variables </span></span>
<span id="cb24-14"><a href="#cb24-14" aria-hidden="true" tabindex="-1"></a><span class="co">#invA   &lt;- t(chol(as.matrix(summary(Estimation)$covres)))# inverse of the A matrix</span></span>
<span id="cb24-15"><a href="#cb24-15" aria-hidden="true" tabindex="-1"></a><span class="co">#invA    &lt;- BQMODEL$LRIM</span></span>
<span id="cb24-16"><a href="#cb24-16" aria-hidden="true" tabindex="-1"></a>invA    <span class="ot">&lt;-</span> bqfactor</span>
<span id="cb24-17"><a href="#cb24-17" aria-hidden="true" tabindex="-1"></a>Fcomp   <span class="ot">&lt;-</span> <span class="fu">companionmatrix</span>(Estimation)                   <span class="co"># Companion matrix</span></span>
<span id="cb24-18"><a href="#cb24-18" aria-hidden="true" tabindex="-1"></a><span class="co">#det     &lt;- c_case                                       # constant and/or trends</span></span>
<span id="cb24-19"><a href="#cb24-19" aria-hidden="true" tabindex="-1"></a>F1      <span class="ot">&lt;-</span> <span class="fu">t</span>(QQ<span class="sc">$</span>Ft)                                     <span class="co"># make comparable to notes</span></span>
<span id="cb24-20"><a href="#cb24-20" aria-hidden="true" tabindex="-1"></a>eps     <span class="ot">&lt;-</span> <span class="fu">ginv</span>(invA) <span class="sc">%*%</span> <span class="fu">t</span>(<span class="fu">residuals</span>(Estimation)) </span>
<span id="cb24-21"><a href="#cb24-21" aria-hidden="true" tabindex="-1"></a><span class="co"># structural errors </span></span>
<span id="cb24-22"><a href="#cb24-22" aria-hidden="true" tabindex="-1"></a>nvar    <span class="ot">&lt;-</span> Estimation<span class="sc">$</span>K                                 <span class="co"># number of endogenous variables</span></span>
<span id="cb24-23"><a href="#cb24-23" aria-hidden="true" tabindex="-1"></a>nvarXeq <span class="ot">&lt;-</span> nvar <span class="sc">*</span> nlag                                  <span class="co"># number of lagged endogenous per equation</span></span>
<span id="cb24-24"><a href="#cb24-24" aria-hidden="true" tabindex="-1"></a>nvar_ex <span class="ot">&lt;-</span> <span class="dv">0</span>                                                <span class="co"># number of exogenous (excluding constant and trend)</span></span>
<span id="cb24-25"><a href="#cb24-25" aria-hidden="true" tabindex="-1"></a>Y       <span class="ot">&lt;-</span> QQ<span class="sc">$</span>Y                                             <span class="co"># left-hand side</span></span>
<span id="cb24-26"><a href="#cb24-26" aria-hidden="true" tabindex="-1"></a><span class="co">#X     &lt;- QQ$X[,(1+det):(nvarXeq+det)]                    # right-hand side (no exogenous)</span></span>
<span id="cb24-27"><a href="#cb24-27" aria-hidden="true" tabindex="-1"></a>nobs    <span class="ot">&lt;-</span> <span class="fu">nrow</span>(Y)                                          <span class="co"># number of observations</span></span>
<span id="cb24-28"><a href="#cb24-28" aria-hidden="true" tabindex="-1"></a><span class="do">## Compute historical decompositions</span></span>
<span id="cb24-29"><a href="#cb24-29" aria-hidden="true" tabindex="-1"></a><span class="co"># Contribution of each shock</span></span>
<span id="cb24-30"><a href="#cb24-30" aria-hidden="true" tabindex="-1"></a>invA_big    <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="dv">0</span>,nvarXeq,nvar)</span>
<span id="cb24-31"><a href="#cb24-31" aria-hidden="true" tabindex="-1"></a>invA_big[<span class="dv">1</span><span class="sc">:</span>nvar,] <span class="ot">&lt;-</span> invA</span>
<span id="cb24-32"><a href="#cb24-32" aria-hidden="true" tabindex="-1"></a>Icomp       <span class="ot">&lt;-</span> <span class="fu">cbind</span>(<span class="fu">diag</span>(nvar), <span class="fu">matrix</span>(<span class="dv">0</span>,nvar,(nlag<span class="dv">-1</span>)<span class="sc">*</span>nvar))</span>
<span id="cb24-33"><a href="#cb24-33" aria-hidden="true" tabindex="-1"></a>HDshock_big <span class="ot">&lt;-</span> <span class="fu">array</span>(<span class="dv">0</span>, <span class="at">dim=</span><span class="fu">c</span>(nlag<span class="sc">*</span>nvar,nobs<span class="sc">+</span><span class="dv">1</span>,nvar))</span>
<span id="cb24-34"><a href="#cb24-34" aria-hidden="true" tabindex="-1"></a>HDshock     <span class="ot">&lt;-</span> <span class="fu">array</span>(<span class="dv">0</span>, <span class="at">dim=</span><span class="fu">c</span>(nvar,(nobs<span class="sc">+</span><span class="dv">1</span>),nvar))</span>
<span id="cb24-35"><a href="#cb24-35" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-36"><a href="#cb24-36" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (j <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>nvar){  <span class="co"># for each variable</span></span>
<span id="cb24-37"><a href="#cb24-37" aria-hidden="true" tabindex="-1"></a>  eps_big <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="dv">0</span>,nvar,(nobs<span class="sc">+</span><span class="dv">1</span>)) <span class="co"># matrix of shocks conformable with companion</span></span>
<span id="cb24-38"><a href="#cb24-38" aria-hidden="true" tabindex="-1"></a>  eps_big[j,<span class="dv">2</span><span class="sc">:</span><span class="fu">ncol</span>(eps_big)] <span class="ot">&lt;-</span> eps[j,]</span>
<span id="cb24-39"><a href="#cb24-39" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">2</span><span class="sc">:</span>(nobs<span class="sc">+</span><span class="dv">1</span>)){</span>
<span id="cb24-40"><a href="#cb24-40" aria-hidden="true" tabindex="-1"></a>    HDshock_big[,i,j] <span class="ot">&lt;-</span> invA_big <span class="sc">%*%</span> eps_big[,i] <span class="sc">+</span> Fcomp <span class="sc">%*%</span> HDshock_big[,(i<span class="dv">-1</span>),j]</span>
<span id="cb24-41"><a href="#cb24-41" aria-hidden="true" tabindex="-1"></a>    HDshock[,i,j] <span class="ot">&lt;-</span>  Icomp <span class="sc">%*%</span> HDshock_big[,i,j]</span>
<span id="cb24-42"><a href="#cb24-42" aria-hidden="true" tabindex="-1"></a>  } </span>
<span id="cb24-43"><a href="#cb24-43" aria-hidden="true" tabindex="-1"></a>} </span>
<span id="cb24-44"><a href="#cb24-44" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-45"><a href="#cb24-45" aria-hidden="true" tabindex="-1"></a>HD.shock <span class="ot">&lt;-</span> <span class="fu">array</span>(<span class="dv">0</span>, <span class="at">dim=</span><span class="fu">c</span>((nobs<span class="sc">+</span>nlag),nvar,nvar))   <span class="co"># [nobs x shock x var]</span></span>
<span id="cb24-46"><a href="#cb24-46" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-47"><a href="#cb24-47" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>nvar){</span>
<span id="cb24-48"><a href="#cb24-48" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> (j <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>nvar){</span>
<span id="cb24-49"><a href="#cb24-49" aria-hidden="true" tabindex="-1"></a>      HD.shock[,j,i] <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fu">rep</span>(<span class="cn">NA</span>,nlag), HDshock[i,(<span class="dv">2</span><span class="sc">:</span><span class="fu">dim</span>(HDshock)[<span class="dv">2</span>]),j])</span>
<span id="cb24-50"><a href="#cb24-50" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb24-51"><a href="#cb24-51" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb24-52"><a href="#cb24-52" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-53"><a href="#cb24-53" aria-hidden="true" tabindex="-1"></a><span class="fu">return</span>(HD.shock)</span>
<span id="cb24-54"><a href="#cb24-54" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-55"><a href="#cb24-55" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb24-56"><a href="#cb24-56" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-57"><a href="#cb24-57" aria-hidden="true" tabindex="-1"></a>VARmakexy <span class="ot">&lt;-</span> <span class="cf">function</span>(DATA,lags,c_case){</span>
<span id="cb24-58"><a href="#cb24-58" aria-hidden="true" tabindex="-1"></a>nobs <span class="ot">&lt;-</span> <span class="fu">nrow</span>(DATA)</span>
<span id="cb24-59"><a href="#cb24-59" aria-hidden="true" tabindex="-1"></a><span class="co">#Y matrix </span></span>
<span id="cb24-60"><a href="#cb24-60" aria-hidden="true" tabindex="-1"></a>Y <span class="ot">&lt;-</span> DATA[(lags<span class="sc">+</span><span class="dv">1</span>)<span class="sc">:</span><span class="fu">nrow</span>(DATA),]</span>
<span id="cb24-61"><a href="#cb24-61" aria-hidden="true" tabindex="-1"></a>Y <span class="ot">&lt;-</span> DATA[<span class="sc">-</span><span class="fu">c</span>(<span class="dv">1</span><span class="sc">:</span>lags),]</span>
<span id="cb24-62"><a href="#cb24-62" aria-hidden="true" tabindex="-1"></a><span class="co">#X-matrix </span></span>
<span id="cb24-63"><a href="#cb24-63" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span> (c_case<span class="sc">==</span><span class="dv">0</span>){</span>
<span id="cb24-64"><a href="#cb24-64" aria-hidden="true" tabindex="-1"></a>  X <span class="ot">&lt;-</span> <span class="cn">NA</span></span>
<span id="cb24-65"><a href="#cb24-65" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span> (jj <span class="cf">in</span> <span class="dv">0</span><span class="sc">:</span>(lags<span class="dv">-1</span>)){</span>
<span id="cb24-66"><a href="#cb24-66" aria-hidden="true" tabindex="-1"></a>        X <span class="ot">&lt;-</span> <span class="fu">rbind</span>(DATA[(jj<span class="sc">+</span><span class="dv">1</span>)<span class="sc">:</span>(nobs<span class="sc">-</span>lags<span class="sc">+</span>jj),])</span>
<span id="cb24-67"><a href="#cb24-67" aria-hidden="true" tabindex="-1"></a>      } </span>
<span id="cb24-68"><a href="#cb24-68" aria-hidden="true" tabindex="-1"></a>  } <span class="cf">else</span> <span class="cf">if</span>(c_case<span class="sc">==</span><span class="dv">1</span>){ <span class="co">#constant</span></span>
<span id="cb24-69"><a href="#cb24-69" aria-hidden="true" tabindex="-1"></a>      X <span class="ot">&lt;-</span> <span class="cn">NA</span></span>
<span id="cb24-70"><a href="#cb24-70" aria-hidden="true" tabindex="-1"></a>      <span class="cf">for</span> (jj <span class="cf">in</span> <span class="dv">0</span><span class="sc">:</span>(lags<span class="dv">-1</span>)){</span>
<span id="cb24-71"><a href="#cb24-71" aria-hidden="true" tabindex="-1"></a>        X <span class="ot">&lt;-</span> <span class="fu">rbind</span>(DATA[(jj<span class="sc">+</span><span class="dv">1</span>)<span class="sc">:</span>(nobs<span class="sc">-</span>lags<span class="sc">+</span>jj),])</span>
<span id="cb24-72"><a href="#cb24-72" aria-hidden="true" tabindex="-1"></a>      }</span>
<span id="cb24-73"><a href="#cb24-73" aria-hidden="true" tabindex="-1"></a>      X <span class="ot">&lt;-</span> <span class="fu">cbind</span>(<span class="fu">matrix</span>(<span class="dv">1</span>,(nobs<span class="sc">-</span>lags),<span class="dv">1</span>), X) </span>
<span id="cb24-74"><a href="#cb24-74" aria-hidden="true" tabindex="-1"></a>    } <span class="cf">else</span> <span class="cf">if</span>(c_case<span class="sc">==</span><span class="dv">2</span>){ <span class="co"># time trend and constant</span></span>
<span id="cb24-75"><a href="#cb24-75" aria-hidden="true" tabindex="-1"></a>      X <span class="ot">&lt;-</span> <span class="cn">NA</span></span>
<span id="cb24-76"><a href="#cb24-76" aria-hidden="true" tabindex="-1"></a>      <span class="cf">for</span> (jj <span class="cf">in</span> <span class="dv">0</span><span class="sc">:</span>(lags<span class="dv">-1</span>)){</span>
<span id="cb24-77"><a href="#cb24-77" aria-hidden="true" tabindex="-1"></a>        X <span class="ot">&lt;-</span> <span class="fu">rbind</span>(DATA[(jj<span class="sc">+</span><span class="dv">1</span>)<span class="sc">:</span>(nobs<span class="sc">-</span>lags<span class="sc">+</span>jj),])</span>
<span id="cb24-78"><a href="#cb24-78" aria-hidden="true" tabindex="-1"></a>      }</span>
<span id="cb24-79"><a href="#cb24-79" aria-hidden="true" tabindex="-1"></a>      trend <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">1</span><span class="sc">:</span><span class="fu">nrow</span>(X))</span>
<span id="cb24-80"><a href="#cb24-80" aria-hidden="true" tabindex="-1"></a>      X <span class="ot">&lt;-</span><span class="fu">cbind</span>(<span class="fu">matrix</span>(<span class="dv">1</span>,(nobs<span class="sc">-</span>lags),<span class="dv">1</span>), <span class="fu">t</span>(trend))</span>
<span id="cb24-81"><a href="#cb24-81" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb24-82"><a href="#cb24-82" aria-hidden="true" tabindex="-1"></a>A <span class="ot">&lt;-</span> (<span class="fu">t</span>(X) <span class="sc">%*%</span> <span class="fu">as.matrix</span>(X)) </span>
<span id="cb24-83"><a href="#cb24-83" aria-hidden="true" tabindex="-1"></a>B <span class="ot">&lt;-</span> (<span class="fu">as.matrix</span>(<span class="fu">t</span>(X)) <span class="sc">%*%</span> <span class="fu">as.matrix</span>(Y))</span>
<span id="cb24-84"><a href="#cb24-84" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-85"><a href="#cb24-85" aria-hidden="true" tabindex="-1"></a>Ft <span class="ot">&lt;-</span> <span class="fu">ginv</span>(A) <span class="sc">%*%</span> B</span>
<span id="cb24-86"><a href="#cb24-86" aria-hidden="true" tabindex="-1"></a>retu <span class="ot">&lt;-</span> <span class="fu">list</span>(<span class="at">X=</span>X,<span class="at">Y=</span>Y, <span class="at">Ft=</span>Ft)</span>
<span id="cb24-87"><a href="#cb24-87" aria-hidden="true" tabindex="-1"></a><span class="fu">return</span>(retu)</span>
<span id="cb24-88"><a href="#cb24-88" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb24-89"><a href="#cb24-89" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-90"><a href="#cb24-90" aria-hidden="true" tabindex="-1"></a>companionmatrix <span class="ot">&lt;-</span> <span class="cf">function</span> (x) </span>
<span id="cb24-91"><a href="#cb24-91" aria-hidden="true" tabindex="-1"></a>{</span>
<span id="cb24-92"><a href="#cb24-92" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (<span class="sc">!</span>(<span class="fu">class</span>(x) <span class="sc">==</span> <span class="st">&quot;varest&quot;</span>)) {</span>
<span id="cb24-93"><a href="#cb24-93" aria-hidden="true" tabindex="-1"></a>    <span class="fu">stop</span>(<span class="st">&quot;</span><span class="sc">\n</span><span class="st">Please provide an object of class &#39;varest&#39;, generated by &#39;VAR()&#39;.</span><span class="sc">\n</span><span class="st">&quot;</span>)</span>
<span id="cb24-94"><a href="#cb24-94" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb24-95"><a href="#cb24-95" aria-hidden="true" tabindex="-1"></a>  K <span class="ot">&lt;-</span> x<span class="sc">$</span>K</span>
<span id="cb24-96"><a href="#cb24-96" aria-hidden="true" tabindex="-1"></a>  p <span class="ot">&lt;-</span> x<span class="sc">$</span>p</span>
<span id="cb24-97"><a href="#cb24-97" aria-hidden="true" tabindex="-1"></a>  A <span class="ot">&lt;-</span> <span class="fu">unlist</span>(<span class="fu">Acoef</span>(x))</span>
<span id="cb24-98"><a href="#cb24-98" aria-hidden="true" tabindex="-1"></a>  companion <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="dv">0</span>, <span class="at">nrow =</span> K <span class="sc">*</span> p, <span class="at">ncol =</span> K <span class="sc">*</span> p)</span>
<span id="cb24-99"><a href="#cb24-99" aria-hidden="true" tabindex="-1"></a>  companion[<span class="dv">1</span><span class="sc">:</span>K, <span class="dv">1</span><span class="sc">:</span>(K <span class="sc">*</span> p)] <span class="ot">&lt;-</span> A</span>
<span id="cb24-100"><a href="#cb24-100" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (p <span class="sc">&gt;</span> <span class="dv">1</span>) {</span>
<span id="cb24-101"><a href="#cb24-101" aria-hidden="true" tabindex="-1"></a>    j <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb24-102"><a href="#cb24-102" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> (i <span class="cf">in</span> (K <span class="sc">+</span> <span class="dv">1</span>)<span class="sc">:</span>(K <span class="sc">*</span> p)) {</span>
<span id="cb24-103"><a href="#cb24-103" aria-hidden="true" tabindex="-1"></a>      j <span class="ot">&lt;-</span> j <span class="sc">+</span> <span class="dv">1</span></span>
<span id="cb24-104"><a href="#cb24-104" aria-hidden="true" tabindex="-1"></a>      companion[i, j] <span class="ot">&lt;-</span> <span class="dv">1</span></span>
<span id="cb24-105"><a href="#cb24-105" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb24-106"><a href="#cb24-106" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb24-107"><a href="#cb24-107" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(companion)</span>
<span id="cb24-108"><a href="#cb24-108" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb24-109"><a href="#cb24-109" aria-hidden="true" tabindex="-1"></a>dates1     <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="fu">as.Date</span>(<span class="st">&quot;1950-01-01&quot;</span>), <span class="at">length=</span><span class="dv">152</span>,<span class="at">by=</span><span class="st">&quot;quarters&quot;</span>)</span>
<span id="cb24-110"><a href="#cb24-110" aria-hidden="true" tabindex="-1"></a>BQH<span class="ot">&lt;-</span><span class="fu">VARhd</span>(VAR_2)</span>
<span id="cb24-111"><a href="#cb24-111" aria-hidden="true" tabindex="-1"></a>BQY_D<span class="ot">&lt;-</span>BQH[,<span class="dv">2</span>,<span class="dv">1</span>]</span>
<span id="cb24-112"><a href="#cb24-112" aria-hidden="true" tabindex="-1"></a>BQY_D<span class="ot">&lt;-</span><span class="fu">xts</span>(BQY_D, <span class="at">order.by=</span>dates1)</span>
<span id="cb24-113"><a href="#cb24-113" aria-hidden="true" tabindex="-1"></a>BQY_S1<span class="ot">&lt;-</span>BQH[,<span class="dv">1</span>,<span class="dv">1</span>]</span>
<span id="cb24-114"><a href="#cb24-114" aria-hidden="true" tabindex="-1"></a>BQY_S1<span class="ot">&lt;-</span><span class="fu">xts</span>(BQY_S1, <span class="at">order.by=</span>dates1)</span>
<span id="cb24-115"><a href="#cb24-115" aria-hidden="true" tabindex="-1"></a>BQY_S<span class="ot">&lt;-</span>BQY_S1<span class="sc">+</span>BASE<span class="sc">$</span>Y_T</span>
<span id="cb24-116"><a href="#cb24-116" aria-hidden="true" tabindex="-1"></a>BQY_S<span class="ot">&lt;-</span><span class="fu">cumsum</span>(<span class="fu">na.omit</span>(BQY_S<span class="sc">*</span><span class="fl">0.01</span>))</span>
<span id="cb24-117"><a href="#cb24-117" aria-hidden="true" tabindex="-1"></a>BQY_S<span class="ot">&lt;-</span>BQY_S<span class="sc">+</span><span class="fu">as.numeric</span>(<span class="fu">coredata</span>(<span class="fu">log</span>(GDPC1[<span class="st">&quot;1952-01-01&quot;</span>])))</span>
<span id="cb24-118"><a href="#cb24-118" aria-hidden="true" tabindex="-1"></a>ep_USRECD  <span class="ot">&lt;-</span><span class="fu">endpoints</span>(USRECD, <span class="at">on =</span> <span class="st">&quot;quarters&quot;</span>)</span>
<span id="cb24-119"><a href="#cb24-119" aria-hidden="true" tabindex="-1"></a>USRECD     <span class="ot">&lt;-</span><span class="fu">period.apply</span>(USRECD , <span class="at">INDEX =</span> ep_USRECD, <span class="at">FUN =</span> max)</span>
<span id="cb24-120"><a href="#cb24-120" aria-hidden="true" tabindex="-1"></a>YY         <span class="ot">&lt;-</span><span class="fu">merge</span>(USRECD, <span class="fu">index</span>(BQY_D), <span class="at">join=</span><span class="st">&quot;outer&quot;</span>)</span>
<span id="cb24-121"><a href="#cb24-121" aria-hidden="true" tabindex="-1"></a>YY          <span class="ot">&lt;-</span><span class="fu">cbind</span>(<span class="fu">na.locf</span>(YY, <span class="at">fromLast =</span> <span class="cn">TRUE</span>))</span>
<span id="cb24-122"><a href="#cb24-122" aria-hidden="true" tabindex="-1"></a>BASE2       <span class="ot">&lt;-</span><span class="fu">merge</span>(BQY_D, YY, <span class="at">join=</span><span class="st">&quot;left&quot;</span>)</span>
<span id="cb24-123"><a href="#cb24-123" aria-hidden="true" tabindex="-1"></a>BASE2       <span class="ot">&lt;-</span><span class="fu">merge</span>(BASE2, BQY_S1, <span class="at">join=</span><span class="st">&quot;left&quot;</span>)</span>
<span id="cb24-124"><a href="#cb24-124" aria-hidden="true" tabindex="-1"></a>BASE2       <span class="ot">&lt;-</span><span class="fu">data.frame</span>(<span class="at">date=</span><span class="fu">index</span>(BASE2), <span class="fu">coredata</span>(BASE2))</span>
<span id="cb24-125"><a href="#cb24-125" aria-hidden="true" tabindex="-1"></a><span class="fu">colnames</span>(BASE2)<span class="ot">&lt;-</span><span class="fu">c</span>(<span class="st">&quot;date&quot;</span>,<span class="st">&quot;Y_D&quot;</span>, <span class="st">&quot;Y_S&quot;</span>)<span class="co">#&quot;R&quot;, &quot;Y_S&quot;)</span></span>
<span id="cb24-126"><a href="#cb24-126" aria-hidden="true" tabindex="-1"></a>DATA    <span class="ot">&lt;-</span>dplyr<span class="sc">::</span><span class="fu">select</span>(BASE2, date, Y_D, Y_S)<span class="co">#R, Y_S)</span></span>
<span id="cb24-127"><a href="#cb24-127" aria-hidden="true" tabindex="-1"></a>DATA    <span class="ot">&lt;-</span><span class="fu">filter</span>(DATA, date <span class="sc">&gt;=</span> <span class="st">&quot;1952-01-01&quot;</span>)</span>
<span id="cb24-128"><a href="#cb24-128" aria-hidden="true" tabindex="-1"></a>BQY_S   <span class="ot">&lt;-</span><span class="fu">merge</span>(BQY_S, <span class="fu">log</span>(GDPC1), <span class="at">join=</span><span class="st">&quot;left&quot;</span>)</span>
<span id="cb24-129"><a href="#cb24-129" aria-hidden="true" tabindex="-1"></a>BQY_S   <span class="ot">&lt;-</span><span class="fu">data.frame</span>(<span class="at">date=</span><span class="fu">index</span>(BQY_S), <span class="fu">coredata</span>(BQY_S))</span>
<span id="cb24-130"><a href="#cb24-130" aria-hidden="true" tabindex="-1"></a><span class="fu">colnames</span>(BQY_S)<span class="ot">&lt;-</span><span class="fu">c</span>(<span class="st">&quot;date&quot;</span>,<span class="st">&quot;BQY_S&quot;</span>, <span class="st">&quot;GNP&quot;</span>)</span>
<span id="cb24-131"><a href="#cb24-131" aria-hidden="true" tabindex="-1"></a>BASE_LONG <span class="ot">&lt;-</span> <span class="fu">gather</span>(BQY_S, <span class="at">key=</span><span class="st">&quot;measure&quot;</span>, <span class="at">value=</span><span class="st">&quot;value&quot;</span>,<span class="fu">c</span>(<span class="st">&quot;BQY_S&quot;</span>, <span class="st">&quot;GNP&quot;</span>))</span>
<span id="cb24-132"><a href="#cb24-132" aria-hidden="true" tabindex="-1"></a>Z<span class="ot">&lt;-</span><span class="fu">ggplot</span>(BASE_LONG, <span class="fu">aes</span>(<span class="at">x=</span>date, <span class="at">y=</span>value, <span class="at">group =</span> measure,</span>
<span id="cb24-133"><a href="#cb24-133" aria-hidden="true" tabindex="-1"></a>                         <span class="at">colour=</span>measure))</span>
<span id="cb24-134"><a href="#cb24-134" aria-hidden="true" tabindex="-1"></a>Z<span class="ot">&lt;-</span>Z<span class="sc">+</span><span class="fu">labs</span>(<span class="at">y=</span><span class="st">&quot;Logaritmo&quot;</span>,</span>
<span id="cb24-135"><a href="#cb24-135" aria-hidden="true" tabindex="-1"></a>          <span class="at">x=</span><span class="st">&quot;Fecha&quot;</span>)<span class="sc">+</span></span>
<span id="cb24-136"><a href="#cb24-136" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="at">size=</span><span class="fl">1.5</span>)</span>
<span id="cb24-137"><a href="#cb24-137" aria-hidden="true" tabindex="-1"></a>Z</span></code></pre></div>
<p><img src="01-conceptos_files/figure-html/unnamed-chunk-8-1.png" width="672" /></p>
<div class="sourceCode" id="cb25"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb25-1"><a href="#cb25-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(scales)</span>
<span id="cb25-2"><a href="#cb25-2" aria-hidden="true" tabindex="-1"></a>paleta<span class="ot">&lt;-</span><span class="fu">c</span>(<span class="st">&quot;#E41A1C&quot;</span>, <span class="st">&quot;#377EB8&quot;</span>)</span>
<span id="cb25-3"><a href="#cb25-3" aria-hidden="true" tabindex="-1"></a>BASE_LONG <span class="ot">&lt;-</span> <span class="fu">gather</span>(DATA, <span class="at">key=</span><span class="st">&quot;measure&quot;</span>, <span class="at">value=</span><span class="st">&quot;value&quot;</span>,<span class="fu">c</span>(<span class="st">&quot;Y_D&quot;</span>, <span class="st">&quot;Y_S&quot;</span>))</span>
<span id="cb25-4"><a href="#cb25-4" aria-hidden="true" tabindex="-1"></a>P <span class="ot">&lt;-</span><span class="fu">ggplot</span>(<span class="at">data =</span> BASE_LONG, <span class="fu">aes</span>(<span class="at">x =</span> date, <span class="at">y =</span>value,<span class="at">fill=</span> measure))</span>
<span id="cb25-5"><a href="#cb25-5" aria-hidden="true" tabindex="-1"></a>P<span class="ot">&lt;-</span>P<span class="sc">+</span><span class="fu">labs</span>(<span class="at">y=</span><span class="st">&quot;Tasa de variación (%)&quot;</span>,</span>
<span id="cb25-6"><a href="#cb25-6" aria-hidden="true" tabindex="-1"></a>          <span class="at">x=</span><span class="st">&quot;Período&quot;</span>, <span class="at">title =</span> <span class="st">&quot;Fluctuaciones del producto dado shock en demanda&quot;</span>)<span class="sc">+</span><span class="fu">geom_bar</span>(<span class="at">stat =</span> <span class="st">&quot;identity&quot;</span>) <span class="sc">+</span></span>
<span id="cb25-7"><a href="#cb25-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">guides</span>(<span class="at">fill =</span> <span class="fu">guide_legend</span>(<span class="at">reverse =</span> <span class="cn">TRUE</span>)) <span class="sc">+</span></span>
<span id="cb25-8"><a href="#cb25-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_manual</span>(<span class="at">values =</span> paleta)</span>
<span id="cb25-9"><a href="#cb25-9" aria-hidden="true" tabindex="-1"></a>P<span class="ot">&lt;-</span>P<span class="sc">+</span><span class="fu">geom_vline</span>(<span class="at">xintercept=</span><span class="fu">as.Date</span>(<span class="fu">ifelse</span>(BASE_LONG<span class="sc">$</span>R<span class="sc">==</span><span class="dv">1</span>, BASE_LONG<span class="sc">$</span>date, <span class="cn">NA</span>)), <span class="at">linetype=</span><span class="st">&#39;dashed&#39;</span>, <span class="at">color=</span><span class="fu">rep</span>(<span class="st">&#39;red&#39;</span>, <span class="fu">length</span>(BASE_LONG<span class="sc">$</span>R)))<span class="sc">+</span></span>
<span id="cb25-10"><a href="#cb25-10" aria-hidden="true" tabindex="-1"></a><span class="fu">geom_hline</span>(<span class="at">yintercept=</span><span class="dv">0</span>, <span class="at">linetype=</span><span class="st">&quot;dashed&quot;</span>,</span>
<span id="cb25-11"><a href="#cb25-11" aria-hidden="true" tabindex="-1"></a>             <span class="at">color =</span> <span class="st">&quot;black&quot;</span>, <span class="at">size=</span><span class="dv">1</span>)</span>
<span id="cb25-12"><a href="#cb25-12" aria-hidden="true" tabindex="-1"></a>P<span class="ot">&lt;-</span>P<span class="sc">+</span><span class="fu">theme</span>(<span class="at">axis.line.x =</span> <span class="fu">element_line</span>(<span class="at">colour =</span> <span class="st">&quot;black&quot;</span>, <span class="at">size =</span> <span class="fl">0.5</span>),</span>
<span id="cb25-13"><a href="#cb25-13" aria-hidden="true" tabindex="-1"></a>           <span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">size=</span><span class="dv">14</span>, <span class="at">hjust =</span> <span class="fl">0.5</span>),</span>
<span id="cb25-14"><a href="#cb25-14" aria-hidden="true" tabindex="-1"></a>           <span class="at">axis.line.y.left  =</span> <span class="fu">element_line</span>(<span class="at">colour =</span> <span class="st">&quot;black&quot;</span>, <span class="at">size =</span> <span class="fl">0.5</span>),</span>
<span id="cb25-15"><a href="#cb25-15" aria-hidden="true" tabindex="-1"></a>           <span class="at">axis.line.y.right =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb25-16"><a href="#cb25-16" aria-hidden="true" tabindex="-1"></a>           <span class="at">axis.text.x =</span> <span class="fu">element_text</span>( <span class="at">color =</span> <span class="st">&quot;black&quot;</span>, <span class="at">size =</span> <span class="dv">14</span>),</span>
<span id="cb25-17"><a href="#cb25-17" aria-hidden="true" tabindex="-1"></a>           <span class="at">axis.text.y =</span> <span class="fu">element_text</span>( <span class="at">color =</span> <span class="st">&quot;black&quot;</span>, <span class="at">size =</span> <span class="dv">12</span>))</span>
<span id="cb25-18"><a href="#cb25-18" aria-hidden="true" tabindex="-1"></a>P<span class="ot">&lt;-</span>P<span class="sc">+</span><span class="fu">scale_x_date</span>(<span class="at">breaks =</span> <span class="st">&quot;4 years&quot;</span>, <span class="at">labels=</span><span class="fu">date_format</span>(<span class="st">&quot;%Y&quot;</span>))</span>
<span id="cb25-19"><a href="#cb25-19" aria-hidden="true" tabindex="-1"></a>P</span></code></pre></div>
<p><img src="01-conceptos_files/figure-html/unnamed-chunk-9-1.png" width="672" /></p>
</div>
<div id="aplicación-gali99" class="section level2 hasAnchor" number="2.7">
<h2><span class="header-section-number">2.7</span> Aplicación <span class="citation">Gali (<a href="#ref-GALI99" role="doc-biblioref">1999</a>)</span><a href="#aplicación-gali99" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p><span class="citation">Gali (<a href="#ref-GALI99" role="doc-biblioref">1999</a>)</span> considera que la formulación impuesta por <span class="citation">Blanchard and Quah (<a href="#ref-BLANCHARD88" role="doc-biblioref">1988</a>)</span> es un poco restrictiva. El supuesto que ninguno de los shocks de oferta y demanda pueden cambiar el nivel de tasa de desempleo en el largo plazo podría no ser correcta. Por lo anterior propone una formulación próxima a la predicción hecha por el modelo RBC referente al mercado laboral.</p>
<p>El modelo RBC, asume que el shock tecnólogico conduce los ciclos económicos y explica porque las horas trabajadas son más altas durante los boom que en tiempo de recesión.</p>
<p><span class="citation">Gali (<a href="#ref-GALI99" role="doc-biblioref">1999</a>)</span> propone un VAR conformado por la diferencia logarítimica del producto por horas trabajadas (<span class="math inline">\(\Delta z_{t}\)</span>) y por la diferencia logarítimica de las horas trabajadas (<span class="math inline">\(\Delta \eta_{t}\)</span>).</p>
<p>Los supuestos sobre la matriz diagonal inferior que expresan las restricciones de largo plazo muestran que el shock de oferta hoy llamado tecnólogico puede afectar la productividad en el largo plazo, no así el shock no tecnólogico.</p>
<div class="sourceCode" id="cb26"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb26-1"><a href="#cb26-1" aria-hidden="true" tabindex="-1"></a><span class="fu">getSymbols</span>(<span class="fu">c</span>(<span class="st">&quot;OPHNFB&quot;</span>, <span class="st">&quot;HOANBS&quot;</span>),</span>
<span id="cb26-2"><a href="#cb26-2" aria-hidden="true" tabindex="-1"></a>           <span class="at">src =</span> <span class="st">&quot;FRED&quot;</span>)</span></code></pre></div>
<pre><code>## [1] &quot;OPHNFB&quot; &quot;HOANBS&quot;</code></pre>
<div class="sourceCode" id="cb28"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb28-1"><a href="#cb28-1" aria-hidden="true" tabindex="-1"></a>dz         <span class="ot">&lt;-</span><span class="fu">diff</span>(<span class="dv">100</span><span class="sc">*</span><span class="fu">log</span>(OPHNFB), <span class="at">lag=</span><span class="dv">1</span>)</span>
<span id="cb28-2"><a href="#cb28-2" aria-hidden="true" tabindex="-1"></a>dz         <span class="ot">&lt;-</span>dz[<span class="st">&quot;1948-01-01/1994-12-01&quot;</span>]  </span>
<span id="cb28-3"><a href="#cb28-3" aria-hidden="true" tabindex="-1"></a>dn         <span class="ot">&lt;-</span><span class="fu">diff</span>(<span class="dv">100</span><span class="sc">*</span><span class="fu">log</span>(HOANBS), <span class="at">lag=</span><span class="dv">1</span>)</span>
<span id="cb28-4"><a href="#cb28-4" aria-hidden="true" tabindex="-1"></a>dn         <span class="ot">&lt;-</span>dn[<span class="st">&quot;1948-01-01/1994-12-01&quot;</span>]  </span>
<span id="cb28-5"><a href="#cb28-5" aria-hidden="true" tabindex="-1"></a>BASE       <span class="ot">&lt;-</span><span class="fu">merge</span>(dz, dn, <span class="at">join=</span><span class="st">&quot;outer&quot;</span>)</span>
<span id="cb28-6"><a href="#cb28-6" aria-hidden="true" tabindex="-1"></a>BASE       <span class="ot">&lt;-</span><span class="fu">data.frame</span>(<span class="at">date=</span><span class="fu">index</span>(BASE), <span class="fu">coredata</span>(BASE))</span>
<span id="cb28-7"><a href="#cb28-7" aria-hidden="true" tabindex="-1"></a><span class="fu">colnames</span>(BASE)<span class="ot">&lt;-</span><span class="fu">c</span>(<span class="st">&quot;date&quot;</span>,<span class="st">&quot;dz&quot;</span>, <span class="st">&quot;dn&quot;</span>)</span>
<span id="cb28-8"><a href="#cb28-8" aria-hidden="true" tabindex="-1"></a>DATA    <span class="ot">&lt;-</span>dplyr<span class="sc">::</span><span class="fu">select</span>(BASE, date, dz, dn)</span>
<span id="cb28-9"><a href="#cb28-9" aria-hidden="true" tabindex="-1"></a><span class="fu">colnames</span>(DATA)<span class="ot">&lt;-</span><span class="fu">c</span>(<span class="st">&quot;date&quot;</span>, <span class="st">&quot;y&quot;</span>, <span class="st">&quot;u&quot;</span>)</span>
<span id="cb28-10"><a href="#cb28-10" aria-hidden="true" tabindex="-1"></a>DATA    <span class="ot">&lt;-</span> <span class="fu">xts</span>(DATA[,<span class="sc">-</span><span class="dv">1</span>], <span class="at">order.by=</span><span class="fu">as.Date</span>(DATA[,<span class="dv">1</span>], <span class="st">&quot;%Y/%m/%d&quot;</span>))</span></code></pre></div>
<div class="sourceCode" id="cb29"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb29-1"><a href="#cb29-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(<span class="st">&quot;svars&quot;</span>)</span>
<span id="cb29-2"><a href="#cb29-2" aria-hidden="true" tabindex="-1"></a>VAR_3      <span class="ot">&lt;-</span> vars<span class="sc">::</span><span class="fu">VAR</span>(DATA, <span class="at">ic =</span> <span class="st">&quot;AIC&quot;</span>, <span class="at">lag.max =</span> <span class="dv">8</span>, <span class="at">type =</span> <span class="st">&quot;const&quot;</span>)</span>
<span id="cb29-3"><a href="#cb29-3" aria-hidden="true" tabindex="-1"></a>GMODEL<span class="ot">&lt;-</span> <span class="fu">BQ</span>(VAR_3)</span>
<span id="cb29-4"><a href="#cb29-4" aria-hidden="true" tabindex="-1"></a>FIR_GAL <span class="ot">&lt;-</span> <span class="fu">irf</span>(GMODEL,<span class="at">n.ahead =</span> <span class="dv">40</span>, <span class="at">impulse =</span> <span class="fu">c</span>(<span class="st">&quot;y&quot;</span>,<span class="st">&quot;u&quot;</span>), <span class="at">boot =</span><span class="cn">FALSE</span>, <span class="at">cumulative=</span><span class="cn">TRUE</span>)</span>
<span id="cb29-5"><a href="#cb29-5" aria-hidden="true" tabindex="-1"></a>RESULTADO<span class="ot">&lt;-</span><span class="fu">as.data.frame</span>(FIR_GAL<span class="sc">$</span>irf<span class="sc">$</span>y)</span>
<span id="cb29-6"><a href="#cb29-6" aria-hidden="true" tabindex="-1"></a>PERIODO<span class="ot">&lt;-</span><span class="fu">seq</span>(<span class="dv">1</span>,<span class="dv">41</span>,<span class="dv">1</span>)</span>
<span id="cb29-7"><a href="#cb29-7" aria-hidden="true" tabindex="-1"></a>RESULTADO <span class="ot">&lt;-</span><span class="fu">cbind</span>(RESULTADO,PERIODO)</span>
<span id="cb29-8"><a href="#cb29-8" aria-hidden="true" tabindex="-1"></a>CODE<span class="ot">&lt;-</span><span class="fu">rep</span>(<span class="st">&quot;Tecnológico&quot;</span>,<span class="dv">41</span>)</span>
<span id="cb29-9"><a href="#cb29-9" aria-hidden="true" tabindex="-1"></a>RESULTADO <span class="ot">&lt;-</span><span class="fu">cbind</span>(RESULTADO,CODE)</span>
<span id="cb29-10"><a href="#cb29-10" aria-hidden="true" tabindex="-1"></a><span class="do">#####################################</span></span>
<span id="cb29-11"><a href="#cb29-11" aria-hidden="true" tabindex="-1"></a>RESULTADO2<span class="ot">&lt;-</span><span class="fu">as.data.frame</span>(FIR_GAL<span class="sc">$</span>irf<span class="sc">$</span>u)</span>
<span id="cb29-12"><a href="#cb29-12" aria-hidden="true" tabindex="-1"></a>RESULTADO2 <span class="ot">&lt;-</span><span class="fu">cbind</span>(RESULTADO2,PERIODO)</span>
<span id="cb29-13"><a href="#cb29-13" aria-hidden="true" tabindex="-1"></a>CODE<span class="ot">&lt;-</span><span class="fu">rep</span>(<span class="st">&quot;Demanda&quot;</span>,<span class="dv">41</span>)</span>
<span id="cb29-14"><a href="#cb29-14" aria-hidden="true" tabindex="-1"></a>RESULTADO2 <span class="ot">&lt;-</span><span class="fu">cbind</span>(RESULTADO2,CODE)</span>
<span id="cb29-15"><a href="#cb29-15" aria-hidden="true" tabindex="-1"></a>RESULTADO <span class="ot">&lt;-</span><span class="fu">rbind</span>(RESULTADO,RESULTADO2)</span>
<span id="cb29-16"><a href="#cb29-16" aria-hidden="true" tabindex="-1"></a>BASE_LONG <span class="ot">&lt;-</span> <span class="fu">gather</span>(RESULTADO, <span class="at">key=</span><span class="st">&quot;measure&quot;</span>, <span class="at">value=</span><span class="st">&quot;value&quot;</span>,<span class="fu">c</span>(<span class="st">&quot;y&quot;</span>, <span class="st">&quot;u&quot;</span>))</span>
<span id="cb29-17"><a href="#cb29-17" aria-hidden="true" tabindex="-1"></a>BASE_LONG<span class="sc">$</span>measure <span class="ot">&lt;-</span> <span class="fu">factor</span>(BASE_LONG<span class="sc">$</span>measure,                           <span class="at">levels =</span> <span class="fu">c</span>(<span class="st">&quot;y&quot;</span>, <span class="st">&quot;u&quot;</span>))</span>
<span id="cb29-18"><a href="#cb29-18" aria-hidden="true" tabindex="-1"></a>BASE_LONG<span class="sc">$</span>CODE <span class="ot">&lt;-</span> <span class="fu">factor</span>(BASE_LONG<span class="sc">$</span>CODE,</span>
<span id="cb29-19"><a href="#cb29-19" aria-hidden="true" tabindex="-1"></a>                            <span class="at">levels =</span> <span class="fu">c</span>(<span class="st">&quot;Tecnológico&quot;</span>, <span class="st">&quot;Demanda&quot;</span>))</span>
<span id="cb29-20"><a href="#cb29-20" aria-hidden="true" tabindex="-1"></a>variable_names <span class="ot">&lt;-</span> <span class="fu">list</span>(</span>
<span id="cb29-21"><a href="#cb29-21" aria-hidden="true" tabindex="-1"></a>  <span class="st">&quot;Tecnológico&quot;</span> <span class="ot">=</span> <span class="st">&quot;Shock tecnológico&quot;</span>,</span>
<span id="cb29-22"><a href="#cb29-22" aria-hidden="true" tabindex="-1"></a>      <span class="st">&quot;Demanda&quot;</span> <span class="ot">=</span> <span class="st">&quot;Shock no tecnológico&quot;</span></span>
<span id="cb29-23"><a href="#cb29-23" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb29-24"><a href="#cb29-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-25"><a href="#cb29-25" aria-hidden="true" tabindex="-1"></a>variable_labeller2 <span class="ot">&lt;-</span> <span class="cf">function</span>(variable,value){</span>
<span id="cb29-26"><a href="#cb29-26" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (variable<span class="sc">==</span><span class="st">&#39;CODE&#39;</span>) {</span>
<span id="cb29-27"><a href="#cb29-27" aria-hidden="true" tabindex="-1"></a>    <span class="fu">return</span>(variable_names[value])</span>
<span id="cb29-28"><a href="#cb29-28" aria-hidden="true" tabindex="-1"></a>  } <span class="cf">else</span> {</span>
<span id="cb29-29"><a href="#cb29-29" aria-hidden="true" tabindex="-1"></a>    <span class="fu">return</span>(region_names)</span>
<span id="cb29-30"><a href="#cb29-30" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb29-31"><a href="#cb29-31" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb29-32"><a href="#cb29-32" aria-hidden="true" tabindex="-1"></a>paleta<span class="ot">&lt;-</span><span class="fu">c</span>(<span class="st">&quot;blue&quot;</span>, <span class="st">&quot;red&quot;</span>)</span>
<span id="cb29-33"><a href="#cb29-33" aria-hidden="true" tabindex="-1"></a>Z<span class="ot">&lt;-</span><span class="fu">ggplot</span>(BASE_LONG, <span class="fu">aes</span>(<span class="at">x=</span>PERIODO, <span class="at">y=</span>value, <span class="at">group =</span> measure,</span>
<span id="cb29-34"><a href="#cb29-34" aria-hidden="true" tabindex="-1"></a>                         <span class="at">colour=</span>measure))<span class="sc">+</span></span>
<span id="cb29-35"><a href="#cb29-35" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(.<span class="sc">~</span>CODE, <span class="at">scales=</span><span class="st">&quot;free&quot;</span>, <span class="at">labeller=</span> variable_labeller2)</span>
<span id="cb29-36"><a href="#cb29-36" aria-hidden="true" tabindex="-1"></a>Z<span class="ot">&lt;-</span>Z<span class="sc">+</span><span class="fu">labs</span>(<span class="at">y=</span><span class="st">&quot;Respuesta&quot;</span>,</span>
<span id="cb29-37"><a href="#cb29-37" aria-hidden="true" tabindex="-1"></a>          <span class="at">x=</span><span class="st">&quot;Períodos&quot;</span>)<span class="sc">+</span></span>
<span id="cb29-38"><a href="#cb29-38" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_hline</span>(<span class="at">yintercept=</span><span class="dv">0</span>, <span class="at">linetype=</span><span class="st">&quot;dashed&quot;</span>,</span>
<span id="cb29-39"><a href="#cb29-39" aria-hidden="true" tabindex="-1"></a>             <span class="at">color =</span> <span class="st">&quot;black&quot;</span>, <span class="at">size=</span><span class="dv">1</span>)<span class="sc">+</span></span>
<span id="cb29-40"><a href="#cb29-40" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="at">size=</span><span class="fl">1.5</span>)<span class="sc">+</span></span>
<span id="cb29-41"><a href="#cb29-41" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(<span class="at">values=</span>paleta,</span>
<span id="cb29-42"><a href="#cb29-42" aria-hidden="true" tabindex="-1"></a>                     <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">&quot;Productividad&quot;</span>, </span>
<span id="cb29-43"><a href="#cb29-43" aria-hidden="true" tabindex="-1"></a>                                <span class="st">&quot;Horas&quot;</span>))</span>
<span id="cb29-44"><a href="#cb29-44" aria-hidden="true" tabindex="-1"></a>Z<span class="ot">&lt;-</span>Z<span class="sc">+</span><span class="fu">theme</span>(<span class="at">axis.line.x =</span> <span class="fu">element_line</span>(<span class="at">colour =</span> <span class="st">&quot;black&quot;</span>, <span class="at">size =</span> <span class="fl">0.5</span>),</span>
<span id="cb29-45"><a href="#cb29-45" aria-hidden="true" tabindex="-1"></a>           <span class="at">axis.line.y.left  =</span> <span class="fu">element_line</span>(<span class="at">colour =</span> <span class="st">&quot;black&quot;</span>, <span class="at">size =</span> <span class="fl">0.5</span>),</span>
<span id="cb29-46"><a href="#cb29-46" aria-hidden="true" tabindex="-1"></a>           <span class="at">axis.line.y.right =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb29-47"><a href="#cb29-47" aria-hidden="true" tabindex="-1"></a>           <span class="at">axis.text.x =</span> <span class="fu">element_text</span>( <span class="at">color =</span> <span class="st">&quot;black&quot;</span>, <span class="at">size =</span> <span class="dv">14</span>),</span>
<span id="cb29-48"><a href="#cb29-48" aria-hidden="true" tabindex="-1"></a>           <span class="at">axis.text.y =</span> <span class="fu">element_text</span>( <span class="at">color =</span> <span class="st">&quot;black&quot;</span>, <span class="at">size =</span> <span class="dv">12</span>),</span>
<span id="cb29-49"><a href="#cb29-49" aria-hidden="true" tabindex="-1"></a>           <span class="at">panel.grid.minor =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb29-50"><a href="#cb29-50" aria-hidden="true" tabindex="-1"></a>           <span class="at">panel.grid.major.y =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb29-51"><a href="#cb29-51" aria-hidden="true" tabindex="-1"></a>           <span class="at">panel.grid.major.x =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb29-52"><a href="#cb29-52" aria-hidden="true" tabindex="-1"></a>           <span class="at">panel.border =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb29-53"><a href="#cb29-53" aria-hidden="true" tabindex="-1"></a>           <span class="at">panel.background =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb29-54"><a href="#cb29-54" aria-hidden="true" tabindex="-1"></a>           <span class="at">legend.key=</span><span class="fu">element_rect</span>(<span class="at">fill =</span> <span class="st">&quot;white&quot;</span>, <span class="at">colour =</span> <span class="st">&quot;white&quot;</span>,</span>
<span id="cb29-55"><a href="#cb29-55" aria-hidden="true" tabindex="-1"></a>                                   <span class="at">color =</span> <span class="st">&quot;white&quot;</span>, <span class="at">inherit.blank =</span> <span class="cn">FALSE</span>),</span>
<span id="cb29-56"><a href="#cb29-56" aria-hidden="true" tabindex="-1"></a>           <span class="at">legend.title =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb29-57"><a href="#cb29-57" aria-hidden="true" tabindex="-1"></a>           <span class="at">legend.text  =</span> <span class="fu">element_text</span>(<span class="at">size=</span><span class="dv">10</span>),</span>
<span id="cb29-58"><a href="#cb29-58" aria-hidden="true" tabindex="-1"></a>           <span class="at">legend.position=</span><span class="st">&quot;bottom&quot;</span>,</span>
<span id="cb29-59"><a href="#cb29-59" aria-hidden="true" tabindex="-1"></a>           <span class="at">legend.spacing.x =</span> <span class="fu">unit</span>(<span class="fl">0.10</span>, <span class="st">&#39;cm&#39;</span>),</span>
<span id="cb29-60"><a href="#cb29-60" aria-hidden="true" tabindex="-1"></a>           <span class="at">legend.margin=</span><span class="fu">margin</span>(),</span>
<span id="cb29-61"><a href="#cb29-61" aria-hidden="true" tabindex="-1"></a>           <span class="at">legend.background =</span> <span class="fu">element_rect</span>(<span class="at">fill =</span> <span class="st">&quot;white&quot;</span>, <span class="at">colour =</span> <span class="st">&quot;transparent&quot;</span>,</span>
<span id="cb29-62"><a href="#cb29-62" aria-hidden="true" tabindex="-1"></a>                                            <span class="at">color =</span> <span class="st">&quot;white&quot;</span>, <span class="at">inherit.blank =</span> <span class="cn">FALSE</span>)</span>
<span id="cb29-63"><a href="#cb29-63" aria-hidden="true" tabindex="-1"></a>)<span class="sc">+</span><span class="fu">guides</span>(<span class="at">color =</span> <span class="fu">guide_legend</span>(<span class="at">nrow =</span> <span class="dv">1</span>))</span>
<span id="cb29-64"><a href="#cb29-64" aria-hidden="true" tabindex="-1"></a>Z</span></code></pre></div>
<p><img src="01-conceptos_files/figure-html/unnamed-chunk-11-1.png" width="672" /></p>
<p>Como puede apreciarse en la figura anterior, los shocks no tecnológicos causan <em>en el corto plazo</em> efectos tanto en el producto como en la productividad; se evidencia que los movimientos ciclicos en el corto plazo de la productividad no son únicamente impulsados por los shocks tecnológicos.</p>
<p>¿Cómo se explica lo anterior? A través de coste de ajuste en el recurso trabajo. Durante un auge en lugar de contratar mano de obra nueva se sobreutiliza la existente. En recesión, esos empleados no son despedidos sino que son subutilizados.</p>
<p>También se muestra que los shocks no tecnológicos elevan la utilización del factor trabajo. La explicación de ese hecho es menos clara, por lo que algunos autores estiman un VAR de manera que las horas no tengan efectos en el largo plazo.</p>
<p>En lo que respecto al shock tecnológico, éste provoca que la productividad se eleve permanentemente mientras las horas decaén en al menos en el corto plazo. La interpretación es que en el corto plazo el producto es conducido por factores de demanda y no de oferta. Una mayor eficiencia significa que la demanda de productos puede ser satisfecha como menos trabajo.</p>
<p>Lo anterios desmiente las conclusiones de los modelos RBC, por lo que estos resultados son controversiales.</p>
</div>
</div>
<div id="paquetes-en-r" class="section level1 hasAnchor" number="3">
<h1><span class="header-section-number">Capítulo 3</span> Paquetes en R<a href="#paquetes-en-r" class="anchor-section" aria-label="Anchor link to header"></a></h1>
<div id="paquete-svars" class="section level2 hasAnchor" number="3.1">
<h2><span class="header-section-number">3.1</span> Paquete SVARS<a href="#paquete-svars" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>En esta nota para la obtención de un Vector Autorregresivo Estructural (SVAR) se utilizará el paquete en R <em>SVARS</em> elaborado por <span class="citation">Lange et al. (<a href="#ref-SVAR21" role="doc-biblioref">2021</a>)</span>. A continuación se muestra la carga de este paquete junto a otros que serán de utilidad cuando se analicen los resultados.</p>
<div class="sourceCode" id="cb30"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb30-1"><a href="#cb30-1" aria-hidden="true" tabindex="-1"></a><span class="co">#install.packages(&quot;svars&quot;)</span></span>
<span id="cb30-2"><a href="#cb30-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(<span class="st">&quot;svars&quot;</span>)</span>
<span id="cb30-3"><a href="#cb30-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(<span class="st">&quot;ggplot2&quot;</span>)</span></code></pre></div>
<p>Enseguida se cargará una base de datos en frecuencia trimestral que contiene la brecha producto (x), la inflación de trimestre a trimestre del deflactor del PIB (<span class="math inline">\(\pi\)</span>) y una tasa de interés nominal del fondo federal (i).</p>
<div class="sourceCode" id="cb31"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb31-1"><a href="#cb31-1" aria-hidden="true" tabindex="-1"></a><span class="fu">data</span>(<span class="st">&quot;USA&quot;</span>)</span>
<span id="cb31-2"><a href="#cb31-2" aria-hidden="true" tabindex="-1"></a>usa<span class="ot">&lt;-</span><span class="fu">as.zoo</span>(USA)</span></code></pre></div>
<p>A continuación se aplicará el método de <em>ortogonalización de</em> <span class="citation">Sims (<a href="#ref-Sims80" role="doc-biblioref">1980a</a>)</span> el cual consiste en asumir que la matriz <span class="math inline">\(C(0)\)</span> es una matriz triangular inferior.</p>
<div class="sourceCode" id="cb32"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb32-1"><a href="#cb32-1" aria-hidden="true" tabindex="-1"></a>C <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="fu">rep</span>(<span class="cn">NA</span>, <span class="dv">9</span>), <span class="at">ncol =</span> <span class="dv">3</span>)</span>
<span id="cb32-2"><a href="#cb32-2" aria-hidden="true" tabindex="-1"></a>C[<span class="dv">1</span>, <span class="fu">c</span>(<span class="dv">2</span>, <span class="dv">3</span>)] <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb32-3"><a href="#cb32-3" aria-hidden="true" tabindex="-1"></a>C[<span class="dv">2</span>, <span class="dv">3</span>] <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb32-4"><a href="#cb32-4" aria-hidden="true" tabindex="-1"></a>C</span></code></pre></div>
<pre><code>##      [,1] [,2] [,3]
## [1,]   NA    0    0
## [2,]   NA   NA    0
## [3,]   NA   NA   NA</code></pre>
<p>Luego estimamos el SVAR con esa restricción</p>
<div class="sourceCode" id="cb34"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb34-1"><a href="#cb34-1" aria-hidden="true" tabindex="-1"></a>plain.var <span class="ot">&lt;-</span> vars<span class="sc">::</span><span class="fu">VAR</span>(USA, <span class="at">p =</span> <span class="dv">6</span>, <span class="at">type =</span> <span class="st">&#39;const&#39;</span>)</span>
<span id="cb34-2"><a href="#cb34-2" aria-hidden="true" tabindex="-1"></a>Sims_mdl  <span class="ot">&lt;-</span> <span class="fu">SVAR</span>(plain.var, <span class="at">estmethod=</span><span class="st">&quot;direct&quot;</span>, <span class="at">Bmat =</span> C)</span>
<span id="cb34-3"><a href="#cb34-3" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(Sims_mdl)</span></code></pre></div>
<pre><code>## 
## SVAR Estimation Results:
## ======================== 
## 
## Call:
## SVAR(x = plain.var, estmethod = &quot;direct&quot;, Bmat = C)
## 
## Type: B-model 
## Sample size: 169 
## Log Likelihood: -722.095 
## Method: direct 
## Number of iterations: 501 
## Convergence code: 1 
## 
## Estimated A matrix:
##    x pi i
## x  1  0 0
## pi 0  1 0
## i  0  0 1
## 
## Estimated B matrix:
##          x     pi     i
## x   1.0339 0.0000 0.000
## pi -0.8068 1.0500 0.000
## i  -1.0568 0.3056 0.936
## 
## Covariance matrix of reduced form residuals (*100):
##          x     pi      i
## x   106.90 -83.42 -109.3
## pi  -83.42 175.33  117.3
## i  -109.26 117.34  208.6</code></pre>
<p>Y representamos la función impulso respuesta ante un shock en <span class="math inline">\(\pi\)</span>.</p>
<div class="sourceCode" id="cb36"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb36-1"><a href="#cb36-1" aria-hidden="true" tabindex="-1"></a>Sims.irf <span class="ot">&lt;-</span> <span class="fu">irf</span>(Sims_mdl, <span class="at">impulse =</span> <span class="st">&quot;pi&quot;</span>, <span class="at">response =</span> <span class="cn">NULL</span>,</span>
<span id="cb36-2"><a href="#cb36-2" aria-hidden="true" tabindex="-1"></a>                <span class="at">n.ahead =</span> <span class="dv">48</span>, <span class="at">boot =</span> <span class="cn">TRUE</span>)</span>
<span id="cb36-3"><a href="#cb36-3" aria-hidden="true" tabindex="-1"></a>RESULTADO<span class="ot">&lt;-</span><span class="fu">as.data.frame</span>(Sims.irf<span class="sc">$</span>irf<span class="sc">$</span>pi)</span>
<span id="cb36-4"><a href="#cb36-4" aria-hidden="true" tabindex="-1"></a>PERIODO<span class="ot">&lt;-</span><span class="fu">seq</span>(<span class="dv">1</span>,<span class="dv">49</span>,<span class="dv">1</span>)</span>
<span id="cb36-5"><a href="#cb36-5" aria-hidden="true" tabindex="-1"></a>RESULTADO <span class="ot">&lt;-</span><span class="fu">cbind</span>(RESULTADO,PERIODO)</span>
<span id="cb36-6"><a href="#cb36-6" aria-hidden="true" tabindex="-1"></a><span class="do">####HACER MI PROPIO GRÁFICO###################</span></span>
<span id="cb36-7"><a href="#cb36-7" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyr)</span>
<span id="cb36-8"><a href="#cb36-8" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(dplyr)</span>
<span id="cb36-9"><a href="#cb36-9" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggthemes)</span>
<span id="cb36-10"><a href="#cb36-10" aria-hidden="true" tabindex="-1"></a>Data_LONG <span class="ot">&lt;-</span> <span class="fu">gather</span>(RESULTADO, <span class="at">key=</span><span class="st">&quot;code&quot;</span>, <span class="at">value=</span><span class="st">&quot;YY&quot;</span>,</span>
<span id="cb36-11"><a href="#cb36-11" aria-hidden="true" tabindex="-1"></a>                    <span class="fu">c</span>(<span class="st">&quot;x&quot;</span>, <span class="st">&quot;pi&quot;</span>, <span class="st">&quot;i&quot;</span>))</span>
<span id="cb36-12"><a href="#cb36-12" aria-hidden="true" tabindex="-1"></a>paleta_code_bar<span class="ot">&lt;-</span>  <span class="fu">c</span>(<span class="st">&quot;#C00000&quot;</span>, <span class="st">&quot;#E26B0A&quot;</span>, <span class="st">&quot;#92D050&quot;</span>)</span>
<span id="cb36-13"><a href="#cb36-13" aria-hidden="true" tabindex="-1"></a>P<span class="ot">&lt;-</span> <span class="fu">ggplot</span>(<span class="at">data =</span> Data_LONG, <span class="fu">aes</span>(<span class="at">x =</span> PERIODO, <span class="at">y =</span>YY , <span class="at">group =</span> code,</span>
<span id="cb36-14"><a href="#cb36-14" aria-hidden="true" tabindex="-1"></a>                                 <span class="at">colour=</span>code))</span>
<span id="cb36-15"><a href="#cb36-15" aria-hidden="true" tabindex="-1"></a>P<span class="ot">&lt;-</span>P<span class="sc">+</span><span class="fu">labs</span>(<span class="at">y=</span><span class="st">&quot;Respuesta (%)&quot;</span>,</span>
<span id="cb36-16"><a href="#cb36-16" aria-hidden="true" tabindex="-1"></a>          <span class="at">x=</span><span class="st">&quot;Períodos&quot;</span>)<span class="sc">+</span></span>
<span id="cb36-17"><a href="#cb36-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_hline</span>(<span class="at">yintercept=</span><span class="dv">0</span>, <span class="at">linetype=</span><span class="st">&quot;dashed&quot;</span>,</span>
<span id="cb36-18"><a href="#cb36-18" aria-hidden="true" tabindex="-1"></a>             <span class="at">color =</span> <span class="st">&quot;black&quot;</span>, <span class="at">size=</span><span class="dv">1</span>)<span class="sc">+</span></span>
<span id="cb36-19"><a href="#cb36-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="at">size=</span><span class="fl">1.5</span>)<span class="sc">+</span></span>
<span id="cb36-20"><a href="#cb36-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(<span class="at">values=</span>paleta_code_bar)</span>
<span id="cb36-21"><a href="#cb36-21" aria-hidden="true" tabindex="-1"></a>P<span class="ot">&lt;-</span>P<span class="sc">+</span><span class="fu">theme</span>(<span class="at">axis.line.x =</span> <span class="fu">element_line</span>(<span class="at">colour =</span> <span class="st">&quot;black&quot;</span>, <span class="at">size =</span> <span class="fl">0.5</span>),</span>
<span id="cb36-22"><a href="#cb36-22" aria-hidden="true" tabindex="-1"></a>           <span class="at">axis.line.y.left  =</span> <span class="fu">element_line</span>(<span class="at">colour =</span> <span class="st">&quot;black&quot;</span>, <span class="at">size =</span> <span class="fl">0.5</span>),</span>
<span id="cb36-23"><a href="#cb36-23" aria-hidden="true" tabindex="-1"></a>           <span class="at">axis.line.y.right =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb36-24"><a href="#cb36-24" aria-hidden="true" tabindex="-1"></a>           <span class="at">axis.text.x =</span> <span class="fu">element_text</span>( <span class="at">color =</span> <span class="st">&quot;black&quot;</span>, <span class="at">size =</span> <span class="dv">14</span>),</span>
<span id="cb36-25"><a href="#cb36-25" aria-hidden="true" tabindex="-1"></a>           <span class="at">axis.text.y =</span> <span class="fu">element_text</span>( <span class="at">color =</span> <span class="st">&quot;black&quot;</span>, <span class="at">size =</span> <span class="dv">12</span>),</span>
<span id="cb36-26"><a href="#cb36-26" aria-hidden="true" tabindex="-1"></a>           <span class="at">panel.grid.minor =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb36-27"><a href="#cb36-27" aria-hidden="true" tabindex="-1"></a>           <span class="at">panel.grid.major.y =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb36-28"><a href="#cb36-28" aria-hidden="true" tabindex="-1"></a>           <span class="at">panel.grid.major.x =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb36-29"><a href="#cb36-29" aria-hidden="true" tabindex="-1"></a>           <span class="at">panel.border =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb36-30"><a href="#cb36-30" aria-hidden="true" tabindex="-1"></a>           <span class="at">panel.background =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb36-31"><a href="#cb36-31" aria-hidden="true" tabindex="-1"></a>           <span class="at">legend.key=</span><span class="fu">element_rect</span>(<span class="at">fill =</span> <span class="st">&quot;white&quot;</span>, <span class="at">colour =</span> <span class="st">&quot;white&quot;</span>,</span>
<span id="cb36-32"><a href="#cb36-32" aria-hidden="true" tabindex="-1"></a>                                   <span class="at">color =</span> <span class="st">&quot;white&quot;</span>, <span class="at">inherit.blank =</span> <span class="cn">FALSE</span>),</span>
<span id="cb36-33"><a href="#cb36-33" aria-hidden="true" tabindex="-1"></a>           <span class="at">legend.title =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb36-34"><a href="#cb36-34" aria-hidden="true" tabindex="-1"></a>           <span class="at">legend.text  =</span> <span class="fu">element_text</span>(<span class="at">size=</span><span class="dv">10</span>),</span>
<span id="cb36-35"><a href="#cb36-35" aria-hidden="true" tabindex="-1"></a>           <span class="at">legend.position=</span><span class="fu">c</span>(.<span class="dv">4</span>,.<span class="dv">85</span>),</span>
<span id="cb36-36"><a href="#cb36-36" aria-hidden="true" tabindex="-1"></a>           <span class="at">legend.spacing.x =</span> <span class="fu">unit</span>(<span class="fl">0.10</span>, <span class="st">&#39;cm&#39;</span>),</span>
<span id="cb36-37"><a href="#cb36-37" aria-hidden="true" tabindex="-1"></a>           <span class="at">legend.margin=</span><span class="fu">margin</span>(),</span>
<span id="cb36-38"><a href="#cb36-38" aria-hidden="true" tabindex="-1"></a>           <span class="at">legend.background =</span> <span class="fu">element_rect</span>(<span class="at">fill =</span> <span class="st">&quot;white&quot;</span>, <span class="at">colour =</span> <span class="st">&quot;transparent&quot;</span>,</span>
<span id="cb36-39"><a href="#cb36-39" aria-hidden="true" tabindex="-1"></a>                                            <span class="at">color =</span> <span class="st">&quot;white&quot;</span>, <span class="at">inherit.blank =</span> <span class="cn">FALSE</span>)</span>
<span id="cb36-40"><a href="#cb36-40" aria-hidden="true" tabindex="-1"></a>)<span class="sc">+</span><span class="fu">guides</span>(<span class="at">color =</span> <span class="fu">guide_legend</span>(<span class="at">nrow =</span> <span class="dv">1</span>))</span>
<span id="cb36-41"><a href="#cb36-41" aria-hidden="true" tabindex="-1"></a>P</span></code></pre></div>
<p><img src="01-conceptos_files/figure-html/unnamed-chunk-16-1.png" width="672" /></p>
<p>Finalmente, podemos observar la descomposición de la varianza de la variable <span class="math inline">\(\pi\)</span>:</p>
<div class="sourceCode" id="cb37"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb37-1"><a href="#cb37-1" aria-hidden="true" tabindex="-1"></a>fevd.p <span class="ot">&lt;-</span> <span class="fu">fevd</span>(Sims_mdl, <span class="at">n.ahead =</span> <span class="dv">48</span>)<span class="sc">$</span>p</span>
<span id="cb37-2"><a href="#cb37-2" aria-hidden="true" tabindex="-1"></a>RESULTADO<span class="ot">&lt;-</span><span class="fu">as.data.frame</span>(fevd.p)</span>
<span id="cb37-3"><a href="#cb37-3" aria-hidden="true" tabindex="-1"></a>PERIODO<span class="ot">&lt;-</span><span class="fu">seq</span>(<span class="dv">1</span>,<span class="dv">48</span>,<span class="dv">1</span>)</span>
<span id="cb37-4"><a href="#cb37-4" aria-hidden="true" tabindex="-1"></a>RESULTADO <span class="ot">&lt;-</span><span class="fu">cbind</span>(RESULTADO,PERIODO)</span>
<span id="cb37-5"><a href="#cb37-5" aria-hidden="true" tabindex="-1"></a>BASE_LONG <span class="ot">&lt;-</span> <span class="fu">gather</span>(RESULTADO, <span class="at">key=</span><span class="st">&quot;measure&quot;</span>, <span class="at">value=</span><span class="st">&quot;value&quot;</span>,</span>
<span id="cb37-6"><a href="#cb37-6" aria-hidden="true" tabindex="-1"></a>                    <span class="fu">c</span>(<span class="st">&quot;x&quot;</span>, <span class="st">&quot;pi&quot;</span>, <span class="st">&quot;i&quot;</span>))</span>
<span id="cb37-7"><a href="#cb37-7" aria-hidden="true" tabindex="-1"></a>paleta<span class="ot">&lt;-</span><span class="fu">c</span>(<span class="st">&quot;#66C2A5&quot;</span>,<span class="st">&quot;#8DA0CB&quot;</span>, <span class="st">&quot;#E78AC3&quot;</span>)</span>
<span id="cb37-8"><a href="#cb37-8" aria-hidden="true" tabindex="-1"></a>Z<span class="ot">&lt;-</span><span class="fu">ggplot</span>(BASE_LONG, <span class="fu">aes</span>(<span class="at">x=</span>PERIODO, <span class="at">y=</span>value, <span class="at">fill=</span>measure))<span class="sc">+</span></span>
<span id="cb37-9"><a href="#cb37-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_bar</span>(<span class="at">stat=</span><span class="st">&#39;identity&#39;</span>)<span class="sc">+</span><span class="fu">labs</span>(<span class="at">y=</span><span class="st">&quot;&quot;</span>, <span class="at">x=</span><span class="st">&quot;&quot;</span>)<span class="sc">+</span></span>
<span id="cb37-10"><a href="#cb37-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_manual</span>(<span class="at">values =</span> paleta)</span>
<span id="cb37-11"><a href="#cb37-11" aria-hidden="true" tabindex="-1"></a>Z<span class="ot">&lt;-</span>Z<span class="sc">+</span><span class="fu">labs</span>(<span class="at">y=</span><span class="st">&quot;Varianza (%)&quot;</span>,</span>
<span id="cb37-12"><a href="#cb37-12" aria-hidden="true" tabindex="-1"></a>          <span class="at">x=</span><span class="st">&quot;Períodos&quot;</span>)</span>
<span id="cb37-13"><a href="#cb37-13" aria-hidden="true" tabindex="-1"></a>Z<span class="ot">&lt;-</span>Z<span class="sc">+</span><span class="fu">theme_classic</span>()<span class="sc">+</span><span class="fu">theme</span>(</span>
<span id="cb37-14"><a href="#cb37-14" aria-hidden="true" tabindex="-1"></a>  <span class="at">axis.line.x        =</span> <span class="fu">element_line</span>(<span class="at">colour =</span> <span class="st">&quot;black&quot;</span>, <span class="at">size =</span> <span class="fl">0.5</span>),</span>
<span id="cb37-15"><a href="#cb37-15" aria-hidden="true" tabindex="-1"></a>  <span class="at">axis.line.y.left   =</span> <span class="fu">element_line</span>(<span class="at">colour =</span> <span class="st">&quot;black&quot;</span>, <span class="at">size =</span> <span class="fl">0.5</span>),</span>
<span id="cb37-16"><a href="#cb37-16" aria-hidden="true" tabindex="-1"></a>  <span class="at">axis.line.y.right  =</span> <span class="fu">element_line</span>(<span class="at">colour =</span> <span class="st">&quot;black&quot;</span>, <span class="at">size =</span> <span class="fl">0.5</span>),</span>
<span id="cb37-17"><a href="#cb37-17" aria-hidden="true" tabindex="-1"></a>  <span class="at">axis.text.x        =</span> <span class="fu">element_text</span>( <span class="at">color =</span> <span class="st">&quot;black&quot;</span>, <span class="at">size =</span> <span class="dv">12</span>),</span>
<span id="cb37-18"><a href="#cb37-18" aria-hidden="true" tabindex="-1"></a>  <span class="at">axis.text.y        =</span> <span class="fu">element_text</span>( <span class="at">color =</span> <span class="st">&quot;black&quot;</span>, <span class="at">size =</span> <span class="dv">12</span>),</span>
<span id="cb37-19"><a href="#cb37-19" aria-hidden="true" tabindex="-1"></a>  <span class="at">panel.grid.major.y =</span> <span class="fu">element_line</span>(<span class="at">size =</span> <span class="fl">0.5</span>,</span>
<span id="cb37-20"><a href="#cb37-20" aria-hidden="true" tabindex="-1"></a>                                    <span class="at">linetype =</span> <span class="st">&#39;solid&#39;</span>, <span class="at">colour =</span> <span class="st">&quot;#EAEAF2&quot;</span>),</span>
<span id="cb37-21"><a href="#cb37-21" aria-hidden="true" tabindex="-1"></a>  <span class="at">panel.grid.major.x =</span> <span class="fu">element_line</span>(<span class="at">size =</span> <span class="fl">0.5</span>,</span>
<span id="cb37-22"><a href="#cb37-22" aria-hidden="true" tabindex="-1"></a>                                    <span class="at">linetype =</span> <span class="st">&#39;solid&#39;</span>, <span class="at">colour =</span> <span class="st">&quot;#EAEAF2&quot;</span>),</span>
<span id="cb37-23"><a href="#cb37-23" aria-hidden="true" tabindex="-1"></a>  <span class="at">panel.grid.minor.x =</span> <span class="fu">element_line</span>(<span class="at">size =</span> <span class="fl">0.5</span>,</span>
<span id="cb37-24"><a href="#cb37-24" aria-hidden="true" tabindex="-1"></a>                                    <span class="at">linetype =</span> <span class="st">&#39;solid&#39;</span>, <span class="at">colour =</span> <span class="st">&quot;#EAEAF2&quot;</span>),</span>
<span id="cb37-25"><a href="#cb37-25" aria-hidden="true" tabindex="-1"></a>  <span class="at">panel.grid.minor.y =</span> <span class="fu">element_line</span>(<span class="at">size =</span> <span class="fl">0.5</span>,</span>
<span id="cb37-26"><a href="#cb37-26" aria-hidden="true" tabindex="-1"></a>                                    <span class="at">linetype =</span> <span class="st">&#39;solid&#39;</span>, <span class="at">colour =</span> <span class="st">&quot;#EAEAF2&quot;</span>),</span>
<span id="cb37-27"><a href="#cb37-27" aria-hidden="true" tabindex="-1"></a>  <span class="at">strip.background.x =</span> <span class="fu">element_rect</span>(<span class="at">colour=</span><span class="st">&quot;black&quot;</span>, <span class="at">fill=</span><span class="st">&quot;gray&quot;</span>),</span>
<span id="cb37-28"><a href="#cb37-28" aria-hidden="true" tabindex="-1"></a>  <span class="at">strip.text.x       =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">20</span>, <span class="at">color =</span> <span class="st">&quot;black&quot;</span>, <span class="at">face =</span> <span class="st">&quot;bold.italic&quot;</span>),</span>
<span id="cb37-29"><a href="#cb37-29" aria-hidden="true" tabindex="-1"></a>  <span class="at">legend.title =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb37-30"><a href="#cb37-30" aria-hidden="true" tabindex="-1"></a>  <span class="at">legend.text  =</span> <span class="fu">element_text</span>(<span class="at">size=</span><span class="dv">18</span>),</span>
<span id="cb37-31"><a href="#cb37-31" aria-hidden="true" tabindex="-1"></a>  <span class="at">legend.position=</span><span class="st">&quot;bottom&quot;</span>,</span>
<span id="cb37-32"><a href="#cb37-32" aria-hidden="true" tabindex="-1"></a>  <span class="at">legend.spacing.x =</span> <span class="fu">unit</span>(<span class="fl">0.20</span>, <span class="st">&#39;cm&#39;</span>),</span>
<span id="cb37-33"><a href="#cb37-33" aria-hidden="true" tabindex="-1"></a>  <span class="at">legend.margin=</span><span class="fu">margin</span>(),</span>
<span id="cb37-34"><a href="#cb37-34" aria-hidden="true" tabindex="-1"></a>  <span class="at">legend.background =</span> <span class="fu">element_rect</span>(<span class="at">fill =</span> <span class="st">&quot;white&quot;</span>, <span class="at">colour =</span> <span class="st">&quot;transparent&quot;</span>,</span>
<span id="cb37-35"><a href="#cb37-35" aria-hidden="true" tabindex="-1"></a>                                   <span class="at">color =</span> <span class="st">&quot;white&quot;</span>, <span class="at">inherit.blank =</span> <span class="cn">FALSE</span>)</span>
<span id="cb37-36"><a href="#cb37-36" aria-hidden="true" tabindex="-1"></a>)<span class="sc">+</span><span class="fu">guides</span>(<span class="at">color =</span> <span class="fu">guide_legend</span>(<span class="at">nrow =</span> <span class="dv">1</span>))</span>
<span id="cb37-37"><a href="#cb37-37" aria-hidden="true" tabindex="-1"></a>Z</span></code></pre></div>
<p><img src="01-conceptos_files/figure-html/unnamed-chunk-17-1.png" width="672" /></p>
<p>A continuación se replicará los resultados obtenidos por <span class="citation">Herwartz and Plödt (<a href="#ref-Herwartz2016" role="doc-biblioref">2016</a>)</span>, específicamente se estimaran los shocks estructurales a través de la metodología de cambios en volatilidades. Ello se logra a través de la función <em>id.cv()</em> dentro del cual hay que indicarle la fecha a partir de la cual se dio ese cambio estructural.</p>
<p><span class="citation">Herwartz and Plödt (<a href="#ref-Herwartz2016" role="doc-biblioref">2016</a>)</span> argumentan que el punto de quiebra se dio en el tercer trimestre de 1979 donde aconteció un cambio en la política de la Reserva Federal que redujo la volatilidad de las variables macroeconómicas (ver <span class="citation">Stock and Watson (<a href="#ref-Stock2003" role="doc-biblioref">2003</a>)</span>)</p>
<p>Lo anterior es posible visualizarlo.
Un primer paso es visualizar cada una de las series.</p>
<div class="sourceCode" id="cb38"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb38-1"><a href="#cb38-1" aria-hidden="true" tabindex="-1"></a><span class="fu">autoplot</span>(usa, <span class="at">facets =</span> T) <span class="sc">+</span> <span class="fu">theme_bw</span>() <span class="sc">+</span> <span class="fu">ylab</span>(<span class="st">&#39;Evolución de series de USA&#39;</span>)</span></code></pre></div>
<p><img src="01-conceptos_files/figure-html/unnamed-chunk-18-1.png" width="672" /></p>
<p>Con base en el objeto VAR podemos estimar su forma estructural con la función <em>id.cv()</em> la cual introduce el <em>cambio en la varianza</em> que se observa en las series, sin embargo la aplicación de esta función requiere específicar el argumento <em>SB</em> en formato <em>ts</em>:</p>
<div class="sourceCode" id="cb39"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb39-1"><a href="#cb39-1" aria-hidden="true" tabindex="-1"></a>usa.cv <span class="ot">&lt;-</span> <span class="fu">id.cv</span>(plain.var, <span class="at">SB =</span> <span class="fu">c</span>(<span class="dv">1979</span>, <span class="dv">3</span>))</span>
<span id="cb39-2"><a href="#cb39-2" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(usa.cv)</span></code></pre></div>
<pre><code>## 
## Identification Results
## ---------------------- 
## 
## Method: Changes in Volatility
## Sample size: 169
## Log-Likelihood: -564.2994
## AIC: 1268.599
## Structural Break: At Observation Number 59 during 1979 Q3
## Number of GLS estimations: 21
## Number of Restrictions: 0
## 
## Estimated unconditional Heteroscedasticity Matrix (Lambda):
##         [,1]     [,2]     [,3]
## x  0.3925906 0.000000 0.000000
## pi 0.0000000 0.191641 0.000000
## i  0.0000000 0.000000 1.244348
## 
## Standard Errors of Lambda:
##         [,1]       [,2]      [,3]
## x  0.0926582 0.00000000 0.0000000
## pi 0.0000000 0.04527264 0.0000000
## i  0.0000000 0.00000000 0.2935572
## 
## Estimated B Matrix (unique decomposition of the covariance matrix): 
##           [,1]       [,2]      [,3]
## x   0.61193300 -0.5931964 0.2241237
## pi  0.75559400  1.2987520 0.1131134
## i  -0.02899916  0.1572953 0.7084709
## 
## Standard Errors of B:
##         [,1]      [,2]       [,3]
## x  0.1330924 0.1955350 0.07101215
## pi 0.2498465 0.2600375 0.09960246
## i  0.1559672 0.1213446 0.07004431
## 
## Identification Wald Test of equal Eigenvalues:
## [1] 1.2443485 0.3925906 0.1916410
##                              Test statistic dof p-value  
## lambda_ 1 =lambda_2                  5.3828   2 0.06779 .
## lambda_ 1 =lambda_2=lambda_3        15.0586   5 0.01011 *
## lambda_ 2 =lambda_3                  2.1465   2 0.34189  
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</code></pre>
<p>Si el VAR puede ser escrito con matrices y como un sistema de media móviles (como se vió anteriormente) de la siguiente forma:</p>
<p><span class="math display">\[\begin{align}
x_{t}&amp;=B^{*}(L)\epsilon_{t},\;\;B^{*}(0)=I,\;\;E(w_{t}w_{t}^{&#39;})=\Sigma_w
\end{align}\]</span></p>
<p>Los resultados muestran la matriz de covarianza estimada <span class="math inline">\(\hat{B^{*}}\)</span>, la matriz de cambio en la convarianza estiamda <span class="math inline">\(\hat{\lambda}\)</span>.</p>
<p>Es de notar que el orden de las columnas en <span class="math inline">\(\hat{B^{*}}\)</span> es arbitrario. Lo importante es que ese ordenamiento se haga teniendo un sentido económico.</p>
<p><span class="citation">Herwartz and Plödt (<a href="#ref-Herwartz2016" role="doc-biblioref">2016</a>)</span> con base en los resultados de la matriz <span class="math inline">\(\hat{B^{*}}\)</span> hace un ordenamiento de acuerdo con el patrón de los signos. Ello indica que la columna 3 obdece a un shock de demanda, la columna 2 a un shock de oferta y la columna 1 a un shock de política monetaria. El siguiente código ordena las columnas de esa misma manera.</p>
<div class="sourceCode" id="cb41"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb41-1"><a href="#cb41-1" aria-hidden="true" tabindex="-1"></a>usa.cv<span class="sc">$</span>B <span class="ot">&lt;-</span> usa.cv<span class="sc">$</span>B[, <span class="fu">c</span>(<span class="dv">3</span>, <span class="dv">2</span>, <span class="dv">1</span>)]</span>
<span id="cb41-2"><a href="#cb41-2" aria-hidden="true" tabindex="-1"></a>usa.cv<span class="sc">$</span>B[,<span class="dv">3</span>] <span class="ot">&lt;-</span> usa.cv<span class="sc">$</span>B[, <span class="dv">3</span>] <span class="sc">*</span> (<span class="sc">-</span><span class="dv">1</span>)</span>
<span id="cb41-3"><a href="#cb41-3" aria-hidden="true" tabindex="-1"></a>usa.cv<span class="sc">$</span>B_SE <span class="ot">&lt;-</span> usa.cv<span class="sc">$</span>B_SE[, <span class="fu">c</span>(<span class="dv">3</span>, <span class="dv">2</span>, <span class="dv">1</span>)]</span>
<span id="cb41-4"><a href="#cb41-4" aria-hidden="true" tabindex="-1"></a>usa.cv<span class="sc">$</span>Lambda <span class="ot">&lt;-</span> <span class="fu">diag</span>(<span class="fu">diag</span>(usa.cv<span class="sc">$</span>Lambda)[<span class="fu">c</span>(<span class="dv">3</span>, <span class="dv">2</span>, <span class="dv">1</span>)])</span>
<span id="cb41-5"><a href="#cb41-5" aria-hidden="true" tabindex="-1"></a>usa.cv<span class="sc">$</span>Lambda_SE <span class="ot">&lt;-</span> <span class="fu">diag</span>(<span class="fu">diag</span>(usa.cv<span class="sc">$</span>Lambda_SE)[<span class="fu">c</span>(<span class="dv">3</span>, <span class="dv">2</span>, <span class="dv">1</span>)])</span>
<span id="cb41-6"><a href="#cb41-6" aria-hidden="true" tabindex="-1"></a><span class="fu">round</span>(usa.cv<span class="sc">$</span>B, <span class="dv">3</span>)</span></code></pre></div>
<pre><code>##     [,1]   [,2]   [,3]
## x  0.224 -0.593 -0.612
## pi 0.113  1.299 -0.756
## i  0.708  0.157  0.029</code></pre>
<p><span class="citation">Herwartz and Plödt (<a href="#ref-Herwartz2016" role="doc-biblioref">2016</a>)</span> interpretan el efecto de la primera columna de la matriz <span class="math inline">\(\hat{B^{*}}\)</span> como un shock de demanda. La segunda y tercera columna representa un shock de oferta y la tercera un shock de política monetaria.</p>
<div class="sourceCode" id="cb43"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb43-1"><a href="#cb43-1" aria-hidden="true" tabindex="-1"></a><span class="fu">round</span>(usa.cv<span class="sc">$</span>Lambda, <span class="dv">3</span>)</span></code></pre></div>
<pre><code>##       [,1]  [,2]  [,3]
## [1,] 1.244 0.000 0.000
## [2,] 0.000 0.192 0.000
## [3,] 0.000 0.000 0.393</code></pre>
<p>En cambio la matriz <span class="math inline">\(\hat{\lambda}\)</span> representa la varianza de los shocks estructurales en un segundo regimén, esto es posterior al quiebre estructural. Los autores interpretan a partir de la diagonal de <span class="math inline">\(\hat{\lambda}\)</span> que los shocks de oferta y política monetaria tiene baja varianza en comparación a los shocks de demanda.</p>
<p>Los autores comparan estos resultados con los obtenidos por <span class="citation">Sims (<a href="#ref-Sims80" role="doc-biblioref">1980a</a>)</span> utilizando la descomposición de la matriz de covarianza (<span class="math inline">\(\hat{B}\)</span>) como una matriz triangular inferior. La función <em>id.cv()</em> permite
probar tales restricciones configurando para ello una matriz triangular inferior como se describe en el código siguiente.</p>
<div class="sourceCode" id="cb45"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb45-1"><a href="#cb45-1" aria-hidden="true" tabindex="-1"></a>restMat <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="fu">rep</span>(<span class="cn">NA</span>, <span class="dv">9</span>), <span class="at">ncol =</span> <span class="dv">3</span>)</span>
<span id="cb45-2"><a href="#cb45-2" aria-hidden="true" tabindex="-1"></a>restMat[<span class="dv">1</span>, <span class="fu">c</span>(<span class="dv">2</span>, <span class="dv">3</span>)] <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb45-3"><a href="#cb45-3" aria-hidden="true" tabindex="-1"></a>restMat[<span class="dv">2</span>, <span class="dv">3</span>] <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb45-4"><a href="#cb45-4" aria-hidden="true" tabindex="-1"></a>restMat</span></code></pre></div>
<pre><code>##      [,1] [,2] [,3]
## [1,]   NA    0    0
## [2,]   NA   NA    0
## [3,]   NA   NA   NA</code></pre>
<div class="sourceCode" id="cb47"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb47-1"><a href="#cb47-1" aria-hidden="true" tabindex="-1"></a>restricted.model <span class="ot">&lt;-</span> <span class="fu">id.cv</span>(plain.var, <span class="at">SB =</span> <span class="fu">c</span>(<span class="dv">1979</span>, <span class="dv">3</span>),<span class="at">restriction_matrix =</span> restMat)</span>
<span id="cb47-2"><a href="#cb47-2" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(restricted.model)</span></code></pre></div>
<pre><code>## 
## Identification Results
## ---------------------- 
## 
## Method: Changes in Volatility
## Sample size: 169
## Log-Likelihood: -568.6664
## AIC: 1277.333
## Structural Break: At Observation Number 59 during 1979 Q3
## Number of GLS estimations: 24
## Number of Restrictions: 3
## 
## Estimated unconditional Heteroscedasticity Matrix (Lambda):
##         [,1]      [,2]      [,3]
## x  0.3501948 0.0000000 0.0000000
## pi 0.0000000 0.2346854 0.0000000
## i  0.0000000 0.0000000 0.9420116
## 
## Standard Errors of Lambda:
##          [,1]       [,2]     [,3]
## x  0.08266738 0.00000000 0.000000
## pi 0.00000000 0.05616318 0.000000
## i  0.00000000 0.00000000 0.227189
## 
## Estimated B Matrix (unique decomposition of the covariance matrix): 
##          [,1]      [,2]      [,3]
## x  0.87988465 0.0000000 0.0000000
## pi 0.08137972 1.5306503 0.0000000
## i  0.31518384 0.2606745 0.7378484
## 
## Standard Errors of B:
##          [,1]       [,2]       [,3]
## x  0.08638851 0.00000000 0.00000000
## pi 0.10334026 0.15169564 0.00000000
## i  0.08527441 0.08620187 0.07354584
## 
## Identification Wald Test of equal Eigenvalues:
## [1] 0.9420116 0.3501948 0.2346854
##                              Test statistic dof p-value
## lambda_ 1 =lambda_2                 4.04784   2  0.1321
## lambda_ 1 =lambda_2=lambda_3        9.15413   5  0.1031
## lambda_ 2 =lambda_3                 0.68408   2  0.7103
## 
## Likelihood Ratio Test: 
##  Test statistic p-value  
##           8.734   0.033 *
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</code></pre>
<p>Si partimos que los shocks structurales fueron identificados con la metodología de cambio en la matriz de covarianza, cualquier restricción impuesta sobre <span class="math inline">\(B\)</span> hace que el modelo esté sobre identificado y ello es posible probarse.</p>
<p>En resumen el <em>likelihood ratio test</em> indica que bajo la <span class="math inline">\(H_{0}\)</span>
que <span class="math inline">\(B\)</span> la matriz triangular (baja la cual impactan los shocks structurales) es rechazada al <span class="math inline">\(5\%\)</span> de nivel de significancia.</p>
<p><span class="citation">Herwartz and Plödt (<a href="#ref-Herwartz2016" role="doc-biblioref">2016</a>)</span> argumentan que la identificación de valores iguales a cero para lograr una matriz trinagular inferior es algo contra intuitivo desde el punto de vista económico; por tanto un modelo sin restricciones debería ser preferido.</p>
<p>El siguiente paso es calcular la función impulso respuesta (IFR) con un intervalo de confianza obtenido a partir del método “boostrap”. A partir de la IFR es posible investigar los efectos futuros de los shocks estructurales etiquetados como “económicos” sobre las variables
incluidas en el modelo. De hecho de acuerdo a <span class="citation">Herwartz (<a href="#ref-Herwartz18" role="doc-biblioref">2018</a>)</span> aplicar la metodología “boostrap permite evaluar la significancia en los signos que se hacen patentes en la matriz <span class="math inline">\(\hat{B}\)</span>.</p>
<p>Para aplicar lo anterior, definimos una lista con los signos que representan nuestras restricciones tanto para los shocks de demanda, oferta y política monetaria.</p>
<div class="sourceCode" id="cb49"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb49-1"><a href="#cb49-1" aria-hidden="true" tabindex="-1"></a>signrest <span class="ot">&lt;-</span> <span class="fu">list</span>(<span class="at">demand =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">1</span>), <span class="at">supply =</span> <span class="fu">c</span>(<span class="sc">-</span><span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">1</span>), <span class="at">monetary_policy =</span> <span class="fu">c</span>(<span class="sc">-</span><span class="dv">1</span>, <span class="sc">-</span><span class="dv">1</span>, <span class="dv">1</span>))</span></code></pre></div>
<p>Notar que el horizonte de tiempo para el IFR tiene que ser determinado de antemano usando el argumento n.ahead.</p>
<div class="sourceCode" id="cb50"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb50-1"><a href="#cb50-1" aria-hidden="true" tabindex="-1"></a>cores <span class="ot">&lt;-</span> parallel<span class="sc">::</span><span class="fu">detectCores</span>() <span class="sc">-</span> <span class="dv">1</span></span>
<span id="cb50-2"><a href="#cb50-2" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">231</span>)</span>
<span id="cb50-3"><a href="#cb50-3" aria-hidden="true" tabindex="-1"></a>usa.cv.boot <span class="ot">&lt;-</span> <span class="fu">wild.boot</span>(usa.cv, <span class="at">design =</span> <span class="st">&quot;fixed&quot;</span>,<span class="at">distr =</span> <span class="st">&quot;rademacher&quot;</span>, <span class="at">nboot =</span> <span class="dv">100</span>, <span class="at">n.ahead =</span> <span class="dv">15</span>,<span class="at">nc =</span> cores, <span class="at">signrest =</span> signrest)</span>
<span id="cb50-4"><a href="#cb50-4" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(usa.cv.boot)</span></code></pre></div>
<pre><code>## 
## Bootstrap Results
## ----------------- 
## 
## Method: Wild bootstrap
## Bootstrap iterations: 100
## Distribution used: rademacher
## Design: fixed
## 
## Point estimates: 
##         [,1]       [,2]        [,3]
## x  0.2241237 -0.5931964 -0.61193300
## pi 0.1131134  1.2987520 -0.75559400
## i  0.7084709  0.1572953  0.02899916
## 
## Bootstrap means: 
##         [,1]        [,2]       [,3]
## x  0.1045518 -0.48657641 -0.6423641
## pi 0.1109406  1.17572720 -0.7148899
## i  0.7117266  0.04557165 -0.1359824
## 
## Bootstrap standard errors: 
##          [,1]      [,2]      [,3]
## x  0.14559365 0.3064924 0.2414462
## pi 0.17784258 0.4316365 0.5771564
## i  0.07573841 0.2279646 0.2282243
## 
## Identified sign patterns: 
## =========================
## Specified sign pattern: 
## 
##    demand supply monetary_policy
## x       1     -1              -1
## pi      1      1              -1
## i       1      1               1
## 
## Unique occurrence of single shocks according to sign pattern: 
## demand : 76 % 
## supply : 60 % 
## monetary_policy : 37 % 
## 
## Joint occurrence of specified shocks: 18 %</code></pre>
<p>Enseguida, graficamos para cada variable y shocks su IFR.</p>
<div class="sourceCode" id="cb52"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb52-1"><a href="#cb52-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(usa.cv.boot, <span class="at">lowerq =</span> <span class="fl">0.16</span>, <span class="at">upperq =</span> <span class="fl">0.84</span>)</span></code></pre></div>
<p><img src="01-conceptos_files/figure-html/unnamed-chunk-26-1.png" width="672" /></p>
<p>El resumen el resultado revela que solo el 12.7% de todas las estimaciones hechas a través de bootstrap están en línea con lo que la teoría económica nos sugeriría que debería corresponder con los patrones de los signos motivados en forma conjunta.</p>
<p>El patrón de signos del shock de política monetaria aparece en solo el 28,4% de todas los experimentos.</p>
<p>En tanto, la metodología bootstrap indica que el tercer choque está más en línea con el patrón de signos del choque de demanda. Este resultado es plausible observando que la estimación puntual en la esquina inferior derecha es cercana a cero y, por lo tanto, carece de un efecto significativamente positivo sobre la tasa de interés.</p>
<p>La Figura anterior muestra las funciones de impulso-respuesta de choques normalizados con varianza unitaria en el primer régimen.</p>
<p><span class="citation">Herwartz and Plödt (<a href="#ref-Herwartz2016" role="doc-biblioref">2016</a>)</span> argumentan que la reacción negativa de la tasa de interés a un shock de política monetaria después del período inicial es inverosímil, y pone en duda que este shock se interpreta como uno de política monetaria. Los resultados del bootstrap apoyan la argumentación de los autores con
con respecto al etiquetado de choque.</p>
<p>Además, podemos calcular la descomposición de la varianza del error de pronóstico para investigar la contribución de cada perturbación al error cuadrático medio de predicción de las variables. El método <em>fevd()</em>
crea un objeto para la inspección visual de la descomposición de la varianza del error.</p>
<div class="sourceCode" id="cb53"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb53-1"><a href="#cb53-1" aria-hidden="true" tabindex="-1"></a>fev.cv <span class="ot">&lt;-</span> <span class="fu">fevd</span>(usa.cv, <span class="at">n.ahead =</span> <span class="dv">48</span>)</span>
<span id="cb53-2"><a href="#cb53-2" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(fev.cv)</span></code></pre></div>
<p><img src="01-conceptos_files/figure-html/unnamed-chunk-27-1.png" width="672" /></p>
<p>De acuerdo a la anterior figura es evidente que el shock de política monetaria explica más del 50% del error cuadrático medio de predicción de la brecha del producto, mientras que el choque de demanda representa constantemente solo alrededor del 5% de la media de predicción
error al cuadrado.</p>
<p>Además, el shock de demanda contribuye casi al 100% del error de pronóstico
varianza de las tasas de interés.</p>
<p>Por lo tanto, las descomposiciones del error de pronóstico apuntan a un
etiquetado de los choques diferente del desarrollado anteriormente sobre la base de patrones de signos de <span class="math inline">\(\hat{B^{*}}\)</span>. Además, confirman la conclusión de <span class="citation">Herwartz and Plödt (<a href="#ref-Herwartz2016" role="doc-biblioref">2016</a>)</span> de que el modelo enpirico no logra identificar un shock de política monetaria de acuerdo con sus patrones basados en la teoría económica.</p>
</div>
<div id="bla-bla" class="section level2 hasAnchor" number="3.2">
<h2><span class="header-section-number">3.2</span> BLA Bla<a href="#bla-bla" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>La estructura del modelo determina el orden de prelación de cada una de las variables y las restricciones de corto plazo.
El vector está dado por X=[y, <span class="math inline">\(\pi\)</span>, i, NPL, L, e] y se establece un SVAR de la forma <span class="math inline">\(AX=X_{-1}+u\)</span>, en el que A contiene las restricciones y con el cual se identifica los shocks.
Los datos utilizados tienen la siguiente características:}</p>
<p><span class="math display">\[\begin{eqnarray}
AX&amp;=\begin{bmatrix}
1 &amp; 0 &amp; 1 &amp; 0 &amp; 0 &amp; 0  \\
1 &amp; 1 &amp; 0 &amp; 0 &amp; 0 &amp; 0 \\
0 &amp; 1 &amp; 1 &amp; 1 &amp; 0 &amp; 0 \\
0 &amp; 0 &amp; 0 &amp; 1 &amp; 0 &amp; 0 \\
1 &amp; 1 &amp; 1 &amp; 1 &amp; 1 &amp; 0 \\
1 &amp; 1 &amp; 1 &amp; 1 &amp; 1 &amp; 1 \end{bmatrix}
\begin{bmatrix}
y \\
\pi \\
i\\
NPL\\
L\\
e\end{bmatrix}
\end{eqnarray}\]</span></p>
<div class="sourceCode" id="cb54"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb54-1"><a href="#cb54-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> pandas <span class="im">as</span> pd</span></code></pre></div>

</div>
</div>
<div id="referencias" class="section level1 unnumbered hasAnchor">
<h1>Referencias<a href="#referencias" class="anchor-section" aria-label="Anchor link to header"></a></h1>

<div id="refs" class="references csl-bib-body hanging-indent">
<div id="ref-BLANCHARD88" class="csl-entry">
Blanchard, Olivier Jean, and Danny Quah. 1988. <span>“<a href=""><span class="nocase">The Dynamic Effects of Aggregate Demand and Supply Disturbances</span></a>.”</span> NBER Working Papers 2737. National Bureau of Economic Research, Inc.
</div>
<div id="ref-COCHRANE94" class="csl-entry">
Cochrane, John H. 1994. <span>“<span class="nocase">Permanent and Transitory Components of GNP and Stock Prices</span>.”</span> <em>The Quarterly Journal of Economics</em> 109 (1): 241–65.
</div>
<div id="ref-GALI99" class="csl-entry">
Gali, Jordi. 1999. <span>“<a href=""><span class="nocase">Technology, Employment, and the Business Cycle: Do Technology Shocks Explain Aggregate Fluctuations?</span></a>”</span> <em>American Economic Review</em> 89 (1): 249–71.
</div>
<div id="ref-Herwartz18" class="csl-entry">
Herwartz, Helmut. 2018. <span>“<span class="nocase">Hodges–Lehmann Detection of Structural Shocks – An Analysis of Macroeconomic Dynamics in the Euro Area</span>.”</span> <em>Oxford Bulletin of Economics and Statistics</em> 80 (4): 736–54. <a href="https://doi.org/10.1111/obes.12234">https://doi.org/10.1111/obes.12234</a>.
</div>
<div id="ref-Herwartz2016" class="csl-entry">
Herwartz, Helmut, and Martin Plödt. 2016. <span>“<span class="nocase">Simulation Evidence on Theory-based and Statistical Identification under Volatility Breaks</span>.”</span> <em>Oxford Bulletin of Economics and Statistics</em> 78 (1): 94–112. <a href="https://ideas.repec.org/a/bla/obuest/v78y2016i1p94-112.html">https://ideas.repec.org/a/bla/obuest/v78y2016i1p94-112.html</a>.
</div>
<div id="ref-SVAR21" class="csl-entry">
Lange, Alexander, Bernhard Dalheimer, Helmut Herwartz, and Simone Maxand. 2021. <span>“Svars: An r Package for Data-Driven Identification in Multivariate Time Series Analysis.”</span> <em>Journal of Statistical Software</em> 97 (5): 1–34. <a href="https://doi.org/10.18637/jss.v097.i05">https://doi.org/10.18637/jss.v097.i05</a>.
</div>
<div id="ref-Sims80" class="csl-entry">
Sims, Christopher A. 1980a. <span>“<span class="nocase">Macroeconomics and Reality</span>.”</span> <em>Econometrica</em> 48 (1): 1–48. <a href="https://ideas.repec.org/a/ecm/emetrp/v48y1980i1p1-48.html">https://ideas.repec.org/a/ecm/emetrp/v48y1980i1p1-48.html</a>.
</div>
<div id="ref-Sims802" class="csl-entry">
———. 1980b. <span>“<a href=""><span class="nocase">Comparison of Interwar and Postwar Business Cycles: Monetarism Reconsidered</span></a>.”</span> NBER Working Papers 0430. National Bureau of Economic Research, Inc.
</div>
<div id="ref-Stock2003" class="csl-entry">
Stock, James H., and Mark W. Watson. 2003. <span>“<span class="nocase">Has the Business Cycle Changed and Why?</span>”</span> In <em><span>NBER Macroeconomics Annual 2002, Volume 17</span></em>, 159–230. NBER Chapters. National Bureau of Economic Research, Inc. <a href="https://ideas.repec.org/h/nbr/nberch/11075.html">https://ideas.repec.org/h/nbr/nberch/11075.html</a>.
</div>
</div>
</div>
            </section>

          </div>
        </div>
      </div>


    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"whatsapp": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": null,
"text": null
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": ["index.pdf", "index.epub"],
"search": {
"engine": "fuse",
"options": null
},
"toc": {
"collapse": "subsection",
"download": ["pdf", "epub"]
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
